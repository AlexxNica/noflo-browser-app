!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=26)}([function(t,e,n){(function(){var t,r;t=n(8),e.graph=t.graph,e.Graph=t.Graph,e.journal=t.journal,e.Journal=t.Journal,e.Network=n(15).Network,e.isBrowser=n(5).isBrowser,e.ComponentLoader=n(10).ComponentLoader,e.Component=n(18).Component,e.AsyncComponent=n(89).AsyncComponent,e.helpers=n(90),e.streams=n(12),r=n(19),e.InPorts=r.InPorts,e.OutPorts=r.OutPorts,e.InPort=n(20),e.OutPort=n(22),e.Port=n(11).Port,e.ArrayPort=n(91).ArrayPort,e.internalSocket=n(7),e.IP=n(4),e.createNetwork=function(t,n,r){var o,i;return"object"!=typeof r&&(r={delay:r}),"function"!=typeof n&&(n=function(t){if(t)throw t}),o=new e.Network(t,r),i=function(t){return t.start(function(e){return e?n(e):n(null,t)})},o.loader.listComponents(function(e){if(e)return n(e);if(0===t.nodes.length)return i(o);{if(!r.delay)return o.connect(function(t){return t?n(t):i(o)});n(null,o)}}),o},e.loadFile=function(t,n,r){return r||(r=n,null),r&&"object"!=typeof n&&(n={baseDir:n}),e.graph.loadFile(t,function(t,o){return t?r(t):(n.baseDir&&(o.baseDir=n.baseDir),e.createNetwork(o,r,n))})},e.saveFile=function(t,n,r){return e.graph.save(n,r)},e.asCallback=n(92).asCallback}).call(this)},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(p===setTimeout)return setTimeout(t,0);if((p===n||!p)&&setTimeout)return p=setTimeout,setTimeout(t,0);try{return p(t,0)}catch(e){try{return p.call(null,t,0)}catch(e){return p.call(this,t,0)}}}function i(t){if(d===clearTimeout)return clearTimeout(t);if((d===r||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(t);try{return d(t)}catch(e){try{return d.call(null,t)}catch(e){return d.call(this,t)}}}function s(){g&&f&&(g=!1,f.length?h=f.concat(h):m=-1,h.length&&a())}function a(){if(!g){var t=o(s);g=!0;for(var e=h.length;e;){for(f=h,h=[];++m<e;)f&&f[m].run();m=-1,e=h.length}f=null,g=!1,i(t)}}function u(t,e){this.fun=t,this.array=e}function c(){}var p,d,l=t.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:n}catch(t){p=n}try{d="function"==typeof clearTimeout?clearTimeout:r}catch(t){d=r}}();var f,h=[],g=!1,m=-1;l.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new u(t,e)),1!==h.length||g||o(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=c,l.addListener=c,l.once=c,l.off=c,l.removeListener=c,l.removeAllListeners=c,l.emit=c,l.prependListener=c,l.prependOnceListener=c,l.listeners=function(t){return[]},l.binding=function(t){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function o(t){return"number"==typeof t}function i(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!o(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,o,a,u,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var p=new Error('Uncaught, unspecified "error" event. ('+e+")");throw p.context=e,p}if(n=this._events[t],s(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(i(n))for(a=Array.prototype.slice.call(arguments,1),o=(c=n.slice()).length,u=0;u<o;u++)c[u].apply(this,a);return!0},n.prototype.addListener=function(t,e){var o;if(!r(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(e.listener)?e.listener:e),this._events[t]?i(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,i(this._events[t])&&!this._events[t].warned&&(o=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&o>0&&this._events[t].length>o&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function n(){this.removeListener(t,n),o||(o=!0,e.apply(this,arguments))}if(!r(e))throw TypeError("listener must be a function");var o=!1;return n.listener=e,this.on(t,n),this},n.prototype.removeListener=function(t,e){var n,o,s,a;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],s=n.length,o=-1,n===e||r(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(i(n)){for(a=s;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){o=a;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],r(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){return this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(r(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,n){(function(r){function o(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(87)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),n){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var o=0,i=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(o++,"%c"===t&&(i=o))}),t.splice(i,0,r)}},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=o,e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(o())}).call(e,n(1))},function(t,e){(function(){t.exports=function(){function t(t,e,n){var r,o;this.type=null!=t?t:"data",this.data=null!=e?e:null,null==n&&(n={}),this._isIP=!0,this.scope=null,this.owner=null,this.clonable=!1,this.index=null,this.schema=null,this.datatype="all";for(r in n)o=n[r],this[r]=o}return t.types=["data","openBracket","closeBracket"],t.isIP=function(t){return t&&"object"==typeof t&&!0===t._isIP},t.prototype.clone=function(){var e,n,r;e=new t(this.type);for(n in this)r=this[n],-1===["owner"].indexOf(n)&&null!==r&&(e[n]="object"==typeof r?JSON.parse(JSON.stringify(r)):r);return e},t.prototype.move=function(t){this.owner=t},t.prototype.drop=function(){var t,e;e=[];for(t in this)this[t],e.push(delete this[t]);return e},t}()}).call(this)},function(t,e,n){(function(t){(function(){e.isBrowser=function(){return void 0===t||!t.execPath||!t.execPath.match(/node|iojs/)},e.deprecated=function(n){if(!e.isBrowser()){if(t.env.NOFLO_FATAL_DEPRECATED)throw new Error(n);return console.warn(n)}if(window.NOFLO_FATAL_DEPRECATED)throw new Error(n);console.warn(n)}}).call(this)}).call(e,n(1))},function(t,e){},function(t,e,n){(function(){var t,r,o,i=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=n(2).EventEmitter,r=n(4),o=function(e){function n(t){this.metadata=null!=t?t:{},this.brackets=[],this.connected=!1,this.dataDelegate=null,this.debug=!1,this.emitEvent=this.regularEmitEvent}return i(n,t),n.prototype.regularEmitEvent=function(t,e){return this.emit(t,e)},n.prototype.debugEmitEvent=function(t,e){var n;try{return this.emit(t,e)}catch(t){if((n=t).id&&n.metadata&&n.error){if(0===this.listeners("error").length)throw n.error;return void this.emit("error",n)}if(0===this.listeners("error").length)throw n;return this.emit("error",{id:this.to.process.id,error:n,metadata:this.metadata})}},n.prototype.connect=function(){if(!this.connected)return this.connected=!0,this.emitEvent("connect",null)},n.prototype.disconnect=function(){if(this.connected)return this.connected=!1,this.emitEvent("disconnect",null)},n.prototype.isConnected=function(){return this.connected},n.prototype.send=function(t){return void 0===t&&"function"==typeof this.dataDelegate&&(t=this.dataDelegate()),this.handleSocketEvent("data",t)},n.prototype.post=function(t,e){if(null==e&&(e=!0),void 0===t&&"function"==typeof this.dataDelegate&&(t=this.dataDelegate()),this.isConnected()||0!==this.brackets.length||this.connect(),this.handleSocketEvent("ip",t,!1),e&&this.isConnected()&&0===this.brackets.length)return this.disconnect()},n.prototype.beginGroup=function(t){return this.handleSocketEvent("begingroup",t)},n.prototype.endGroup=function(){return this.handleSocketEvent("endgroup")},n.prototype.setDataDelegate=function(t){if("function"!=typeof t)throw Error("A data delegate must be a function.");return this.dataDelegate=t},n.prototype.setDebug=function(t){return this.debug=t,this.emitEvent=this.debug?this.debugEmitEvent:this.regularEmitEvent},n.prototype.getId=function(){var t,e;return t=function(t){return t.process.id+"() "+t.port.toUpperCase()},e=function(t){return t.port.toUpperCase()+" "+t.process.id+"()"},this.from||this.to?this.from&&!this.to?t(this.from)+" -> ANON":this.from?t(this.from)+" -> "+e(this.to):"DATA -> "+e(this.to):"UNDEFINED"},n.prototype.legacyToIp=function(t,e){if(r.isIP(e))return e;switch(t){case"begingroup":return new r("openBracket",e);case"endgroup":return new r("closeBracket");case"data":return new r("data",e);default:return null}},n.prototype.ipToLegacy=function(t){switch(t.type){case"openBracket":return{event:"begingroup",payload:t.data};case"data":return{event:"data",payload:t.data};case"closeBracket":return{event:"endgroup",payload:t.data}}},n.prototype.handleSocketEvent=function(t,e,n){var o,i,s;if(null==n&&(n=!0),i="ip"===t&&r.isIP(e),o=i?e:this.legacyToIp(t,e)){if(!this.isConnected()&&n&&0===this.brackets.length&&this.connect(),"begingroup"===t&&this.brackets.push(e),i&&"openBracket"===o.type&&this.brackets.push(o.data),"endgroup"===t){if(0===this.brackets.length)return;o.data=this.brackets.pop(),e=o.data}if(i&&"closeBracket"===e.type){if(0===this.brackets.length)return;this.brackets.pop()}if(this.emitEvent("ip",o),o&&o.type)return i&&(t=(s=this.ipToLegacy(o)).event,e=s.payload),"connect"===t&&(this.connected=!0),"disconnect"===t&&(this.connected=!1),this.emitEvent(t,e)}},n}(),e.InternalSocket=o,e.createSocket=function(){return new o}}).call(this)},function(t,e,n){e.graph=n(27),e.Graph=e.graph.Graph,e.journal=n(34),e.Journal=e.journal.Journal},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){(function(t){(function(){var r,o,i,s,a,u=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=n(7),i=n(8),o=n(2).EventEmitter,a=n(35),r=function(e){function n(t,e){this.baseDir=t,this.options=null!=e?e:{},this.components=null,this.libraryIcons={},this.processing=!1,this.ready=!1,"function"==typeof this.setMaxListeners&&this.setMaxListeners(0)}return u(n,o),n.prototype.getModulePrefix=function(t){return t?"noflo"===t?"":("@"===t[0]&&(t=t.replace(/\@[a-z\-]+\//,"")),t.replace("noflo-","")):""},n.prototype.listComponents=function(t){if(this.processing)this.once("ready",function(e){return function(){return t(null,e.components)}}(this));else{if(this.components)return t(null,this.components);this.ready=!1,this.processing=!0,this.components={},a.register(this,function(e){return function(n){if(n){if(t)return t(n);throw n}if(e.processing=!1,e.ready=!0,e.emit("ready",!0),t)return t(null,e.components)}}(this))}},n.prototype.load=function(e,n,r){var o,i;if(this.ready){if(!(o=this.components[e])){for(i in this.components)if(i.split("/")[1]===e){o=this.components[i];break}if(!o)return void n(new Error("Component "+e+" not available with base "+this.baseDir))}if(!this.isGraph(o))return this.createComponent(e,o,r,function(t){return function(r,o){if(r)return n(r);{if(o)return"Graph"===e&&(o.baseDir=t.baseDir),"string"==typeof e&&(o.componentName=e),t.setIcon(e,o),n(null,o);n(new Error("Component "+e+" could not be loaded."))}}}(this));void 0!==t&&t.execPath&&-1!==t.execPath.indexOf("node")?t.nextTick(function(t){return function(){return t.loadGraph(e,o,n,r)}}(this)):setTimeout(function(t){return function(){return t.loadGraph(e,o,n,r)}}(this),0)}else this.listComponents(function(t){return function(o){return o?n(o):t.load(e,n,r)}}(this))},n.prototype.createComponent=function(t,e,n,r){var o,i;if(!(o=e))return r(new Error("Component "+t+" not available"));if("string"==typeof o)return"function"==typeof a.dynamicLoad?void a.dynamicLoad(t,o,n,r):r(Error("Dynamic loading of "+o+" for component "+t+" not available on this platform."));if("function"==typeof o.getComponent)i=o.getComponent(n);else{if("function"!=typeof o)return void r(new Error("Invalid type "+typeof o+" for component "+t+"."));i=o(n)}return r(null,i)},n.prototype.isGraph=function(t){return"object"==typeof t&&t instanceof i.Graph||(!("object"!=typeof t||!t.processes||!t.connections)||"string"==typeof t&&(-1!==t.indexOf(".fbp")||-1!==t.indexOf(".json")))},n.prototype.loadGraph=function(t,e,n,r){this.createComponent(t,this.components.Graph,r,function(r){return function(o,i){if(o)return n(o);s.createSocket(),i.loader=r,i.baseDir=r.baseDir,i.inPorts.remove("graph"),i.setGraph(e,function(e){return e?n(e):(r.setIcon(t,i),n(null,i))})}}(this))},n.prototype.setIcon=function(t,e){var n,r;e.getIcon&&!e.getIcon()&&(n=(r=t.split("/"))[0],r[1]&&this.getLibraryIcon(n)?e.setIcon(this.getLibraryIcon(n)):e.isSubgraph()?e.setIcon("sitemap"):e.setIcon("square"))},n.prototype.getLibraryIcon=function(t){return this.libraryIcons[t]?this.libraryIcons[t]:null},n.prototype.setLibraryIcon=function(t,e){return this.libraryIcons[t]=e},n.prototype.normalizeName=function(t,e){var n,r;return r=this.getModulePrefix(t),n=r+"/"+e,t||(n=e),n},n.prototype.registerComponent=function(t,e,n,r){var o;if(o=this.normalizeName(t,e),this.components[o]=n,r)return r()},n.prototype.registerGraph=function(t,e,n,r){return this.registerComponent(t,e,n,r)},n.prototype.registerLoader=function(t,e){return t(this,e)},n.prototype.setSource=function(t,e,n,r,o){if(!a.setSource)return o(new Error("setSource not allowed"));{if(this.ready)return a.setSource(this,t,e,n,r,o);this.listComponents(function(i){return function(s){return s?o(s):i.setSource(t,e,n,r,o)}}(this))}},n.prototype.getSource=function(t,e){if(!a.getSource)return e(new Error("getSource not allowed"));{if(this.ready)return a.getSource(this,t,e);this.listComponents(function(n){return function(r){return r?e(r):n.getSource(t,e)}}(this))}},n.prototype.clear=function(){return this.components=null,this.ready=!1,this.processing=!1},n}(),e.ComponentLoader=r}).call(this)}).call(e,n(1))},function(t,e,n){(function(){var t,r,o,i=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=n(2).EventEmitter,o=n(5),r=function(e){function n(t){this.type=t,o.deprecated("noflo.Port is deprecated. Please port to noflo.InPort/noflo.OutPort"),this.type||(this.type="all"),"integer"===this.type&&(this.type="int"),this.sockets=[],this.from=null,this.node=null,this.name=null}return i(n,t),n.prototype.description="",n.prototype.required=!0,n.prototype.getId=function(){return this.node&&this.name?this.node+" "+this.name.toUpperCase():"Port"},n.prototype.getDataType=function(){return this.type},n.prototype.getSchema=function(){return null},n.prototype.getDescription=function(){return this.description},n.prototype.attach=function(t){return this.sockets.push(t),this.attachSocket(t)},n.prototype.attachSocket=function(t,e){return null==e&&(e=null),this.emit("attach",t,e),this.from=t.from,t.setMaxListeners&&t.setMaxListeners(0),t.on("connect",function(n){return function(){return n.emit("connect",t,e)}}(this)),t.on("begingroup",function(t){return function(n){return t.emit("begingroup",n,e)}}(this)),t.on("data",function(t){return function(n){return t.emit("data",n,e)}}(this)),t.on("endgroup",function(t){return function(n){return t.emit("endgroup",n,e)}}(this)),t.on("disconnect",function(n){return function(){return n.emit("disconnect",t,e)}}(this))},n.prototype.connect=function(){var t,e,n,r,o;if(0===this.sockets.length)throw new Error(this.getId()+": No connections available");for(r=[],t=0,e=(n=this.sockets).length;t<e;t++)o=n[t],r.push(o.connect());return r},n.prototype.beginGroup=function(t){if(0===this.sockets.length)throw new Error(this.getId()+": No connections available");return this.sockets.forEach(function(e){return e.isConnected()?e.beginGroup(t):(e.once("connect",function(){return e.beginGroup(t)}),e.connect())})},n.prototype.send=function(t){if(0===this.sockets.length)throw new Error(this.getId()+": No connections available");return this.sockets.forEach(function(e){return e.isConnected()?e.send(t):(e.once("connect",function(){return e.send(t)}),e.connect())})},n.prototype.endGroup=function(){var t,e,n,r,o;if(0===this.sockets.length)throw new Error(this.getId()+": No connections available");for(r=[],t=0,e=(n=this.sockets).length;t<e;t++)o=n[t],r.push(o.endGroup());return r},n.prototype.disconnect=function(){var t,e,n,r,o;if(0===this.sockets.length)throw new Error(this.getId()+": No connections available");for(r=[],t=0,e=(n=this.sockets).length;t<e;t++)o=n[t],r.push(o.disconnect());return r},n.prototype.detach=function(t){var e;if(0!==this.sockets.length&&(t||(t=this.sockets[0]),-1!==(e=this.sockets.indexOf(t))))return this.isAddressable()?(this.sockets[e]=void 0,void this.emit("detach",t,e)):(this.sockets.splice(e,1),this.emit("detach",t))},n.prototype.isConnected=function(){var t;return t=!1,this.sockets.forEach(function(e){if(e.isConnected())return t=!0}),t},n.prototype.isAddressable=function(){return!1},n.prototype.isRequired=function(){return this.required},n.prototype.isAttached=function(){return this.sockets.length>0},n.prototype.listAttached=function(){var t,e,n,r,o;for(t=[],n=e=0,r=(o=this.sockets).length;e<r;n=++e)o[n]&&t.push(n);return t},n.prototype.canAttach=function(){return!0},n.prototype.clear=function(){},n}(),e.Port=r}).call(this)},function(t,e){(function(){var t,n,r,o;t=function(){function t(t){this.data=t}return t.prototype.sendTo=function(t){return t.send(this.data)},t.prototype.getValue=function(){return this.data},t.prototype.toObject=function(){return this.data},t}(),e.IP=t,o=function(){function e(t){this.key=t,this.value=[]}return e.prototype.push=function(t){return this.value.push(t)},e.prototype.sendTo=function(n){var r,o,i,s;for(n.beginGroup(this.key),r=0,i=(s=this.value).length;r<i;r++)(o=s[r])instanceof e||o instanceof t?o.sendTo(n):n.send(o);return n.endGroup(this.key)},e.prototype.getKey=function(){return this.key},e.prototype.getValue=function(){var t,n,r,o,i,s,a;switch(this.value.length){case 0:return null;case 1:return"function"==typeof this.value[0].getValue?this.value[0]instanceof e?(o={},o[this.value[0].key]=this.value[0].getValue(),o):this.value[0].getValue():this.value[0];default:for(s=[],!1,t=0,r=(i=this.value).length;t<r;t++)a="function"==typeof(n=i[t]).getValue?n.getValue():n,n instanceof e?((o={})[n.key]=n.getValue(),s.push(o)):s.push(a);return s}},e.prototype.toObject=function(){var t;return t={},t[this.key]=this.getValue(),t},e}(),e.Substream=o,r=function(){function e(t,e){this.port=t,this.ordered=null!=e&&e,this.q=[],this.resetCurrent(),this.resolved=!1}return e.prototype.resetCurrent=function(){return this.level=0,this.current=null,this.stack=[]},e.prototype.beginGroup=function(t){var e;return this.level++,e=new o(t),this.stack.push(e),this.current=e,this},e.prototype.endGroup=function(){var t,e;return this.level>0&&this.level--,e=this.stack.pop(),0===this.level?(this.q.push(e),this.resetCurrent()):((t=this.stack[this.stack.length-1]).push(e),this.current=t),this},e.prototype.send=function(e){return 0===this.level?this.q.push(new t(e)):this.current.push(new t(e)),this},e.prototype.done=function(){return this.ordered?this.resolved=!0:this.flush(),this},e.prototype.disconnect=function(){return this.q.push(null),this},e.prototype.flush=function(){var t,e,n,r,o;if(o=!1,this.q.length>0){for(t=0,n=(r=this.q).length;t<n;t++)null===(e=r[t])?this.port.isConnected()&&this.port.disconnect():e.sendTo(this.port);o=!0}return this.q=[],o},e.prototype.isAttached=function(){return this.port.isAttached()},e}(),e.StreamSender=r,n=function(){function e(e,n,r){this.port=e,this.buffered=null!=n&&n,this.process=null!=r?r:null,this.q=[],this.resetCurrent(),this.port.process=function(e){return function(n,r,i){var s;switch(n){case"connect":if("function"==typeof e.process)return e.process("connect",i);break;case"begingroup":return e.level++,s=new o(r),1===e.level?(e.root=s,e.parent=null):e.parent=e.current,e.current=s;case"endgroup":return e.level>0&&e.level--,0===e.level?(e.buffered?(e.q.push(e.root),e.process("readable",i)):"function"==typeof e.process&&e.process("data",e.root,i),e.resetCurrent()):(e.parent.push(e.current),e.current=e.parent);case"data":return 0===e.level?e.q.push(new t(r)):e.current.push(new t(r));case"disconnect":if("function"==typeof e.process)return e.process("disconnect",i)}}}(this)}return e.prototype.resetCurrent=function(){return this.level=0,this.root=null,this.current=null,this.parent=null},e.prototype.read=function(){if(0!==this.q.length)return this.q.shift()},e}(),e.StreamReceiver=n}).call(this)},function(t,e,n){(function(e){var n=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}function n(r,u,c,p,d){function l(r,c){if(null===r)return null;if(0===c)return r;var m,v;if("object"!=typeof r)return r;if(t(r,i))m=new i;else if(t(r,s))m=new s;else if(t(r,a))m=new a(function(t,e){r.then(function(e){t(l(e,c-1))},function(t){e(l(t,c-1))})});else if(n.__isArray(r))m=[];else if(n.__isRegExp(r))m=new RegExp(r.source,o(r)),r.lastIndex&&(m.lastIndex=r.lastIndex);else if(n.__isDate(r))m=new Date(r.getTime());else{if(g&&e.isBuffer(r))return m=new e(r.length),r.copy(m),m;t(r,Error)?m=Object.create(r):void 0===p?(v=Object.getPrototypeOf(r),m=Object.create(v)):(m=Object.create(p),v=p)}if(u){var y=f.indexOf(r);if(-1!=y)return h[y];f.push(r),h.push(m)}t(r,i)&&r.forEach(function(t,e){var n=l(e,c-1),r=l(t,c-1);m.set(n,r)}),t(r,s)&&r.forEach(function(t){var e=l(t,c-1);m.add(e)});for(var b in r){var w;v&&(w=Object.getOwnPropertyDescriptor(v,b)),w&&null==w.set||(m[b]=l(r[b],c-1))}if(Object.getOwnPropertySymbols)for(var P=Object.getOwnPropertySymbols(r),b=0;b<P.length;b++){var k=P[b];(!(C=Object.getOwnPropertyDescriptor(r,k))||C.enumerable||d)&&(m[k]=l(r[k],c-1),C.enumerable||Object.defineProperty(m,k,{enumerable:!1}))}if(d)for(var E=Object.getOwnPropertyNames(r),b=0;b<E.length;b++){var _=E[b],C=Object.getOwnPropertyDescriptor(r,_);C&&C.enumerable||(m[_]=l(r[_],c-1),Object.defineProperty(m,_,{enumerable:!1}))}return m}"object"==typeof u&&(c=u.depth,p=u.prototype,d=u.includeNonEnumerable,u=u.circular);var f=[],h=[],g=void 0!==e;return void 0===u&&(u=!0),void 0===c&&(c=1/0),l(r,c)}function r(t){return Object.prototype.toString.call(t)}function o(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}var i;try{i=Map}catch(t){i=function(){}}var s;try{s=Set}catch(t){s=function(){}}var a;try{a=Promise}catch(t){a=function(){}}return n.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},n.__objToStr=r,n.__isDate=function(t){return"object"==typeof t&&"[object Date]"===r(t)},n.__isArray=function(t){return"object"==typeof t&&"[object Array]"===r(t)},n.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===r(t)},n.__getRegExpFlags=o,n}();"object"==typeof t&&t.exports&&(t.exports=n)}).call(e,n(14).Buffer)},function(t,e,n){"use strict";(function(t){function r(){return i.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(t,e){if(r()<e)throw new RangeError("Invalid typed array length");return i.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=i.prototype:(null===t&&(t=new i(e)),t.length=e),t}function i(t,e,n){if(!(i.TYPED_ARRAY_SUPPORT||this instanceof i))return new i(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return s(this,t,e,n)}function s(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?l(t,e,n,r):"string"==typeof e?p(t,e,n):f(t,e)}function a(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function u(t,e,n,r){return a(e),e<=0?o(t,e):void 0!==n?"string"==typeof r?o(t,e).fill(n,r):o(t,e).fill(n):o(t,e)}function c(t,e){if(a(e),t=o(t,e<0?0:0|h(e)),!i.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function p(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!i.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|g(e,n),s=(t=o(t,r)).write(e,n);return s!==r&&(t=t.slice(0,s)),t}function d(t,e){var n=e.length<0?0:0|h(e.length);t=o(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function l(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),i.TYPED_ARRAY_SUPPORT?(t=e).__proto__=i.prototype:t=d(t,e),t}function f(t,e){if(i.isBuffer(e)){var n=0|h(e.length);return 0===(t=o(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||K(e.length)?o(t,0):d(t,e);if("Buffer"===e.type&&Q(e.data))return d(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function h(t){if(t>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|t}function g(t,e){if(i.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return W(t).length;default:if(r)return z(t).length;e=(""+e).toLowerCase(),r=!0}}function m(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,e>>>=0,n<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return A(this,e,n);case"utf8":case"utf-8":return x(this,e,n);case"ascii":return O(this,e,n);case"latin1":case"binary":return I(this,e,n);case"base64":return D(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function v(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function y(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=i.from(e,r)),i.isBuffer(e))return 0===e.length?-1:b(t,e,n,r,o);if("number"==typeof e)return e&=255,i.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):b(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function b(t,e,n,r,o){function i(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}var s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}var c;if(o){var p=-1;for(c=n;c<a;c++)if(i(t,c)===i(e,-1===p?0:c-p)){if(-1===p&&(p=c),c-p+1===u)return p*s}else-1!==p&&(c-=c-p),p=-1}else for(n+u>a&&(n=a-u),c=n;c>=0;c--){for(var d=!0,l=0;l<u;l++)if(i(t,c+l)!==i(e,l)){d=!1;break}if(d)return c}return-1}function w(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function P(t,e,n,r){return J(z(e,t.length-n),t,n,r)}function k(t,e,n,r){return J(H(e),t,n,r)}function E(t,e,n,r){return k(t,e,n,r)}function _(t,e,n,r){return J(W(e),t,n,r)}function C(t,e,n,r){return J(Y(e,t.length-n),t,n,r)}function D(t,e,n){return 0===e&&n===t.length?X.fromByteArray(t):X.fromByteArray(t.slice(e,n))}function x(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var i=t[o],s=null,a=i>239?4:i>223?3:i>191?2:1;if(o+a<=n){var u,c,p,d;switch(a){case 1:i<128&&(s=i);break;case 2:128==(192&(u=t[o+1]))&&(d=(31&i)<<6|63&u)>127&&(s=d);break;case 3:u=t[o+1],c=t[o+2],128==(192&u)&&128==(192&c)&&(d=(15&i)<<12|(63&u)<<6|63&c)>2047&&(d<55296||d>57343)&&(s=d);break;case 4:u=t[o+1],c=t[o+2],p=t[o+3],128==(192&u)&&128==(192&c)&&128==(192&p)&&(d=(15&i)<<18|(63&u)<<12|(63&c)<<6|63&p)>65535&&d<1114112&&(s=d)}}null===s?(s=65533,a=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),o+=a}return S(r)}function S(t){var e=t.length;if(e<=Z)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=Z));return n}function O(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function I(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function A(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=U(t[i]);return o}function N(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function T(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function R(t,e,n,r,o,s){if(!i.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<s)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function L(t,e,n,r){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-n,2);o<i;++o)t[n+o]=(e&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function B(t,e,n,r){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-n,4);o<i;++o)t[n+o]=e>>>8*(r?o:3-o)&255}function G(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function j(t,e,n,r,o){return o||G(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),V.write(t,e,n,r,23,4),n+4}function F(t,e,n,r,o){return o||G(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),V.write(t,e,n,r,52,8),n+8}function M(t){if((t=q(t).replace($,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function q(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function U(t){return t<16?"0"+t.toString(16):t.toString(16)}function z(t,e){e=e||1/0;for(var n,r=t.length,o=null,i=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function H(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function Y(t,e){for(var n,r,o,i=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,o=n%256,i.push(o),i.push(r);return i}function W(t){return X.toByteArray(M(t))}function J(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}function K(t){return t!==t}var X=n(28),V=n(29),Q=n(30);e.Buffer=i,e.SlowBuffer=function(t){return+t!=t&&(t=0),i.alloc(+t)},e.INSPECT_MAX_BYTES=50,i.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=r(),i.poolSize=8192,i._augment=function(t){return t.__proto__=i.prototype,t},i.from=function(t,e,n){return s(null,t,e,n)},i.TYPED_ARRAY_SUPPORT&&(i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0})),i.alloc=function(t,e,n){return u(null,t,e,n)},i.allocUnsafe=function(t){return c(null,t)},i.allocUnsafeSlow=function(t){return c(null,t)},i.isBuffer=function(t){return!(null==t||!t._isBuffer)},i.compare=function(t,e){if(!i.isBuffer(t)||!i.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,o=0,s=Math.min(n,r);o<s;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},i.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(t,e){if(!Q(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return i.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=i.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var s=t[n];if(!i.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,o),o+=s.length}return r},i.byteLength=g,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)v(this,e,e+1);return this},i.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)v(this,e,e+3),v(this,e+1,e+2);return this},i.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)v(this,e,e+7),v(this,e+1,e+6),v(this,e+2,e+5),v(this,e+3,e+4);return this},i.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?x(this,0,t):m.apply(this,arguments)},i.prototype.equals=function(t){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===i.compare(this,t)},i.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},i.prototype.compare=function(t,e,n,r,o){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,o>>>=0,this===t)return 0;for(var s=o-r,a=n-e,u=Math.min(s,a),c=this.slice(r,o),p=t.slice(e,n),d=0;d<u;++d)if(c[d]!==p[d]){s=c[d],a=p[d];break}return s<a?-1:a<s?1:0},i.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},i.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},i.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},i.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return w(this,t,e,n);case"utf8":case"utf-8":return P(this,t,e,n);case"ascii":return k(this,t,e,n);case"latin1":case"binary":return E(this,t,e,n);case"base64":return _(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Z=4096;i.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),e<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r;if(i.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=i.prototype;else{var o=e-t;r=new i(o,void 0);for(var s=0;s<o;++s)r[s]=this[s+t]}return r},i.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},i.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},i.prototype.readUInt8=function(t,e){return e||T(t,1,this.length),this[t]},i.prototype.readUInt16LE=function(t,e){return e||T(t,2,this.length),this[t]|this[t+1]<<8},i.prototype.readUInt16BE=function(t,e){return e||T(t,2,this.length),this[t]<<8|this[t+1]},i.prototype.readUInt32LE=function(t,e){return e||T(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},i.prototype.readUInt32BE=function(t,e){return e||T(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},i.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*e)),r},i.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},i.prototype.readInt8=function(t,e){return e||T(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},i.prototype.readInt16LE=function(t,e){e||T(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt16BE=function(t,e){e||T(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt32LE=function(t,e){return e||T(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},i.prototype.readInt32BE=function(t,e){return e||T(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},i.prototype.readFloatLE=function(t,e){return e||T(t,4,this.length),V.read(this,t,!0,23,4)},i.prototype.readFloatBE=function(t,e){return e||T(t,4,this.length),V.read(this,t,!1,23,4)},i.prototype.readDoubleLE=function(t,e){return e||T(t,8,this.length),V.read(this,t,!0,52,8)},i.prototype.readDoubleBE=function(t,e){return e||T(t,8,this.length),V.read(this,t,!1,52,8)},i.prototype.writeUIntLE=function(t,e,n,r){t=+t,e|=0,n|=0,r||R(this,t,e,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},i.prototype.writeUIntBE=function(t,e,n,r){t=+t,e|=0,n|=0,r||R(this,t,e,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},i.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,1,255,0),i.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},i.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):L(this,t,e,!0),e+2},i.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):L(this,t,e,!1),e+2},i.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):B(this,t,e,!0),e+4},i.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):B(this,t,e,!1),e+4},i.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);R(this,t,e,n,o-1,-o)}var i=0,s=1,a=0;for(this[e]=255&t;++i<n&&(s*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},i.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);R(this,t,e,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},i.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,1,127,-128),i.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},i.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):L(this,t,e,!0),e+2},i.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):L(this,t,e,!1),e+2},i.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,4,2147483647,-2147483648),i.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):B(this,t,e,!0),e+4},i.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):B(this,t,e,!1),e+4},i.prototype.writeFloatLE=function(t,e,n){return j(this,t,e,!0,n)},i.prototype.writeFloatBE=function(t,e,n){return j(this,t,e,!1,n)},i.prototype.writeDoubleLE=function(t,e,n){return F(this,t,e,!0,n)},i.prototype.writeDoubleBE=function(t,e,n){return F(this,t,e,!1,n)},i.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o,s=r-n;if(this===t&&n<e&&e<r)for(o=s-1;o>=0;--o)t[o+e]=this[o+n];else if(s<1e3||!i.TYPED_ARRAY_SUPPORT)for(o=0;o<s;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},i.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!i.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0);var s;if("number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var a=i.isBuffer(t)?t:z(new i(t,r).toString()),u=a.length;for(s=0;s<n-e;++s)this[s+e]=a[s%u]}return this};var $=/[^+\/0-9A-Za-z-_]/g}).call(e,n(9))},function(t,e,n){(function(t){(function(){var r,o,i,s,a,u,c,p=function(t,e){function n(){this.constructor=t}for(var r in e)d.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},d={}.hasOwnProperty;a=n(7),n(8),r=n(2).EventEmitter,u=n(5),s=n(10),c=n(17),o=n(4),i=function(e){function n(e,n){this.options=null!=n?n:{},this.processes={},this.connections=[],this.initials=[],this.nextInitials=[],this.defaults=[],this.graph=e,this.started=!1,this.stopped=!0,this.debug=!0,this.eventBuffer=[],u.isBrowser()?this.baseDir=e.baseDir||"/":this.baseDir=e.baseDir||t.cwd(),this.startupDate=null,e.componentLoader?this.loader=e.componentLoader:this.loader=new s.ComponentLoader(this.baseDir,this.options)}return p(n,r),n.prototype.processes={},n.prototype.connections=[],n.prototype.initials=[],n.prototype.defaults=[],n.prototype.graph=null,n.prototype.startupDate=null,n.prototype.uptime=function(){return this.startupDate?new Date-this.startupDate:0},n.prototype.getActiveProcesses=function(){var t,e,n,r;if(t=[],!this.started)return t;r=this.processes;for(e in r)(n=r[e]).component.load>0&&t.push(e),n.component.__openConnections>0&&t.push(e);return t},n.prototype.bufferedEmit=function(t,e){var n,r,o,i;if("error"!==t&&"process-error"!==t&&"end"!==t)if(this.isStarted()||"end"===t){if(this.emit(t,e),"start"===t){for(r=0,o=(i=this.eventBuffer).length;r<o;r++)n=i[r],this.emit(n.type,n.payload);return this.eventBuffer=[]}}else this.eventBuffer.push({type:t,payload:e});else this.emit(t,e)},n.prototype.load=function(t,e,n){return this.loader.load(t,n,e)},n.prototype.addNode=function(t,e){var n;{if(!this.processes[t.id])return n={id:t.id},t.component?this.load(t.component,t.metadata,function(r){return function(o,i){var s,a,u,c;if(o)return e(o);i.nodeId=t.id,n.component=i,n.componentName=t.component,s=n.component.inPorts.ports||n.component.inPorts,u=n.component.outPorts.ports||n.component.outPorts;for(a in s)(c=s[a]).node=t.id,c.nodeInstance=i,c.name=a;for(a in u)(c=u[a]).node=t.id,c.nodeInstance=i,c.name=a;return i.isSubgraph()&&r.subscribeSubgraph(n),r.subscribeNode(n),r.processes[n.id]=n,e(null,n)}}(this)):(this.processes[n.id]=n,void e(null,n));e(null,this.processes[t.id])}},n.prototype.removeNode=function(t,e){return this.processes[t.id]?this.processes[t.id].component.shutdown(function(n){return function(r){return r?e(r):(delete n.processes[t.id],e(null))}}(this)):e(new Error("Node "+t.id+" not found"))},n.prototype.renameNode=function(t,e,n){var r,o,i,s,a;if(!(a=this.getNode(t)))return n(new Error("Process "+t+" not found"));a.id=e,r=a.component.inPorts.ports||a.component.inPorts,i=a.component.outPorts.ports||a.component.outPorts;for(o in r)(s=r[o])&&(s.node=e);for(o in i)(s=i[o])&&(s.node=e);return this.processes[e]=a,delete this.processes[t],n(null)},n.prototype.getNode=function(t){return this.processes[t]},n.prototype.connect=function(t){var e,n,r,o,i,s;return null==t&&(t=function(){}),e=0,o=function(n){return function(r,o){return function(i){return n["add"+i](o,function(n){return n?t(n):++e%100!=0?r(i):void setTimeout(function(){return r(i)},0)})}}}(this),s=function(e){return function(){return e.subscribeGraph(),t()}}(this),i=c.reduceRight(this.graph.nodes,o,s),r=c.reduceRight(this.graph.initializers,o,function(){return i("Defaults")}),n=c.reduceRight(this.graph.edges,o,function(){return r("Initial")}),c.reduceRight(this.graph.nodes,o,function(){return n("Edge")})("Node")},n.prototype.connectPort=function(t,e,n,r,o,i){if(o)return t.to={process:e,port:n,index:r},e.component.inPorts&&e.component.inPorts[n]?e.component.inPorts[n].isAddressable()?(e.component.inPorts[n].attach(t,r),void i()):(e.component.inPorts[n].attach(t),void i()):void i(new Error("No inport '"+n+"' defined in process "+e.id+" ("+t.getId()+")"));if(t.from={process:e,port:n,index:r},e.component.outPorts&&e.component.outPorts[n]){if(e.component.outPorts[n].isAddressable())return e.component.outPorts[n].attach(t,r),void i();e.component.outPorts[n].attach(t),i()}else i(new Error("No outport '"+n+"' defined in process "+e.id+" ("+t.getId()+")"))},n.prototype.subscribeGraph=function(){var t,e,n,r;return t=[],n=!1,r=function(e,n){return t.push({op:e,details:n})},e=function(r){return function(o){var i,s;if(o){if(0===r.listeners("process-error").length)throw o;r.bufferedEmit("process-error",o)}if(t.length)switch(n=!0,s=t.shift(),i=e,s.op){case"renameNode":return r.renameNode(s.details.from,s.details.to,i);default:return r[s.op](s.details,i)}else n=!1}}(this),this.graph.on("addNode",function(t){if(r("addNode",t),!n)return e()}),this.graph.on("removeNode",function(t){if(r("removeNode",t),!n)return e()}),this.graph.on("renameNode",function(t,o){if(r("renameNode",{from:t,to:o}),!n)return e()}),this.graph.on("addEdge",function(t){if(r("addEdge",t),!n)return e()}),this.graph.on("removeEdge",function(t){if(r("removeEdge",t),!n)return e()}),this.graph.on("addInitial",function(t){if(r("addInitial",t),!n)return e()}),this.graph.on("removeInitial",function(t){if(r("removeInitial",t),!n)return e()})},n.prototype.subscribeSubgraph=function(t){var e;if(t.component.isReady()){if(t.component.network)return t.component.network.setDebug(this.debug),e=function(e){return function(n,r){if("process-error"===n&&0===e.listeners("process-error").length){if(r.id&&r.metadata&&r.error)throw r.error;throw r}return r||(r={}),r.subgraph?(r.subgraph.unshift||(r.subgraph=[r.subgraph]),r.subgraph=r.subgraph.unshift(t.id)):r.subgraph=[t.id],e.bufferedEmit(n,r)}}(this),t.component.network.on("connect",function(t){return e("connect",t)}),t.component.network.on("begingroup",function(t){return e("begingroup",t)}),t.component.network.on("data",function(t){return e("data",t)}),t.component.network.on("endgroup",function(t){return e("endgroup",t)}),t.component.network.on("disconnect",function(t){return e("disconnect",t)}),t.component.network.on("ip",function(t){return e("ip",t)}),t.component.network.on("process-error",function(t){return e("process-error",t)})}else t.component.once("ready",function(e){return function(){return e.subscribeSubgraph(t)}}(this))},n.prototype.subscribeSocket=function(t,e){return t.on("ip",function(e){return function(n){return e.bufferedEmit("ip",{id:t.getId(),type:n.type,socket:t,data:n.data,metadata:t.metadata})}}(this)),t.on("connect",function(n){return function(){return e&&e.component.isLegacy()&&(e.component.__openConnections||(e.component.__openConnections=0),e.component.__openConnections++),n.bufferedEmit("connect",{id:t.getId(),socket:t,metadata:t.metadata})}}(this)),t.on("begingroup",function(e){return function(n){return e.bufferedEmit("begingroup",{id:t.getId(),socket:t,group:n,metadata:t.metadata})}}(this)),t.on("data",function(e){return function(n){return e.bufferedEmit("data",{id:t.getId(),socket:t,data:n,metadata:t.metadata})}}(this)),t.on("endgroup",function(e){return function(n){return e.bufferedEmit("endgroup",{id:t.getId(),socket:t,group:n,metadata:t.metadata})}}(this)),t.on("disconnect",function(n){return function(){if(n.bufferedEmit("disconnect",{id:t.getId(),socket:t,metadata:t.metadata}),e&&e.component.isLegacy()&&(e.component.__openConnections--,e.component.__openConnections<0&&(e.component.__openConnections=0),0===e.component.__openConnections))return n.checkIfFinished()}}(this)),t.on("error",function(t){return function(e){if(0===t.listeners("process-error").length){if(e.id&&e.metadata&&e.error)throw e.error;throw e}return t.bufferedEmit("process-error",e)}}(this))},n.prototype.subscribeNode=function(t){if(t.component.on("deactivate",function(t){return function(e){if(!(e>0))return t.checkIfFinished()}}(this)),t.component.getIcon)return t.component.on("icon",function(e){return function(){return e.bufferedEmit("icon",{id:t.id,icon:t.component.getIcon()})}}(this))},n.prototype.addEdge=function(t,e){var n,r,o;if((r=a.createSocket(t.metadata)).setDebug(this.debug),!(n=this.getNode(t.from.node)))return e(new Error("No process defined for outbound node "+t.from.node));if(!n.component)return e(new Error("No component defined for outbound node "+t.from.node));if(n.component.isReady()){if(!(o=this.getNode(t.to.node)))return e(new Error("No process defined for inbound node "+t.to.node));if(!o.component)return e(new Error("No component defined for inbound node "+t.to.node));if(o.component.isReady())return this.subscribeSocket(r,n),this.connectPort(r,o,t.to.port,t.to.index,!0,function(o){return function(i){return i?e(i):o.connectPort(r,n,t.from.port,t.from.index,!1,function(t){return t?e(t):(o.connections.push(r),e())})}}(this));o.component.once("ready",function(n){return function(){return n.addEdge(t,e)}}(this))}else n.component.once("ready",function(n){return function(){return n.addEdge(t,e)}}(this))},n.prototype.removeEdge=function(t,e){var n,r,o,i,s;for(s=[],r=0,o=(i=this.connections).length;r<o;r++)(n=i[r])&&t.to.node===n.to.process.id&&t.to.port===n.to.port&&(n.to.process.component.inPorts[n.to.port].detach(n),t.from.node&&n.from&&t.from.node===n.from.process.id&&t.from.port===n.from.port&&n.from.process.component.outPorts[n.from.port].detach(n),this.connections.splice(this.connections.indexOf(n),1),s.push(e()));return s},n.prototype.addDefaults=function(t,e){var n,r,o,i,s;if(!(o=this.processes[t.id]).component.isReady())return o.component.setMaxListeners&&o.component.setMaxListeners(0),void o.component.once("ready",function(t){return function(){return t.addDefaults(o,e)}}(this));i=o.component.inPorts.ports;for(n in i)"function"==typeof(r=i[n]).hasDefault&&r.hasDefault()&&!r.isAttached()&&((s=a.createSocket()).setDebug(this.debug),this.subscribeSocket(s),this.connectPort(s,o,n,void 0,!0,function(){}),this.connections.push(s),this.defaults.push(s));return e()},n.prototype.addInitial=function(t,e){var n,r;return(n=a.createSocket(t.metadata)).setDebug(this.debug),this.subscribeSocket(n),(r=this.getNode(t.to.node))?r.component.isReady()||r.component.inPorts[t.to.port]?this.connectPort(n,r,t.to.port,t.to.index,!0,function(r){return function(o){var i;return o?e(o):(r.connections.push(n),i={socket:n,data:t.from.data},r.initials.push(i),r.nextInitials.push(i),r.isRunning()?r.sendInitials():r.isStopped()||(r.setStarted(!0),r.sendInitials()),e())}}(this)):(r.component.setMaxListeners&&r.component.setMaxListeners(0),void r.component.once("ready",function(n){return function(){return n.addInitial(t,e)}}(this))):e(new Error("No process defined for inbound node "+t.to.node))},n.prototype.removeInitial=function(t,e){var n,r,o,i,s,a,u,c,p,d,l;for(r=0,a=(p=this.connections).length;r<a;r++)if((n=p[r])&&t.to.node===n.to.process.id&&t.to.port===n.to.port){for(n.to.process.component.inPorts[n.to.port].detach(n),this.connections.splice(this.connections.indexOf(n),1),i=0,u=(d=this.initials).length;i<u;i++)(o=d[i])&&o.socket===n&&this.initials.splice(this.initials.indexOf(o),1);for(s=0,c=(l=this.nextInitials).length;s<c;s++)(o=l[s])&&o.socket===n&&this.nextInitials.splice(this.nextInitials.indexOf(o),1)}return e()},n.prototype.sendInitial=function(t){return t.socket.post(new o("data",t.data,{initial:!0}))},n.prototype.sendInitials=function(e){var n;return e||(e=function(){}),n=function(t){return function(){var n,r,o,i;for(n=0,o=(i=t.initials).length;n<o;n++)r=i[n],t.sendInitial(r);return t.initials=[],e()}}(this),void 0!==t&&t.execPath&&-1!==t.execPath.indexOf("node")?t.nextTick(n):setTimeout(n,0)},n.prototype.isStarted=function(){return this.started},n.prototype.isStopped=function(){return this.stopped},n.prototype.isRunning=function(){return!!this.started&&this.getActiveProcesses().length>0},n.prototype.startComponents=function(t){var e,n,r,o,i,s,a;if(t||(t=function(){}),e=0,r=this.processes?Object.keys(this.processes).length:0,o=function(n){return n?t(n):++e===r?t():void 0},!this.processes||!Object.keys(this.processes).length)return t();s=this.processes,a=[];for(n in s)(i=s[n]).component.isStarted()?o():0!==i.component.start.length?a.push(i.component.start(o)):(u.deprecated("component.start method without callback is deprecated"),i.component.start(),o());return a},n.prototype.sendDefaults=function(t){var e,n,r,o;if(t||(t=function(){}),!this.defaults.length)return t();for(e=0,n=(r=this.defaults).length;e<n;e++)1===(o=r[e]).to.process.component.inPorts[o.to.port].sockets.length&&(o.connect(),o.send(),o.disconnect());return t()},n.prototype.start=function(t){if(t||(u.deprecated("Calling network.start() without callback is deprecated"),t=function(){}),this.debouncedEnd&&(this.abortDebounce=!0),!this.started)return this.initials=this.nextInitials.slice(0),this.eventBuffer=[],this.startComponents(function(e){return function(n){return n?t(n):e.sendInitials(function(n){return n?t(n):e.sendDefaults(function(n){return n?t(n):(e.setStarted(!0),t(null))})})}}(this));this.stop(function(e){return function(n){return n?t(n):e.start(t)}}(this))},n.prototype.stop=function(t){var e,n,r,o,i,s,a,c,p,d,l;if(t||(u.deprecated("Calling network.stop() without callback is deprecated"),t=function(){}),this.debouncedEnd&&(this.abortDebounce=!0),!this.started)return this.stopped=!0,t(null);for(r=0,i=(p=this.connections).length;r<i;r++)(e=p[r]).isConnected()&&e.disconnect();if(n=0,s=this.processes?Object.keys(this.processes).length:0,a=function(e){return function(r){return r?t(r):++n===s?(e.setStarted(!1),e.stopped=!0,t()):void 0}}(this),!this.processes||!Object.keys(this.processes).length)return this.setStarted(!1),this.stopped=!0,t();d=this.processes,l=[];for(o in d)(c=d[o]).component.isStarted()?0!==c.component.shutdown.length?l.push(c.component.shutdown(a)):(u.deprecated("component.shutdown method without callback is deprecated"),c.component.shutdown(),a()):a();return l},n.prototype.setStarted=function(t){if(this.started!==t)return t?(this.startupDate||(this.startupDate=new Date),this.started=!0,this.stopped=!1,this.bufferedEmit("start",{start:this.startupDate})):(this.started=!1,void this.bufferedEmit("end",{start:this.startupDate,end:new Date,uptime:this.uptime()}))},n.prototype.checkIfFinished=function(){if(!this.isRunning())return delete this.abortDebounce,this.debouncedEnd||(this.debouncedEnd=c.debounce(function(t){return function(){if(!t.abortDebounce&&!t.isRunning())return t.setStarted(!1)}}(this),50)),this.debouncedEnd()},n.prototype.getDebug=function(){return this.debug},n.prototype.setDebug=function(t){var e,n,r,o,i,s,a;if(t!==this.debug){for(this.debug=t,e=0,r=(i=this.connections).length;e<r;e++)i[e].setDebug(t);s=this.processes,a=[];for(o in s)(n=s[o].component).isSubgraph()?a.push(n.network.setDebug(t)):a.push(void 0);return a}},n}(),e.Network=i}).call(this)}).call(e,n(1))},function(t,e,n){(function(t,r){function o(t,n){var r={seen:[],stylize:s};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(n)?r.showHidden=n:n&&e._extend(r,n),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=i),u(r,t,r.depth)}function i(t,e){var n=o.styles[e];return n?"["+o.colors[n][0]+"m"+t+"["+o.colors[n][1]+"m":t}function s(t,e){return t}function a(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function u(t,n,r){if(t.customInspect&&n&&_(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,t);return y(o)||(o=u(t,o,r)),o}var i=c(t,n);if(i)return i;var s=Object.keys(n),g=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),E(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return p(n);if(0===s.length){if(_(n)){var m=n.name?": "+n.name:"";return t.stylize("[Function"+m+"]","special")}if(w(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(k(n))return t.stylize(Date.prototype.toString.call(n),"date");if(E(n))return p(n)}var v="",b=!1,P=["{","}"];if(h(n)&&(b=!0,P=["[","]"]),_(n)&&(v=" [Function"+(n.name?": "+n.name:"")+"]"),w(n)&&(v=" "+RegExp.prototype.toString.call(n)),k(n)&&(v=" "+Date.prototype.toUTCString.call(n)),E(n)&&(v=" "+p(n)),0===s.length&&(!b||0==n.length))return P[0]+v+P[1];if(r<0)return w(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special");t.seen.push(n);var C;return C=b?d(t,n,r,g,s):s.map(function(e){return l(t,n,r,g,e,b)}),t.seen.pop(),f(C,v,P)}function c(t,e){if(b(e))return t.stylize("undefined","undefined");if(y(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return v(e)?t.stylize(""+e,"number"):g(e)?t.stylize(""+e,"boolean"):m(e)?t.stylize("null","null"):void 0}function p(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,e,n,r,o){for(var i=[],s=0,a=e.length;s<a;++s)S(e,String(s))?i.push(l(t,e,n,r,String(s),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(l(t,e,n,r,o,!0))}),i}function l(t,e,n,r,o,i){var s,a,c;if((c=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?a=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(a=t.stylize("[Setter]","special")),S(r,o)||(s="["+o+"]"),a||(t.seen.indexOf(c.value)<0?(a=m(n)?u(t,c.value,null):u(t,c.value,n-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),b(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function f(t,e,n){var r=0;return t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function h(t){return Array.isArray(t)}function g(t){return"boolean"==typeof t}function m(t){return null===t}function v(t){return"number"==typeof t}function y(t){return"string"==typeof t}function b(t){return void 0===t}function w(t){return P(t)&&"[object RegExp]"===C(t)}function P(t){return"object"==typeof t&&null!==t}function k(t){return P(t)&&"[object Date]"===C(t)}function E(t){return P(t)&&("[object Error]"===C(t)||t instanceof Error)}function _(t){return"function"==typeof t}function C(t){return Object.prototype.toString.call(t)}function D(t){return t<10?"0"+t.toString(10):t.toString(10)}function x(){var t=new Date,e=[D(t.getHours()),D(t.getMinutes()),D(t.getSeconds())].join(":");return[t.getDate(),N[t.getMonth()],e].join(" ")}function S(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var O=/%[sdj%]/g;e.format=function(t){if(!y(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(o(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,i=r.length,s=String(t).replace(O,function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),a=r[n];n<i;a=r[++n])m(a)||!P(a)?s+=" "+a:s+=" "+o(a);return s},e.deprecate=function(n,o){if(b(t.process))return function(){return e.deprecate(n,o).apply(this,arguments)};if(!0===r.noDeprecation)return n;var i=!1;return function(){if(!i){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?console.trace(o):console.error(o),i=!0}return n.apply(this,arguments)}};var I,A={};e.debuglog=function(t){if(b(I)&&(I=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!A[t])if(new RegExp("\\b"+t+"\\b","i").test(I)){var n=r.pid;A[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else A[t]=function(){};return A[t]},e.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=h,e.isBoolean=g,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=v,e.isString=y,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=b,e.isRegExp=w,e.isObject=P,e.isDate=k,e.isError=E,e.isFunction=_,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(48);var N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.log=function(){console.log("%s - %s",x(),e.format.apply(e,arguments))},e.inherits=n(49),e._extend=function(t,e){if(!e||!P(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(e,n(9),n(1))},function(t,e){(function(){var t,n,r,o,i,s,a,u,c,p,d,l;t=function(e){var n,r,o;if(null==e||"object"!=typeof e)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return n="",null!=e.global&&(n+="g"),null!=e.ignoreCase&&(n+="i"),null!=e.multiline&&(n+="m"),null!=e.sticky&&(n+="y"),new RegExp(e.source,n);o=new e.constructor;for(r in e)o[r]=t(e[r]);return o},s=function(t){return/.*\.coffee$/.test(t)?"coffeescript":"javascript"},u=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(arg)},c=function(t){var e;return"function"===(e=typeof t)||"object"===e&&!!t},l=function(t){var e,n,r,o,i,s;for(r={},n=e=0,o=t.length;0<=o?e<o:e>o;n=0<=o?++e:--e)r[t[n]]=t[n];i=[];for(n in r)s=r[n],i.push(s);return i},p=function(t,e,n){if(void 0===e)return t;switch(null===n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)};case 4:return function(n,r,o,i){return t.call(e,n,r,o,i)}}return function(){return t.apply(e,arguments)}},d=function(t){var e;return e=function(e,n,r,o,i,s){for(var a;i>=0&&i<s;)r=n(r,e[a=o?o[i]:i],a,e),i+=t;return r},function(n,r,o,i){var s,a,u;return r=p(r,i,4),a=Object.keys(n),u=(a||n).length,s=t>0?0:u-1,arguments.length<3&&(o=n[a?a[s]:s],s+=t),e(n,r,o,a,s,u)}}(-1),r=function(t,e,n){var r,o,i,s,a,u;return a=void 0,r=void 0,o=void 0,u=void 0,s=void 0,i=function(){var c;(c=Date.now-u)<e&&c>=0?a=setTimeout(i,e-c):(a=null,n||(s=t.apply(o,r),a||(o=r=null)))},function(){var c;return o=this,r=arguments,u=Date.now,c=n&&!a,a||(a=setTimeout(i,e)),c&&(s=t.apply(o,r),o=r=null),s}},o=function(t){var e,n;if(!c(t))return[];if(Object.keys)return Object.keys(t);n=[];for(e in t)t.has(e)&&n.push(e);return n},i=function(t){var e,n,r,i;for(r=(n=o(t)).length,i=Array(r),e=0;e<r;)i[e]=t[n[e]],e++;return i},n=function(t,e,n){return u(t)||(t=i(t)),("number"!=typeof n||guard)&&(n=0),t.indexOf(e)>=0},a=function(t){var e,r,o,i,s,a,u,c,p;for(p=[],e=arguments.length,r=s=0,u=t.length;0<=u?s<=u:s>=u;r=0<=u?++s:--s)if(o=t[r],!n(p,o)){for(i=a=1,c=e;(1<=c?a<=c:a>=c)&&n(arguments[i],o);i=1<=c?++a:--a);i===e&&p.push(o)}return p},e.clone=t,e.guessLanguageFromFilename=s,e.optimizeCb=p,e.reduceRight=d,e.debounce=r,e.unique=l,e.intersection=a,e.getValues=i}).call(this)},function(t,e,n){(function(){var t,r,o,i,s,a,u,c,p,d,l=function(t,e){return function(){return t.apply(e,arguments)}},f=function(t,e){function n(){this.constructor=t}for(var r in e)h.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},h={}.hasOwnProperty,g=[].slice;r=n(2).EventEmitter,d=n(19),o=n(4),u=n(3)("noflo:component"),c=n(3)("noflo:component:brackets"),p=n(3)("noflo:component:send"),t=function(t){function e(t){this.error=l(this.error,this);var e,n,r;t||(t={}),t.inPorts||(t.inPorts={}),t.inPorts instanceof d.InPorts?this.inPorts=t.inPorts:this.inPorts=new d.InPorts(t.inPorts),t.outPorts||(t.outPorts={}),t.outPorts instanceof d.OutPorts?this.outPorts=t.outPorts:this.outPorts=new d.OutPorts(t.outPorts),t.icon&&(this.icon=t.icon),t.description&&(this.description=t.description),this.started=!1,this.load=0,this.ordered=null!=(e=t.ordered)&&e,this.autoOrdering=null!=(n=t.autoOrdering)?n:null,this.outputQ=[],this.bracketContext={in:{},out:{}},this.activateOnInput=null==(r=t.activateOnInput)||r,this.forwardBrackets={in:["out","error"]},"forwardBrackets"in t&&(this.forwardBrackets=t.forwardBrackets),"function"==typeof t.process&&this.process(t.process)}return f(e,r),e.prototype.description="",e.prototype.icon=null,e.prototype.getDescription=function(){return this.description},e.prototype.isReady=function(){return!0},e.prototype.isSubgraph=function(){return!1},e.prototype.setIcon=function(t){return this.icon=t,this.emit("icon",this.icon)},e.prototype.getIcon=function(){return this.icon},e.prototype.error=function(t,e,n,r){var o,i,s,a,u;if(null==e&&(e=[]),null==n&&(n="error"),null==r&&(r=null),!this.outPorts[n]||!this.outPorts[n].isAttached()&&this.outPorts[n].isRequired())throw t;for(i=0,a=e.length;i<a;i++)o=e[i],this.outPorts[n].openBracket(o,{scope:r});for(this.outPorts[n].data(t,{scope:r}),s=0,u=e.length;s<u;s++)o=e[s],this.outPorts[n].closeBracket(o,{scope:r})},e.prototype.setUp=function(t){return t()},e.prototype.tearDown=function(t){return t()},e.prototype.start=function(t){return this.isStarted()?t():this.setUp(function(e){return function(n){return n?t(n):(e.started=!0,e.emit("start"),t(null))}}(this))},e.prototype.shutdown=function(t){var e;return e=function(e){return function(){var n,r,o;r=e.inPorts.ports||e.inPorts;for(o in r)"function"==typeof(n=r[o]).clear&&n.clear();return e.bracketContext={in:{},out:{}},e.isStarted()?(e.started=!1,e.emit("end"),t()):t()}}(this),this.tearDown(function(n){return function(r){var o;return r?t(r):n.load>0?(o=function(t){if(!(t>0))return this.removeListener("deactivate",o),e()},void n.on("deactivate",o)):e()}}(this))},e.prototype.isStarted=function(){return this.started},e.prototype.prepareForwarding=function(){var t,e,n,r,o,i,s,a;i=this.forwardBrackets,s=[];for(e in i)if(o=i[e],e in this.inPorts.ports){for(a=[],t=0,n=o.length;t<n;t++)(r=o[t])in this.outPorts.ports&&a.push(r);0===a.length?s.push(delete this.forwardBrackets[e]):s.push(this.forwardBrackets[e]=a)}else delete this.forwardBrackets[e];return s},e.prototype.isLegacy=function(){return!this.handle&&!this._wpData},e.prototype.process=function(t){var e,n,r;if("function"!=typeof t)throw new Error("Process handler must be a function");if(!this.inPorts)throw new Error("Component ports must be defined before process function");this.prepareForwarding(),this.handle=t,r=this.inPorts.ports,e=function(t){return function(e,n){return n.name||(n.name=e),n.on("ip",function(e){return t.handleIP(e,n)})}}(this);for(n in r)e(n,r[n]);return this},e.prototype.isForwardingInport=function(t){return("string"==typeof t?t:t.name)in this.forwardBrackets},e.prototype.isForwardingOutport=function(t,e){var n,r;return n="string"==typeof t?t:t.name,r="string"==typeof e?e:e.name,!!this.forwardBrackets[n]&&-1!==this.forwardBrackets[n].indexOf(r)},e.prototype.isOrdered=function(){return!!this.ordered||!!this.autoOrdering},e.prototype.handleIP=function(t,e){var n,r,o,p,d,l,f;if(e.options.triggering){if("openBracket"!==t.type||null!==this.autoOrdering||this.ordered||(u(this.nodeId+" port '"+e.name+"' entered auto-ordering mode"),this.autoOrdering=!0),f={},this.isForwardingInport(e)){if("openBracket"===t.type)return;if("closeBracket"===t.type){if(n=e.getBuffer(t.scope,t.index),o=n.filter(function(t){return"data"===t.type}),this.outputQ.length>=this.load&&0===o.length){if(n[0]!==t)return;e.get(t.scope,t.index),(r=this.getBracketContext("in",e.name,t.scope,t.index).pop()).closeIp=t,c(this.nodeId+" closeBracket-C from '"+r.source+"' to "+r.ports+": '"+t.data+"'"),f={__resolved:!0,__bracketClosingAfter:[r]},this.outputQ.push(f),this.processOutputQueue()}if(!o.length)return}}r=new i(t,this,e,f),d=new s(this.inPorts,r),l=new a(this.outPorts,r);try{this.handle(d,l,r)}catch(t){p=t,this.deactivate(r),l.sendDone(p)}r.activated||u(e.isAddressable()?this.nodeId+" packet on '"+e.name+"["+t.index+"]' didn't match preconditions: "+t.type:this.nodeId+" packet on '"+e.name+"' didn't match preconditions: "+t.type)}},e.prototype.getBracketContext=function(t,e,n,r){var o,i,s;return s=d.normalizePortName(e),i=s.name,o=s.index,null!=r&&(o=r),("in"===t?this.inPorts:this.outPorts)[i].isAddressable()&&(e=i+"["+o+"]"),this.bracketContext[t][e]||(this.bracketContext[t][e]={}),this.bracketContext[t][e][n]||(this.bracketContext[t][e][n]=[]),this.bracketContext[t][e][n]},e.prototype.addToResult=function(t,e,n,r){var o,i,s,a,u;return null==r&&(r=!1),u=d.normalizePortName(e),a=u.name,i=u.index,s=r?"unshift":"push",this.outPorts[a].isAddressable()?(o=i?parseInt(i):n.index,t[a]||(t[a]={}),t[a][o]||(t[a][o]=[]),n.index=o,void t[a][o][s](n)):(t[a]||(t[a]=[]),t[a][s](n))},e.prototype.getForwardableContexts=function(t,e,n){var r,o,i,s;return s=d.normalizePortName(e),i=s.name,o=s.index,r=[],n.forEach(function(n){return function(s,a){var u;if(n.isForwardingOutport(t,i)&&-1===s.ports.indexOf(e)&&(!(u=n.getBracketContext("out",i,s.ip.scope,o)[a])||u.ip.data!==s.ip.data||-1===u.ports.indexOf(e)))return r.push(s)}}(this)),r},e.prototype.addBracketForwards=function(t){var e,n,r,o,i,s,a,u,p,d,l,f,h,g,m,v,y;if(null!=(f=t.__bracketClosingBefore)?f.length:void 0)for(n=0,a=(h=t.__bracketClosingBefore).length;n<a;n++)if(e=h[n],c(this.nodeId+" closeBracket-A from '"+e.source+"' to "+e.ports+": '"+e.closeIp.data+"'"),e.ports.length)for(o=0,u=(g=e.ports).length;o<u;o++)l=g[o],r=e.closeIp.clone(),this.addToResult(t,l,r,!0),this.getBracketContext("out",l,r.scope).pop();if(t.__bracketContext&&Object.keys(t.__bracketContext).reverse().forEach(function(n){return function(o){var i,s,a,u,p,d,l,f,h,g,m,v,y,b,w,P;if((e=t.__bracketContext[o]).length){w=[];for(y in t)if(d=t[y],0!==y.indexOf("__"))if(n.outPorts[y].isAddressable()){for(a in d)if(u=d[a],u.filter(function(t){return"data"===t.type}).length&&(b=y+"["+a+"]",(P=n.getForwardableContexts(o,b,e)).length)){for(s=[],l=0,h=P.length;l<h;l++)i=P[l],c(n.nodeId+" openBracket from '"+o+"' to '"+b+"': '"+i.ip.data+"'"),(r=i.ip.clone()).index=parseInt(a),s.push(r),i.ports.push(b),n.getBracketContext("out",y,i.ip.scope,a).push(i);for(s.reverse(),f=0,g=s.length;f<g;f++)p=s[f],n.addToResult(t,y,p,!0)}}else if(d.filter(function(t){return"data"===t.type}).length&&(P=n.getForwardableContexts(o,y,e)).length){for(s=[],v=0,m=P.length;v<m;v++)i=P[v],c(n.nodeId+" openBracket from '"+o+"' to '"+y+"': '"+i.ip.data+"'"),s.push(i.ip.clone()),i.ports.push(y),n.getBracketContext("out",y,i.ip.scope).push(i);s.reverse(),w.push(function(){var e,n,r;for(r=[],n=0,e=s.length;n<e;n++)p=s[n],r.push(this.addToResult(t,y,p,!0));return r}.call(n))}return w}}}(this)),null!=(m=t.__bracketClosingAfter)?m.length:void 0)for(i=0,p=(v=t.__bracketClosingAfter).length;i<p;i++)if(e=v[i],c(this.nodeId+" closeBracket-B from '"+e.source+"' to "+e.ports+": '"+e.closeIp.data+"'"),e.ports.length)for(s=0,d=(y=e.ports).length;s<d;s++)l=y[s],r=e.closeIp.clone(),this.addToResult(t,l,r,!1),this.getBracketContext("out",l,r.scope).pop();return delete t.__bracketClosingBefore,delete t.__bracketContext,delete t.__bracketClosingAfter},e.prototype.processOutputQueue=function(){var t,e,n,r,o,i,s,a;for(a=[];this.outputQ.length>0&&this.outputQ[0].__resolved;)s=this.outputQ.shift(),this.addBracketForwards(s),a.push(function(){var a,u,c;c=[];for(o in s)if(r=s[o],0!==o.indexOf("__"))if(this.outPorts.ports[o].isAddressable()){for(t in r)if(e=r[t],t=parseInt(t),this.outPorts.ports[o].isAttached(t))for(a=0,u=e.length;a<u;a++)n=e[a],i=o+"["+n.index+"]",p("openBracket"===n.type?this.nodeId+" sending "+i+" < '"+n.data+"'":"closeBracket"===n.type?this.nodeId+" sending "+i+" > '"+n.data+"'":this.nodeId+" sending "+i+" DATA"),this.outPorts[o].sendIP(n)}else this.outPorts.ports[o].isAttached()&&c.push(function(){var t,e,s;for(s=[],t=0,e=r.length;t<e;t++)n=r[t],i=o,p("openBracket"===n.type?this.nodeId+" sending "+i+" < '"+n.data+"'":"closeBracket"===n.type?this.nodeId+" sending "+i+" > '"+n.data+"'":this.nodeId+" sending "+i+" DATA"),s.push(this.outPorts[o].sendIP(n));return s}.call(this));return c}.call(this));return a},e.prototype.activate=function(t){if(!t.activated)return t.activated=!0,t.deactivated=!1,this.load++,this.emit("activate",this.load),this.ordered||this.autoOrdering?this.outputQ.push(t.result):void 0},e.prototype.deactivate=function(t){if(!t.deactivated)return t.deactivated=!0,t.activated=!1,this.isOrdered()&&this.processOutputQueue(),this.load--,this.emit("deactivate",this.load)},e}(),e.Component=t,i=function(){function t(t,e,n,r){this.ip=t,this.nodeInstance=e,this.port=n,this.result=r,this.scope=this.ip.scope,this.activated=!1,this.deactivated=!1}return t.prototype.activate=function(){return(this.result.__resolved||-1===this.nodeInstance.outputQ.indexOf(this.result))&&(this.result={}),this.nodeInstance.activate(this)},t.prototype.deactivate=function(){return this.result.__resolved||(this.result.__resolved=!0),this.nodeInstance.deactivate(this)},t}(),s=function(){function t(t,e){this.ports=t,this.context=e,this.nodeInstance=this.context.nodeInstance,this.ip=this.context.ip,this.port=this.context.port,this.result=this.context.result,this.scope=this.context.scope}return t.prototype.activate=function(){if(!this.context.activated)return this.nodeInstance.isOrdered()&&(this.result.__resolved=!1),this.nodeInstance.activate(this.context),u(this.port.isAddressable()?this.nodeInstance.nodeId+" packet on '"+this.port.name+"["+this.ip.index+"]' caused activation "+this.nodeInstance.load+": "+this.ip.type:this.nodeInstance.nodeId+" packet on '"+this.port.name+"' caused activation "+this.nodeInstance.load+": "+this.ip.type)},t.prototype.attached=function(){var t,e,n,r,o;for((t=1<=arguments.length?g.call(arguments,0):[]).length||(t=["in"]),o=[],e=0,n=t.length;e<n;e++)r=t[e],o.push(this.ports[r].listAttached());return 1===t.length?o.pop():o},t.prototype.has=function(){var t,e,n,r,o;for((t=1<=arguments.length?g.call(arguments,0):[]).length||(t=["in"]),o="function"==typeof t[t.length-1]?t.pop():function(){return!0},e=0,n=t.length;e<n;e++)if(r=t[e],Array.isArray(r)){if(!this.ports[r[0]].isAddressable())throw new Error("Non-addressable ports, access must be with string "+r[0]);if(!this.ports[r[0]].has(this.scope,r[1],o))return!1}else{if(this.ports[r].isAddressable())throw new Error("For addressable ports, access must be with array ["+r+", idx]");if(!this.ports[r].has(this.scope,o))return!1}return!0},t.prototype.hasData=function(){var t;return(t=1<=arguments.length?g.call(arguments,0):[]).length||(t=["in"]),t.push(function(t){return"data"===t.type}),this.has.apply(this,t)},t.prototype.hasStream=function(){var t,e,n,r,o,i,s,a;for((t=1<=arguments.length?g.call(arguments,0):[]).length||(t=["in"]),a="function"==typeof t[t.length-1]?t.pop():function(){return!0},n=0,r=t.length;n<r;n++)if(o=t[n],i=[],[],e=!1,s=function(t){return"openBracket"===t.type?(i.push(t.data),!1):"data"===t.type?(e=a(t,i),!i.length&&e):"closeBracket"===t.type?(i.pop(),!i.length&&!!e):void 0},!this.has(o,s))return!1;return!0},t.prototype.get=function(){var t,e,n,r,o,i,s,a;for(t=1<=arguments.length?g.call(arguments,0):[],this.activate(),t.length||(t=["in"]),a=[],e=0,o=t.length;e<o;e++){if(i=t[e],Array.isArray(i)){if(s=i[0],n=i[1],!this.ports[s].isAddressable())throw new Error("Non-addressable ports, access must be with string portname")}else if(s=i,this.ports[s].isAddressable())throw new Error("For addressable ports, access must be with array [portname, idx]");this.nodeInstance.isForwardingInport(s)?(r=this.__getForForwarding(s,n),a.push(r)):(r=this.ports[s].get(this.scope,n),a.push(r))}return 1===t.length?a[0]:a},t.prototype.__getForForwarding=function(t,e){var n,r,o,i,s,a;for(a=[],r=null;;){if(!(i=this.ports[t].get(this.scope,e)))break;if("data"===i.type){r=i;break}a.push(i)}for(o=0,s=a.length;o<s;o++)"closeBracket"!==(i=a[o]).type?"openBracket"!==i.type||this.nodeInstance.getBracketContext("in",t,this.scope,e).push({ip:i,ports:[],source:t}):(this.result.__bracketClosingBefore||(this.result.__bracketClosingBefore=[]),(n=this.nodeInstance.getBracketContext("in",t,this.scope,e).pop()).closeIp=i,this.result.__bracketClosingBefore.push(n));return this.result.__bracketContext||(this.result.__bracketContext={}),this.result.__bracketContext[t]=this.nodeInstance.getBracketContext("in",t,this.scope,e).slice(0),r},t.prototype.getData=function(){var t,e,n,r,o,i;for((t=1<=arguments.length?g.call(arguments,0):[]).length||(t=["in"]),e=[],n=0,r=t.length;n<r;n++)if(i=t[n],null!=(o=this.get(i))){for(;"data"!==o.type&&(o=this.get(i)););e.push(o.data)}else e.push(o);return 1===t.length?e.pop():e},t.prototype.getStream=function(){var t,e,n,r,o,i,s,a,u;for((t=1<=arguments.length?g.call(arguments,0):[]).length||(t=["in"]),e=[],r=0,i=t.length;r<i;r++){for(s=t[r],a=[],u=[],n=!1,(o=this.get(s))||e.push(void 0);o&&("openBracket"===o.type&&(a.length||(u=[],n=!1),a.push(o.data),u.push(o)),"data"!==o.type||(u.push(o),n=!0,a.length))&&("closeBracket"!==o.type||(u.push(o),a.pop(),!n||a.length));)o=this.get(s);e.push(u)}return 1===t.length?e.pop():e},t}(),a=function(){function t(t,e){this.ports=t,this.context=e,this.nodeInstance=this.context.nodeInstance,this.ip=this.context.ip,this.result=this.context.result,this.scope=this.context.scope}return t.prototype.isError=function(t){return t instanceof Error||Array.isArray(t)&&t.length>0&&t[0]instanceof Error},t.prototype.error=function(t){var e,n,r,i,s,a,u;if((a=Array.isArray(t))||(t=[t]),!("error"in this.ports)||!this.ports.error.isAttached()&&this.ports.error.isRequired()){for(u=[],r=0,s=t.length;r<s;r++)throw e=t[r];return u}for(a&&this.sendIP("error",new o("openBracket")),n=0,i=t.length;n<i;n++)e=t[n],this.sendIP("error",e);if(a)return this.sendIP("error",new o("closeBracket"))},t.prototype.sendIP=function(t,e){var n;if(n=o.isIP(e)?e:new o("data",e),null!==this.scope&&null===n.scope&&(n.scope=this.scope),this.nodeInstance.outPorts[t].isAddressable()&&null===n.index)throw new Error("Sending packets to addressable ports requires specifying index");if(!this.nodeInstance.isOrdered())return this.nodeInstance.outPorts[t].sendIP(n);this.nodeInstance.addToResult(this.result,t,n)},t.prototype.send=function(t){var e,n,r,o,i,s,a,u;if(this.isError(t))return this.error(t);for(e=[],o=!1,n=0,r=(a=Object.keys(this.ports.ports)).length;n<r;n++)"error"!==(s=a[n])&&"ports"!==s&&"_callbacks"!==s&&e.push(s),o||null==t||"object"!=typeof t||-1===Object.keys(t).indexOf(s)||(o=!0);if(1!==e.length||o){if(e.length>1&&!o)throw new Error("Port must be specified for sending output");u=[];for(s in t)i=t[s],u.push(this.sendIP(s,i));return u}this.sendIP(e[0],t)},t.prototype.sendDone=function(t){return this.send(t),this.done()},t.prototype.pass=function(t,e){var n,r;if(null==e&&(e={}),!("out"in this.ports))throw new Error('output.pass() requires port "out" to be present');for(n in e)r=e[n],this.ip[n]=r;return this.ip.data=t,this.sendIP("out",this.ip),this.done()},t.prototype.done=function(t){var e,n,r,o,i,s,a,c,p;if(this.result.__resolved=!0,this.nodeInstance.activate(this.context),t&&this.error(t),s=function(t){return function(){var e,n,r,o;return o=t.nodeInstance.outputQ.filter(function(t){return!t.__resolved||(2!==Object.keys(t).length||!t.__bracketClosingAfter)}),r=o.indexOf(t.result),e=o.length,n=t.nodeInstance.load,r===e-1||(-1===r&&n===e+1||e<=1&&1===n)}}(this),this.nodeInstance.isOrdered()&&s()){p=this.nodeInstance.bracketContext.in;for(c in p)if((r=p[c])[this.scope]&&(a=r[this.scope]).length)for(n=a[a.length-1],e=this.nodeInstance.inPorts[n.source].getBuffer(n.ip.scope,n.ip.index);;){if(!e.length)break;if("closeBracket"!==e[0].type)break;i=this.nodeInstance.inPorts[n.source].get(n.ip.scope,n.ip.index),(o=a.pop()).closeIp=i,this.result.__bracketClosingAfter||(this.result.__bracketClosingAfter=[]),this.result.__bracketClosingAfter.push(o)}}return u(this.nodeInstance.nodeId+" finished processing "+this.nodeInstance.load),this.nodeInstance.deactivate(this.context)},t}()}).call(this)},function(t,e,n){(function(){var t,r,o,i,s=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a={}.hasOwnProperty;t=n(2).EventEmitter,r=n(20),o=n(22),i=function(e){function n(t){var e,n;if(this.ports={},t)for(e in t)n=t[e],this.add(e,n)}return s(n,t),n.prototype.model=r,n.prototype.add=function(t,e,n){if("add"===t||"remove"===t)throw new Error("Add and remove are restricted port names");if(!t.match(/^[a-z0-9_\.\/]+$/))throw new Error("Port names can only contain lowercase alphanumeric characters and underscores. '"+t+"' not allowed");return this.ports[t]&&this.remove(t),"object"==typeof e&&e.canAttach?this.ports[t]=e:this.ports[t]=new this.model(e,n),this[t]=this.ports[t],this.emit("add",t),this},n.prototype.remove=function(t){if(!this.ports[t])throw new Error("Port "+t+" not defined");return delete this.ports[t],delete this[t],this.emit("remove",t),this},n}(),e.InPorts=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,i),e.prototype.on=function(t,e,n){if(!this.ports[t])throw new Error("Port "+t+" not available");return this.ports[t].on(e,n)},e.prototype.once=function(t,e,n){if(!this.ports[t])throw new Error("Port "+t+" not available");return this.ports[t].once(e,n)},e}(),e.OutPorts=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,i),e.prototype.model=o,e.prototype.connect=function(t,e){if(!this.ports[t])throw new Error("Port "+t+" not available");return this.ports[t].connect(e)},e.prototype.beginGroup=function(t,e,n){if(!this.ports[t])throw new Error("Port "+t+" not available");return this.ports[t].beginGroup(e,n)},e.prototype.send=function(t,e,n){if(!this.ports[t])throw new Error("Port "+t+" not available");return this.ports[t].send(e,n)},e.prototype.endGroup=function(t,e){if(!this.ports[t])throw new Error("Port "+t+" not available");return this.ports[t].endGroup(e)},e.prototype.disconnect=function(t,e){if(!this.ports[t])throw new Error("Port "+t+" not available");return this.ports[t].disconnect(e)},e}(),e.normalizePortName=function(t){var e,n;return n={name:t},-1===t.indexOf("[")?n:(null!=(e=t.match(/(.*)\[([0-9]+)\]/))?e.length:void 0)?(n.name=e[1],n.index=e[2],n):t}}).call(this)},function(t,e,n){(function(){var e,r,o,i,s=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a={}.hasOwnProperty;e=n(21),r=n(4),i=n(5),o=function(t){function n(t,e){if(this.process=null,e||"function"!=typeof t||(e=t,t={}),null==t&&(t={}),null==t.buffered&&(t.buffered=!1),null==t.control&&(t.control=!1),null==t.scoped&&(t.scoped=!0),null==t.triggering&&(t.triggering=!0),!e&&t&&t.process&&(e=t.process,delete t.process),e){if(i.deprecated("InPort process callback is deprecated. Please use Process API or the InPort handle option"),"function"!=typeof e)throw new Error("process must be a function");this.process=e}if(t.handle){if(i.deprecated("InPort handle callback is deprecated. Please use Process API"),"function"!=typeof t.handle)throw new Error("handle must be a function");this.handle=t.handle,delete t.handle}n.__super__.constructor.call(this,t),this.prepareBuffer()}return s(n,e),n.prototype.attachSocket=function(t,e){return null==e&&(e=null),this.hasDefault()&&(this.handle?t.setDataDelegate(function(t){return function(){return new r("data",t.options.default)}}(this)):t.setDataDelegate(function(t){return function(){return t.options.default}}(this))),t.on("connect",function(n){return function(){return n.handleSocketEvent("connect",t,e)}}(this)),t.on("begingroup",function(t){return function(n){return t.handleSocketEvent("begingroup",n,e)}}(this)),t.on("data",function(t){return function(n){return t.validateData(n),t.handleSocketEvent("data",n,e)}}(this)),t.on("endgroup",function(t){return function(n){return t.handleSocketEvent("endgroup",n,e)}}(this)),t.on("disconnect",function(n){return function(){return n.handleSocketEvent("disconnect",t,e)}}(this)),t.on("ip",function(t){return function(n){return t.handleIP(n,e)}}(this))},n.prototype.handleIP=function(t,e){var n;if(!(this.process||this.options.control&&"data"!==t.type))return t.owner=this.nodeInstance,this.isAddressable()&&(t.index=e),"all"===t.datatype&&(t.datatype=this.getDataType()),this.getSchema()&&!t.schema&&(t.schema=this.getSchema()),(n=this.prepareBufferForIP(t)).push(t),this.options.control&&n.length>1&&n.shift(),this.handle&&this.handle(t,this.nodeInstance),this.emit("ip",t,e)},n.prototype.handleSocketEvent=function(t,e,n){return this.isBuffered()?(this.buffer.push({event:t,payload:e,id:n}),void(this.isAddressable()?(this.process&&this.process(t,n,this.nodeInstance),this.emit(t,n)):(this.process&&this.process(t,this.nodeInstance),this.emit(t)))):(this.process&&(this.isAddressable()?this.process(t,e,n,this.nodeInstance):this.process(t,e,this.nodeInstance)),this.isAddressable()?this.emit(t,e,n):this.emit(t,e))},n.prototype.hasDefault=function(){return void 0!==this.options.default},n.prototype.prepareBuffer=function(){return this.buffer=[],this.isAddressable()&&(this.indexedBuffer={}),this.scopedBuffer={},this.iipBuffer=this.isAddressable()?{}:[]},n.prototype.prepareBufferForIP=function(t){return this.isAddressable()?null!=t.scope&&this.options.scoped?(t.scope in this.scopedBuffer||(this.scopedBuffer[t.scope]=[]),t.index in this.scopedBuffer[t.scope]||(this.scopedBuffer[t.scope][t.index]=[]),this.scopedBuffer[t.scope][t.index]):t.initial?(t.index in this.iipBuffer||(this.iipBuffer[t.index]=[]),this.iipBuffer[t.index]):(t.index in this.indexedBuffer||(this.indexedBuffer[t.index]=[]),this.indexedBuffer[t.index]):null!=t.scope&&this.options.scoped?(t.scope in this.scopedBuffer||(this.scopedBuffer[t.scope]=[]),this.scopedBuffer[t.scope]):t.initial?this.iipBuffer:this.buffer},n.prototype.validateData=function(t){if(this.options.values&&-1===this.options.values.indexOf(t))throw new Error("Invalid data='"+t+"' received, not in ["+this.options.values+"]")},n.prototype.receive=function(){if(i.deprecated("InPort.receive is deprecated. Use InPort.get instead"),!this.isBuffered())throw new Error("Receive is only possible on buffered ports");return this.buffer.shift()},n.prototype.contains=function(){if(i.deprecated("InPort.contains is deprecated. Use InPort.has instead"),!this.isBuffered())throw new Error("Contains query is only possible on buffered ports");return this.buffer.filter(function(t){if("data"===t.event)return!0}).length},n.prototype.getBuffer=function(t,e,n){if(null==n&&(n=!1),this.isAddressable()){if(null!=t&&this.options.scoped){if(!(t in this.scopedBuffer))return;if(!(e in this.scopedBuffer[t]))return;return this.scopedBuffer[t][e]}if(n){if(!(e in this.iipBuffer))return;return this.iipBuffer[e]}if(!(e in this.indexedBuffer))return;return this.indexedBuffer[e]}if(null!=t&&this.options.scoped){if(!(t in this.scopedBuffer))return;return this.scopedBuffer[t]}return n?this.iipBuffer:this.buffer},n.prototype.getFromBuffer=function(t,e,n){var r;if(null==n&&(n=!1),null!=(r=this.getBuffer(t,e,n))?r.length:void 0)return this.options.control?r[r.length-1]:r.shift()},n.prototype.get=function(t,e){var n;return void 0!==(n=this.getFromBuffer(t,e))?n:this.getFromBuffer(null,e,!0)},n.prototype.hasIPinBuffer=function(t,e,n,r){var o,i,s,a;if(null==r&&(r=!1),!(null!=(o=this.getBuffer(t,e,r))?o.length:void 0))return!1;for(i=0,s=o.length;i<s;i++)if(a=o[i],n(a))return!0;return!1},n.prototype.hasIIP=function(t,e){return this.hasIPinBuffer(null,t,e,!0)},n.prototype.has=function(t,e,n){return this.isAddressable()||(n=e,e=null),!!this.hasIPinBuffer(t,e,n)||!!this.hasIIP(e,n)},n.prototype.length=function(t,e){var n;return(n=this.getBuffer(t,e))?n.length:0},n.prototype.ready=function(t,e){return this.length(t)>0},n.prototype.clear=function(){return this.prepareBuffer()},n}(),t.exports=o}).call(this)},function(t,e,n){(function(){var e,r,o,i=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;r=n(2).EventEmitter,o=["all","string","number","int","object","array","boolean","color","date","bang","function","buffer","stream"],e=function(t){function e(t){this.handleOptions(t),this.sockets=[],this.node=null,this.name=null}return i(e,r),e.prototype.handleOptions=function(t){if(t||(t={}),t.datatype||(t.datatype="all"),void 0===t.required&&(t.required=!1),"integer"===t.datatype&&(t.datatype="int"),-1===o.indexOf(t.datatype))throw new Error("Invalid port datatype '"+t.datatype+"' specified, valid are "+o.join(", "));if(t.type&&!t.schema&&(t.schema=t.type,delete t.type),t.schema&&-1===t.schema.indexOf("/"))throw new Error("Invalid port schema '"+t.schema+"' specified. Should be URL or MIME type");return this.options=t},e.prototype.getId=function(){return this.node&&this.name?this.node+" "+this.name.toUpperCase():"Port"},e.prototype.getDataType=function(){return this.options.datatype},e.prototype.getSchema=function(){return this.options.schema||null},e.prototype.getDescription=function(){return this.options.description},e.prototype.attach=function(t,e){if(null==e&&(e=null),this.isAddressable()&&null!==e||(e=this.sockets.length),this.sockets[e]=t,this.attachSocket(t,e),!this.isAddressable())return this.emit("attach",t);this.emit("attach",t,e)},e.prototype.attachSocket=function(){},e.prototype.detach=function(t){var e;if(-1!==(e=this.sockets.indexOf(t))){if(this.sockets[e]=void 0,!this.isAddressable())return this.emit("detach",t);this.emit("detach",t,e)}},e.prototype.isAddressable=function(){return!!this.options.addressable},e.prototype.isBuffered=function(){return!!this.options.buffered},e.prototype.isRequired=function(){return!!this.options.required},e.prototype.isAttached=function(t){return null==t&&(t=null),this.isAddressable()&&null!==t?!!this.sockets[t]:!!this.sockets.length},e.prototype.listAttached=function(){var t,e,n,r,o;for(t=[],n=e=0,r=(o=this.sockets).length;e<r;n=++e)o[n]&&t.push(n);return t},e.prototype.isConnected=function(t){var e;if(null==t&&(t=null),this.isAddressable()){if(null===t)throw new Error(this.getId()+": Socket ID required");if(!this.sockets[t])throw new Error(this.getId()+": Socket "+t+" not available");return this.sockets[t].isConnected()}return e=!1,this.sockets.forEach(function(t){if(t)return t.isConnected()?e=!0:void 0}),e},e.prototype.canAttach=function(){return!0},e}(),t.exports=e}).call(this)},function(t,e,n){(function(){var e,r,o,i=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;e=n(21),r=n(4),o=function(t){function n(t){this.cache={},n.__super__.constructor.call(this,t)}return i(n,e),n.prototype.attach=function(t,e){if(null==e&&(e=null),n.__super__.attach.call(this,t,e),this.isCaching()&&null!=this.cache[e])return this.send(this.cache[e],e)},n.prototype.connect=function(t){var e,n,r,o,i;for(null==t&&(t=null),i=this.getSockets(t),this.checkRequired(i),r=[],e=0,n=i.length;e<n;e++)(o=i[e])&&r.push(o.connect());return r},n.prototype.beginGroup=function(t,e){var n;return null==e&&(e=null),n=this.getSockets(e),this.checkRequired(n),n.forEach(function(e){if(e)return e.beginGroup(t)})},n.prototype.send=function(t,e){var n;return null==e&&(e=null),n=this.getSockets(e),this.checkRequired(n),this.isCaching()&&t!==this.cache[e]&&(this.cache[e]=t),n.forEach(function(e){if(e)return e.send(t)})},n.prototype.endGroup=function(t){var e,n,r,o,i;for(null==t&&(t=null),i=this.getSockets(t),this.checkRequired(i),r=[],e=0,n=i.length;e<n;e++)(o=i[e])&&r.push(o.endGroup());return r},n.prototype.disconnect=function(t){var e,n,r,o,i;for(null==t&&(t=null),i=this.getSockets(t),this.checkRequired(i),r=[],e=0,n=i.length;e<n;e++)(o=i[e])&&r.push(o.disconnect());return r},n.prototype.sendIP=function(t,e,n,o,i){var s,a,u,c,p,d,l;for(null==i&&(i=!0),r.isIP(t)?o=(a=t).index:a=new r(t,e,n),l=this.getSockets(o),this.checkRequired(l),"all"===a.datatype&&(a.datatype=this.getDataType()),this.getSchema()&&!a.schema&&(a.schema=this.getSchema()),this.isCaching()&&e!==(null!=(p=this.cache[o])?p.data:void 0)&&(this.cache[o]=a),c=!0,s=0,u=l.length;s<u;s++)(d=l[s])&&(c?(d.post(a,i),c=!1):(a.clonable&&(a=a.clone()),d.post(a,i)));return this},n.prototype.openBracket=function(t,e,n){return null==t&&(t=null),null==e&&(e={}),null==n&&(n=null),this.sendIP("openBracket",t,e,n)},n.prototype.data=function(t,e,n){return null==e&&(e={}),null==n&&(n=null),this.sendIP("data",t,e,n)},n.prototype.closeBracket=function(t,e,n){return null==t&&(t=null),null==e&&(e={}),null==n&&(n=null),this.sendIP("closeBracket",t,e,n)},n.prototype.checkRequired=function(t){if(0===t.length&&this.isRequired())throw new Error(this.getId()+": No connections available")},n.prototype.getSockets=function(t){if(this.isAddressable()){if(null===t)throw new Error(this.getId()+" Socket ID required");return this.sockets[t]?[this.sockets[t]]:[]}return this.sockets},n.prototype.isCaching=function(){return!!this.options.caching},n}(),t.exports=o}).call(this)},function(t,e,n){!function(e){n(0);var r=n(24),o=function(t){t||(t={}),t.catchExceptions&&(e.onerror=function(t){return this.client&&this.send("network","error",t,{href:this.context?this.context.href:this.client.location.href}),console.error(t),!0}.bind(this)),t.defaultPermissions||(t.defaultPermissions=["protocol:graph","protocol:component","protocol:network","protocol:runtime","component:setsource","component:getsource"]),this.prototype.constructor.apply(this,arguments),this.receive=this.prototype.receive,this.canDo=this.prototype.canDo,this.getPermitted=this.prototype.getPermitted,this.client=null};(o.prototype=r).setClient=function(t){this.client=t},o.prototype.send=function(t,e,n,r){this.client&&(n instanceof Error&&(n={message:n.message,stack:n.stack}),this.context&&(r=this.context),this.client.postMessage(JSON.stringify({protocol:t,command:e,payload:n}),r.href),this.prototype.send.apply(this,arguments))},o.prototype.sendAll=function(t,e,n){this.send(t,e,n,window.context)},o.prototype.start=function(){},o.normalizeOptions=function(t){return void 0===t.catchExceptions&&(t.catchExceptions=!0,e.location.search&&"debug"===e.location.search.substring(1)&&(t.catchExceptions=!1)),t},o.subscribe=function(t,e){t.addEventListener("message",function(t){var n;(n="string"==typeof t.data?JSON.parse(t.data):t.data).protocol&&n.command&&e(n,t)})},t.exports=o}(window)},function(t,e,n){(function(){var e,r,o,i,s,a;a={Runtime:n(95),Graph:n(96),Network:n(97),Component:n(98)},r=n(3)("noflo-runtime-base:messaging:receive"),o=n(3)("noflo-runtime-base:messaging:receive:payload"),i=n(3)("noflo-runtime-base:messaging:send"),s=n(3)("noflo-runtime-base:messaging:send:payload"),e=function(){function t(t){var e;this.options=t,this.options||(this.options={}),this.version="0.5",this.component=new a.Component(this),this.graph=new a.Graph(this),this.network=new a.Network(this),this.runtime=new a.Runtime(this),this.context=null,null!=this.options.defaultGraph&&(this.options.defaultGraph.baseDir=this.options.baseDir,e="default/main",this.context="none",this.graph.registerGraph(e,this.options.defaultGraph),this.network.startNetwork(this.options.defaultGraph,{graph:e},this.context)),null!=this.options.captureOutput&&this.options.captureOutput&&this.startCapture(),this.options.defaultPermissions||(this.options.defaultPermissions=[]),this.options.permissions||(this.options.permissions={})}return t.prototype.canDo=function(t,e){return-1!==this.getPermitted(e).indexOf(t)},t.prototype.getPermitted=function(t){return t?this.options.permissions[t]?this.options.permissions[t]:[]:this.options.defaultPermissions},t.prototype.send=function(t,e,n,r){return i(t+" "+e),s(n)},t.prototype.sendAll=function(t,e,n,r){},t.prototype.receive=function(t,e,n,i){switch(n||(n={}),r(t+" "+e),o(n),this.context=i,t){case"runtime":return this.runtime.receive(e,n,i);case"graph":return this.graph.receive(e,n,i);case"network":return this.network.receive(e,n,i);case"component":return this.component.receive(e,n,i)}},t}(),t.exports=e,t.exports.trace=n(100),t.exports.direct=n(107)}).call(this)},function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var o=t[r];"."===o?t.splice(r,1):".."===o?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(t){return o.exec(t).slice(1)};e.resolve=function(){for(var e="",o=!1,i=arguments.length-1;i>=-1&&!o;i--){var s=i>=0?arguments[i]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(e=s+"/"+e,o="/"===s.charAt(0))}return e=n(r(e.split("/"),function(t){return!!t}),!o).join("/"),(o?"/":"")+e||"."},e.normalize=function(t){var o=e.isAbsolute(t),i="/"===s(t,-1);return(t=n(r(t.split("/"),function(t){return!!t}),!o).join("/"))||o||(t="."),t&&i&&(t+="/"),(o?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(r(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var o=r(t.split("/")),i=r(n.split("/")),s=Math.min(o.length,i.length),a=s,u=0;u<s;u++)if(o[u]!==i[u]){a=u;break}for(var c=[],u=a;u<o.length;u++)c.push("..");return(c=c.concat(i.slice(a))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){var e=i(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},e.basename=function(t,e){var n=i(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){return i(t)[3]};var s="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(e,n(1))},function(t,e,n){var r={noflo:n(0),"noflo-runtime-postmessage":n(93)};window&&(window.require=function(t){if(r[t])return r[t];throw new Error("Module "+t+" not available")})},function(t,e,n){(function(){var t,r,o,i,s,a,u=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty;t=n(2).EventEmitter,o=n(13),s=n(31),r=function(e){function r(t,e){this.name=null!=t?t:"",null==e&&(e={}),this.properties={},this.nodes=[],this.edges=[],this.initializers=[],this.exports=[],this.inports={},this.outports={},this.groups=[],this.transaction={id:null,depth:0},this.caseSensitive=e.caseSensitive||!1}return u(r,t),r.prototype.name="",r.prototype.caseSensitive=!1,r.prototype.properties={},r.prototype.nodes=[],r.prototype.edges=[],r.prototype.initializers=[],r.prototype.exports=[],r.prototype.inports={},r.prototype.outports={},r.prototype.groups=[],r.prototype.getPortName=function(t){return this.caseSensitive?t:t.toLowerCase()},r.prototype.startTransaction=function(t,e){if(this.transaction.id)throw Error("Nested transactions not supported");return this.transaction.id=t,this.transaction.depth=1,this.emit("startTransaction",t,e)},r.prototype.endTransaction=function(t,e){if(!this.transaction.id)throw Error("Attempted to end non-existing transaction");return this.transaction.id=null,this.transaction.depth=0,this.emit("endTransaction",t,e)},r.prototype.checkTransactionStart=function(){return this.transaction.id?"implicit"===this.transaction.id?this.transaction.depth+=1:void 0:this.startTransaction("implicit")},r.prototype.checkTransactionEnd=function(){if("implicit"===this.transaction.id&&(this.transaction.depth-=1),0===this.transaction.depth)return this.endTransaction("implicit")},r.prototype.setProperties=function(t){var e,n,r;this.checkTransactionStart(),e=o(this.properties);for(n in t)r=t[n],this.properties[n]=r;return this.emit("changeProperties",this.properties,e),this.checkTransactionEnd()},r.prototype.addExport=function(t,e,n,r){var o;if(null==r&&(r={x:0,y:0}),s.deprecated("fbp-graph.Graph exports is deprecated: please use specific inport or outport instead"),this.getNode(e))return this.checkTransactionStart(),o={public:this.getPortName(t),process:e,port:this.getPortName(n),metadata:r},this.exports.push(o),this.emit("addExport",o),this.checkTransactionEnd()},r.prototype.removeExport=function(t){var e,n,r,o,i,a;for(s.deprecated("fbp-graph.Graph exports is deprecated: please use specific inport or outport instead"),t=this.getPortName(t),n=null,o=r=0,i=(a=this.exports).length;r<i;o=++r)(e=a[o]).public===t&&(n=e);if(n)return this.checkTransactionStart(),this.exports.splice(this.exports.indexOf(n),1),this.emit("removeExport",n),this.checkTransactionEnd()},r.prototype.addInport=function(t,e,n,r){if(this.getNode(e))return t=this.getPortName(t),this.checkTransactionStart(),this.inports[t]={process:e,port:this.getPortName(n),metadata:r},this.emit("addInport",t,this.inports[t]),this.checkTransactionEnd()},r.prototype.removeInport=function(t){var e;if(t=this.getPortName(t),this.inports[t])return this.checkTransactionStart(),e=this.inports[t],this.setInportMetadata(t,{}),delete this.inports[t],this.emit("removeInport",t,e),this.checkTransactionEnd()},r.prototype.renameInport=function(t,e){if(t=this.getPortName(t),e=this.getPortName(e),this.inports[t])return this.checkTransactionStart(),this.inports[e]=this.inports[t],delete this.inports[t],this.emit("renameInport",t,e),this.checkTransactionEnd()},r.prototype.setInportMetadata=function(t,e){var n,r,i;if(t=this.getPortName(t),this.inports[t]){this.checkTransactionStart(),n=o(this.inports[t].metadata),this.inports[t].metadata||(this.inports[t].metadata={});for(r in e)null!=(i=e[r])?this.inports[t].metadata[r]=i:delete this.inports[t].metadata[r];return this.emit("changeInport",t,this.inports[t],n),this.checkTransactionEnd()}},r.prototype.addOutport=function(t,e,n,r){if(this.getNode(e))return t=this.getPortName(t),this.checkTransactionStart(),this.outports[t]={process:e,port:this.getPortName(n),metadata:r},this.emit("addOutport",t,this.outports[t]),this.checkTransactionEnd()},r.prototype.removeOutport=function(t){var e;if(t=this.getPortName(t),this.outports[t])return this.checkTransactionStart(),e=this.outports[t],this.setOutportMetadata(t,{}),delete this.outports[t],this.emit("removeOutport",t,e),this.checkTransactionEnd()},r.prototype.renameOutport=function(t,e){if(t=this.getPortName(t),e=this.getPortName(e),this.outports[t])return this.checkTransactionStart(),this.outports[e]=this.outports[t],delete this.outports[t],this.emit("renameOutport",t,e),this.checkTransactionEnd()},r.prototype.setOutportMetadata=function(t,e){var n,r,i;if(t=this.getPortName(t),this.outports[t]){this.checkTransactionStart(),n=o(this.outports[t].metadata),this.outports[t].metadata||(this.outports[t].metadata={});for(r in e)null!=(i=e[r])?this.outports[t].metadata[r]=i:delete this.outports[t].metadata[r];return this.emit("changeOutport",t,this.outports[t],n),this.checkTransactionEnd()}},r.prototype.addGroup=function(t,e,n){var r;return this.checkTransactionStart(),r={name:t,nodes:e,metadata:n},this.groups.push(r),this.emit("addGroup",r),this.checkTransactionEnd()},r.prototype.renameGroup=function(t,e){var n,r,o,i;for(this.checkTransactionStart(),r=0,o=(i=this.groups).length;r<o;r++)(n=i[r])&&n.name===t&&(n.name=e,this.emit("renameGroup",t,e));return this.checkTransactionEnd()},r.prototype.removeGroup=function(t){var e,n,r,o;for(this.checkTransactionStart(),n=0,r=(o=this.groups).length;n<r;n++)(e=o[n])&&e.name===t&&(this.setGroupMetadata(e.name,{}),this.groups.splice(this.groups.indexOf(e),1),this.emit("removeGroup",e));return this.checkTransactionEnd()},r.prototype.setGroupMetadata=function(t,e){var n,r,i,s,a,u,c;for(this.checkTransactionStart(),i=0,a=(u=this.groups).length;i<a;i++)if((r=u[i])&&r.name===t){n=o(r.metadata);for(s in e)null!=(c=e[s])?r.metadata[s]=c:delete r.metadata[s];this.emit("changeGroup",r,n)}return this.checkTransactionEnd()},r.prototype.addNode=function(t,e,n){var r;return this.checkTransactionStart(),n||(n={}),r={id:t,component:e,metadata:n},this.nodes.push(r),this.emit("addNode",r),this.checkTransactionEnd(),r},r.prototype.removeNode=function(t){var e,n,r,o,i,s,a,u,c,p,d,l,f,h,g,m,v,y,b,w,P,k,E,_,C,D,x,S,O,I,A,N;if(P=this.getNode(t)){for(this.checkTransactionStart(),N=[],o=0,p=(D=this.edges).length;o<p;o++)(e=D[o]).from.node!==P.id&&e.to.node!==P.id||N.push(e);for(a=0,d=N.length;a<d;a++)e=N[a],this.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port);for(N=[],u=0,l=(x=this.initializers).length;u<l;u++)(s=x[u]).to.node===P.id&&N.push(s);for(c=0,f=N.length;c<f;c++)s=N[c],this.removeInitial(s.to.node,s.to.port);for(N=[],b=0,h=(S=this.exports).length;b<h;b++)n=S[b],this.getPortName(t)===n.process&&N.push(n);for(w=0,g=N.length;w<g;w++)n=N[w],this.removeExport(n.public);N=[],O=this.inports;for(_ in O)O[_].process===t&&N.push(_);for(k=0,m=N.length;k<m;k++)_=N[k],this.removeInport(_);N=[],I=this.outports;for(_ in I)I[_].process===t&&N.push(_);for(E=0,v=N.length;E<v;E++)_=N[E],this.removeOutport(_);for(C=0,y=(A=this.groups).length;C<y;C++)(r=A[C])&&-1!==(i=r.nodes.indexOf(t))&&r.nodes.splice(i,1);return this.setNodeMetadata(t,{}),-1!==this.nodes.indexOf(P)&&this.nodes.splice(this.nodes.indexOf(P),1),this.emit("removeNode",P),this.checkTransactionEnd()}},r.prototype.getNode=function(t){var e,n,r,o;for(e=0,n=(o=this.nodes).length;e<n;e++)if((r=o[e])&&r.id===t)return r;return null},r.prototype.renameNode=function(t,e){var n,r,o,i,s,a,u,c,p,d,l,f,h,g,m,v,y,b,w,P,k,E;if(this.checkTransactionStart(),g=this.getNode(t)){for(g.id=e,i=0,d=(y=this.edges).length;i<d;i++)(n=y[i])&&(n.from.node===t&&(n.from.node=e),n.to.node===t&&(n.to.node=e));for(u=0,l=(b=this.initializers).length;u<l;u++)(s=b[u])&&s.to.node===t&&(s.to.node=e);w=this.inports;for(v in w)(m=w[v]).process===t&&(m.process=e);P=this.outports;for(v in P)(m=P[v]).process===t&&(m.process=e);for(c=0,f=(k=this.exports).length;c<f;c++)(r=k[c]).process===t&&(r.process=e);for(p=0,h=(E=this.groups).length;p<h;p++)(o=E[p])&&-1!==(a=o.nodes.indexOf(t))&&(o.nodes[a]=e);return this.emit("renameNode",t,e),this.checkTransactionEnd()}},r.prototype.setNodeMetadata=function(t,e){var n,r,i,s;if(i=this.getNode(t)){this.checkTransactionStart(),n=o(i.metadata),i.metadata||(i.metadata={});for(r in e)null!=(s=e[r])?i.metadata[r]=s:delete i.metadata[r];return this.emit("changeNode",i,n),this.checkTransactionEnd()}},r.prototype.addEdge=function(t,e,n,r,o){var i,s,a,u;for(null==o&&(o={}),e=this.getPortName(e),r=this.getPortName(r),s=0,a=(u=this.edges).length;s<a;s++)if((i=u[s]).from.node===t&&i.from.port===e&&i.to.node===n&&i.to.port===r)return;if(this.getNode(t)&&this.getNode(n))return this.checkTransactionStart(),i={from:{node:t,port:e},to:{node:n,port:r},metadata:o},this.edges.push(i),this.emit("addEdge",i),this.checkTransactionEnd(),i},r.prototype.addEdgeIndex=function(t,e,n,r,o,i,s){var a;if(null==s&&(s={}),this.getNode(t)&&this.getNode(r))return e=this.getPortName(e),o=this.getPortName(o),null===i&&(i=void 0),null===n&&(n=void 0),s||(s={}),this.checkTransactionStart(),a={from:{node:t,port:e,index:n},to:{node:r,port:o,index:i},metadata:s},this.edges.push(a),this.emit("addEdge",a),this.checkTransactionEnd(),a},r.prototype.removeEdge=function(t,e,n,r){var o,i,s,a,u,c,p,d,l,f,h,g;if(this.checkTransactionStart(),e=this.getPortName(e),r=this.getPortName(r),g=[],h=[],n&&r)for(s=i=0,c=(l=this.edges).length;i<c;s=++i)(o=l[s]).from.node===t&&o.from.port===e&&o.to.node===n&&o.to.port===r?(this.setEdgeMetadata(o.from.node,o.from.port,o.to.node,o.to.port,{}),g.push(o)):h.push(o);else for(s=a=0,p=(f=this.edges).length;a<p;s=++a)(o=f[s]).from.node===t&&o.from.port===e||o.to.node===t&&o.to.port===e?(this.setEdgeMetadata(o.from.node,o.from.port,o.to.node,o.to.port,{}),g.push(o)):h.push(o);for(this.edges=h,u=0,d=g.length;u<d;u++)o=g[u],this.emit("removeEdge",o);return this.checkTransactionEnd()},r.prototype.getEdge=function(t,e,n,r){var o,i,s,a,u;for(e=this.getPortName(e),r=this.getPortName(r),s=i=0,a=(u=this.edges).length;i<a;s=++i)if((o=u[s])&&o.from.node===t&&o.from.port===e&&o.to.node===n&&o.to.port===r)return o;return null},r.prototype.setEdgeMetadata=function(t,e,n,r,i){var s,a,u,c;if(a=this.getEdge(t,e,n,r)){this.checkTransactionStart(),s=o(a.metadata),a.metadata||(a.metadata={});for(u in i)null!=(c=i[u])?a.metadata[u]=c:delete a.metadata[u];return this.emit("changeEdge",a,s),this.checkTransactionEnd()}},r.prototype.addInitial=function(t,e,n,r){var o;if(this.getNode(e))return n=this.getPortName(n),this.checkTransactionStart(),o={from:{data:t},to:{node:e,port:n},metadata:r},this.initializers.push(o),this.emit("addInitial",o),this.checkTransactionEnd(),o},r.prototype.addInitialIndex=function(t,e,n,r,o){var i;if(this.getNode(e))return null===r&&(r=void 0),n=this.getPortName(n),this.checkTransactionStart(),i={from:{data:t},to:{node:e,port:n,index:r},metadata:o},this.initializers.push(i),this.emit("addInitial",i),this.checkTransactionEnd(),i},r.prototype.addGraphInitial=function(t,e,n){var r;if(r=this.inports[e])return this.addInitial(t,r.process,r.port,n)},r.prototype.addGraphInitialIndex=function(t,e,n,r){var o;if(o=this.inports[e])return this.addInitialIndex(t,o.process,o.port,n,r)},r.prototype.removeInitial=function(t,e){var n,r,o,i,s,a,u,c,p;for(e=this.getPortName(e),this.checkTransactionStart(),p=[],c=[],o=r=0,s=(u=this.initializers).length;r<s;o=++r)(n=u[o]).to.node===t&&n.to.port===e?p.push(n):c.push(n);for(this.initializers=c,i=0,a=p.length;i<a;i++)n=p[i],this.emit("removeInitial",n);return this.checkTransactionEnd()},r.prototype.removeGraphInitial=function(t){var e;if(e=this.inports[t])return this.removeInitial(e.process,e.port)},r.prototype.toDOT=function(){var t,e,n,r,o,i,s,a,u,c,p,d,l,f,h,g;for(t=function(t){return t.replace(/\s*/g,"")},e=function(t){return t.replace(/\./g,"")},n="digraph {\n",o=0,c=(f=this.nodes).length;o<c;o++)n+="    "+t((l=f[o]).id)+" [label="+l.id+" shape=box]\n";for(i=a=0,p=(h=this.initializers).length;a<p;i=++a)n+="    data"+i+" [label=\"'"+("function"==typeof(s=h[i]).from.data?"Function":s.from.data)+"'\" shape=plaintext]\n",n+="    data"+i+" -> "+t(s.to.node)+"[headlabel="+e(s.to.port)+" labelfontcolor=blue labelfontsize=8.0]\n";for(u=0,d=(g=this.edges).length;u<d;u++)n+="    "+t((r=g[u]).from.node)+" -> "+t(r.to.node)+"[taillabel="+e(r.from.port)+" headlabel="+e(r.to.port)+" labelfontcolor=blue labelfontsize=8.0]\n";return n+="}"},r.prototype.toYUML=function(){var t,e,n,r,o,i,s,a,u;for(u=[],e=0,o=(s=this.initializers).length;e<o;e++)n=s[e],u.push("(start)["+n.to.port+"]->("+n.to.node+")");for(r=0,i=(a=this.edges).length;r<i;r++)t=a[r],u.push("("+t.from.node+")["+t.from.port+"]->("+t.to.node+")");return u.join(",")},r.prototype.toJSON=function(){var t,e,n,r,o,i,s,a,u,c,p,d,l,f,h,g,m,v,y,b,w,P,k,E,_,C,D,x,S,O;u={caseSensitive:this.caseSensitive,properties:{},inports:{},outports:{},groups:[],processes:{},connections:[]},this.name&&(u.properties.name=this.name),P=this.properties;for(b in P)O=P[b],u.properties[b]=O;k=this.inports;for(w in k)y=k[w],u.inports[w]=y;E=this.outports;for(w in E)y=E[w],u.outports[w]=y;for(i=0,d=(_=this.exports).length;i<d;i++)n=_[i],u.exports||(u.exports=[]),u.exports.push(n);for(a=0,l=(C=this.groups).length;a<l;a++)o={name:(r=C[a]).name,nodes:r.nodes},Object.keys(r.metadata).length&&(o.metadata=r.metadata),u.groups.push(o);for(c=0,f=(D=this.nodes).length;c<f;c++)v=D[c],u.processes[v.id]={component:v.component},v.metadata&&(u.processes[v.id].metadata=v.metadata);for(p=0,h=(x=this.edges).length;p<h;p++)t={src:{process:(e=x[p]).from.node,port:e.from.port,index:e.from.index},tgt:{process:e.to.node,port:e.to.port,index:e.to.index}},Object.keys(e.metadata).length&&(t.metadata=e.metadata),u.connections.push(t);for(m=0,g=(S=this.initializers).length;m<g;m++)s=S[m],u.connections.push({data:s.from.data,tgt:{process:s.to.node,port:s.to.port,index:s.to.index}});return u},r.prototype.save=function(t,e){var r;return s.isBrowser()?e(new Error("Saving graphs not supported on browser")):(r=JSON.stringify(this.toJSON(),null,4),n(6).writeFile(t+".json",r,"utf-8",function(n,r){if(n)throw n;return e(t)}))},r}(),e.Graph=r,e.createGraph=function(t,e){return new r(t,e)},e.loadJSON=function(t,e,n){var o,i,s,a,u,c,p,d,l,f,h,g,m,v,y,b,w,P,k,E,_,C,D,x,S,O,I,A;null==n&&(n={}),"string"==typeof t&&(t=JSON.parse(t)),t.properties||(t.properties={}),t.processes||(t.processes={}),t.connections||(t.connections=[]),o=t.caseSensitive||!1,(u=new r(t.properties.name,{caseSensitive:o})).startTransaction("loadJSON",n),w={},E=t.properties;for(P in E)A=E[P],"name"!==P&&(w[P]=A);u.setProperties(w),_=t.processes;for(d in _)(s=_[d]).metadata||(s.metadata={}),u.addNode(d,s.component,s.metadata);for(p=0,h=(C=t.connections).length;p<h;p++)n=(i=C[p]).metadata?i.metadata:{},void 0===i.data?"number"!=typeof i.src.index&&"number"!=typeof i.tgt.index?u.addEdge(i.src.process,u.getPortName(i.src.port),i.tgt.process,u.getPortName(i.tgt.port),n):u.addEdgeIndex(i.src.process,u.getPortName(i.src.port),i.src.index,i.tgt.process,u.getPortName(i.tgt.port),i.tgt.index,n):"number"==typeof i.tgt.index?u.addInitialIndex(i.data,i.tgt.process,u.getPortName(i.tgt.port),i.tgt.index,n):u.addInitial(i.data,i.tgt.process,u.getPortName(i.tgt.port),n);if(t.exports&&t.exports.length)for(l=0,g=(D=t.exports).length;l<g;l++){if((a=D[l]).private){if(2!==(I=a.private.split(".")).length)continue;b=I[0],v=I[1];for(d in t.processes)u.getPortName(d)===u.getPortName(b)&&(b=d)}else b=a.process,v=u.getPortName(a.port);u.addExport(a.public,b,v,a.metadata)}if(t.inports){x=t.inports;for(k in x)y=x[k],u.addInport(k,y.process,u.getPortName(y.port),y.metadata)}if(t.outports){S=t.outports;for(k in S)y=S[k],u.addOutport(k,y.process,u.getPortName(y.port),y.metadata)}if(t.groups)for(f=0,m=(O=t.groups).length;f<m;f++)c=O[f],u.addGroup(c.name,c.nodes,c.metadata||{});return u.endTransaction("loadJSON"),e(null,u)},e.loadFBP=function(t,r,o,i){var s,a;null==o&&(o={}),null==i&&(i=!1);try{s=n(32).parse(t,{caseSensitive:i})}catch(t){return a=t,r(a)}return e.loadJSON(s,r,o)},e.loadHTTP=function(t,e){var n;return n=new XMLHttpRequest,n.onreadystatechange=function(){if(4===n.readyState)return 200!==n.status?e(new Error("Failed to load "+t+": HTTP "+n.status)):e(null,n.responseText)},n.open("GET",t,!0),n.send()},e.loadFile=function(t,r,o,i){if(null==o&&(o={}),null==i&&(i=!1),!s.isBrowser())return n(6).readFile(t,"utf-8",function(n,o){var s;return n?r(n):"fbp"===t.split(".").pop()?e.loadFBP(o,r,{},i):(s=JSON.parse(o),e.loadJSON(s,r,{}))});e.loadHTTP(t,function(n,i){var s;return n?r(n):"fbp"===t.split(".").pop()?e.loadFBP(i,r,o):(s=JSON.parse(i),e.loadJSON(s,r,o))})},a=function(t){var e,n,r,i,s,a,u,c,p,d,l,f,h,g,m,v,y,b,w,P,k,E,_,C;for(i=0,p=(y=o(t.groups).reverse()).length;i<p;i++)null!=(r=y[i])&&t.removeGroup(r.name);b=o(t.outports);for(v in b)b[v],t.removeOutport(v);w=o(t.inports);for(v in w)w[v],t.removeInport(v);for(a=0,d=(P=o(t.exports.reverse())).length;a<d;a++)n=P[a],t.removeExport(n.public);for(t.setProperties({}),u=0,l=(k=o(t.initializers).reverse()).length;u<l;u++)s=k[u],t.removeInitial(s.to.node,s.to.port);for(c=0,f=(E=o(t.edges).reverse()).length;c<f;c++)e=E[c],t.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port);for(C=[],g=0,h=(_=o(t.nodes).reverse()).length;g<h;g++)m=_[g],C.push(t.removeNode(m.id));return C},i=function(t,e){var n,r,o,i,s,u,c,p,d,l,f,h,g,m,v,y,b,w,P,k,E,_,C,D,x;for(a(t),i=0,d=(w=e.nodes).length;i<d;i++)v=w[i],t.addNode(v.id,v.component,v.metadata);for(u=0,l=(P=e.edges).length;u<l;u++)n=P[u],t.addEdge(n.from.node,n.from.port,n.to.node,n.to.port,n.metadata);for(c=0,f=(k=e.initializers).length;c<f;c++)s=k[c],t.addInitial(s.from.data,s.to.node,s.to.port,s.metadata);for(p=0,h=(E=e.exports).length;p<h;p++)r=E[p],t.addExport(r.public,r.node,r.port,r.metadata);t.setProperties(e.properties),_=e.inports;for(b in _)y=_[b],t.addInport(b,y.process,y.port,y.metadata);C=e.outports;for(b in C)y=C[b],t.addOutport(b,y.process,y.port,y.metadata);for(x=[],m=0,g=(D=e.groups).length;m<g;m++)o=D[m],x.push(t.addGroup(o.name,o.nodes,o.metadata));return x},e.equivalent=function(t,e,n){var r,o;return null==n&&(n={}),r=JSON.stringify(t),o=JSON.stringify(e),r===o},e.mergeResolveTheirs=i}).call(this)},function(t,e,n){"use strict";function r(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function o(t){return s[t>>18&63]+s[t>>12&63]+s[t>>6&63]+s[63&t]}function i(t,e,n){for(var r,i=[],s=e;s<n;s+=3)r=(t[s]<<16)+(t[s+1]<<8)+t[s+2],i.push(o(r));return i.join("")}e.byteLength=function(t){return 3*t.length/4-r(t)},e.toByteArray=function(t){var e,n,o,i,s,c=t.length;i=r(t),s=new u(3*c/4-i),n=i>0?c-4:c;var p=0;for(e=0;e<n;e+=4)o=a[t.charCodeAt(e)]<<18|a[t.charCodeAt(e+1)]<<12|a[t.charCodeAt(e+2)]<<6|a[t.charCodeAt(e+3)],s[p++]=o>>16&255,s[p++]=o>>8&255,s[p++]=255&o;return 2===i?(o=a[t.charCodeAt(e)]<<2|a[t.charCodeAt(e+1)]>>4,s[p++]=255&o):1===i&&(o=a[t.charCodeAt(e)]<<10|a[t.charCodeAt(e+1)]<<4|a[t.charCodeAt(e+2)]>>2,s[p++]=o>>8&255,s[p++]=255&o),s},e.fromByteArray=function(t){for(var e,n=t.length,r=n%3,o="",a=[],u=0,c=n-r;u<c;u+=16383)a.push(i(t,u,u+16383>c?c:u+16383));return 1===r?(e=t[n-1],o+=s[e>>2],o+=s[e<<4&63],o+="=="):2===r&&(e=(t[n-2]<<8)+t[n-1],o+=s[e>>10],o+=s[e>>4&63],o+=s[e<<2&63],o+="="),a.push(o),a.join("")};for(var s=[],a=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,d=c.length;p<d;++p)s[p]=c[p],a[c.charCodeAt(p)]=p;a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,o){var i,s,a=8*o-r-1,u=(1<<a)-1,c=u>>1,p=-7,d=n?o-1:0,l=n?-1:1,f=t[e+d];for(d+=l,i=f&(1<<-p)-1,f>>=-p,p+=a;p>0;i=256*i+t[e+d],d+=l,p-=8);for(s=i&(1<<-p)-1,i>>=-p,p+=r;p>0;s=256*s+t[e+d],d+=l,p-=8);if(0===i)i=1-c;else{if(i===u)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),i-=c}return(f?-1:1)*s*Math.pow(2,i-r)},e.write=function(t,e,n,r,o,i){var s,a,u,c=8*i-o-1,p=(1<<c)-1,d=p>>1,l=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:i-1,h=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=p):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+d>=1?l/u:l*Math.pow(2,1-d))*u>=2&&(s++,u/=2),s+d>=p?(a=0,s=p):s+d>=1?(a=(e*u-1)*Math.pow(2,o),s+=d):(a=e*Math.pow(2,d-1)*Math.pow(2,o),s=0));o>=8;t[n+f]=255&a,f+=h,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;t[n+f]=255&s,f+=h,s/=256,c-=8);t[n+f-h]|=128*g}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){(function(t){(function(){e.isBrowser=function(){return void 0===t||!t.execPath||!t.execPath.match(/node|iojs/)},e.deprecated=function(n){if(!e.isBrowser()){if(t.env.NOFLO_FATAL_DEPRECATED)throw new Error(n);return console.warn(n)}if(window.NOFLO_FATAL_DEPRECATED)throw new Error(n);console.warn(n)}}).call(this)}).call(e,n(1))},function(t,e,n){t.exports=function(){"use strict";function t(e,n,r,o){this.message=e,this.expected=n,this.found=r,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(t,Error),{SyntaxError:t,parse:function(e){function r(){return e.substring(cr,ur)}function o(){return s(cr,ur)}function i(t){var n,r,o=pr[t];if(o)return o;for(n=t-1;!pr[n];)n--;for(o={line:(o=pr[n]).line,column:o.column,seenCR:o.seenCR};n<t;)"\n"===(r=e.charAt(n))?(o.seenCR||o.line++,o.column=1,o.seenCR=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(o.line++,o.column=1,o.seenCR=!0):(o.column++,o.seenCR=!1),n++;return pr[t]=o,o}function s(t,e){var n=i(t),r=i(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function a(t){ur<dr||(ur>dr&&(dr=ur,lr=[]),lr.push(t))}function u(e,n,r,o){return null!==n&&function(t){var e=1;for(t.sort(function(t,e){return t.description<e.description?-1:t.description>e.description?1:0});e<t.length;)t[e-1]===t[e]?t.splice(e,1):e++}(n),new t(null!==e?e:function(t,e){var n,r,o,i=new Array(t.length);for(o=0;o<t.length;o++)i[o]=t[o].description;return n=t.length>1?i.slice(0,-1).join(", ")+" or "+i[t.length-1]:i[0],r=e?'"'+function(t){function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(t){return"\\x"+n(t)}).replace(/[\u0100-\u0FFF]/g,function(t){return"\\u0"+n(t)}).replace(/[\u1000-\uFFFF]/g,function(t){return"\\u"+n(t)})}()+'"':"end of input","Expected "+n+" but "+r+" found."}(n,r),n,r,o)}function c(){var t,e,n;for(t=ur,e=[],n=p();n!==Pt;)e.push(n),n=p();return e!==Pt&&(cr=t,e=_t()),t=e}function p(){var t,n,r,o,i,s,u,c,p;return t=ur,(n=R())!==Pt?(e.substr(ur,7)===Ct?(r=Ct,ur+=7):(r=Pt,0===fr&&a(Dt)),r!==Pt&&(o=I())!==Pt?(58===e.charCodeAt(ur)?(i=xt,ur++):(i=Pt,0===fr&&a(St)),i!==Pt&&(s=I())!==Pt&&(u=R())!==Pt?((c=d())===Pt&&(c=null),c!==Pt?(cr=t,t=n=Ot(o,s)):(ur=t,t=Pt)):(ur=t,t=Pt)):(ur=t,t=Pt)):(ur=t,t=Pt),t===Pt&&(t=ur,(n=R())!==Pt?(e.substr(ur,7)===It?(r=It,ur+=7):(r=Pt,0===fr&&a(At)),r!==Pt&&(o=w())!==Pt?(46===e.charCodeAt(ur)?(i=Nt,ur++):(i=Pt,0===fr&&a(Tt)),i!==Pt&&(s=I())!==Pt?(58===e.charCodeAt(ur)?(u=xt,ur++):(u=Pt,0===fr&&a(St)),u!==Pt&&(c=I())!==Pt&&R()!==Pt?((p=d())===Pt&&(p=null),p!==Pt?(cr=t,t=n=Rt(o,s,c)):(ur=t,t=Pt)):(ur=t,t=Pt)):(ur=t,t=Pt)):(ur=t,t=Pt)):(ur=t,t=Pt),t===Pt&&(t=ur,(n=R())!==Pt?(e.substr(ur,8)===Lt?(r=Lt,ur+=8):(r=Pt,0===fr&&a(Bt)),r!==Pt&&(o=w())!==Pt?(46===e.charCodeAt(ur)?(i=Nt,ur++):(i=Pt,0===fr&&a(Tt)),i!==Pt&&(s=I())!==Pt?(58===e.charCodeAt(ur)?(u=xt,ur++):(u=Pt,0===fr&&a(St)),u!==Pt&&(c=I())!==Pt&&R()!==Pt?((p=d())===Pt&&(p=null),p!==Pt?(cr=t,t=n=Gt(o,s,c)):(ur=t,t=Pt)):(ur=t,t=Pt)):(ur=t,t=Pt)):(ur=t,t=Pt)):(ur=t,t=Pt),t===Pt&&(t=ur,(n=R())!==Pt?(e.substr(ur,15)===jt?(r=jt,ur+=15):(r=Pt,0===fr&&a(Ft)),r!==Pt&&(o=I())!==Pt&&(i=R())!==Pt?((s=d())===Pt&&(s=null),s!==Pt?(cr=t,t=n=Mt(o)):(ur=t,t=Pt)):(ur=t,t=Pt)):(ur=t,t=Pt),t===Pt&&(t=ur,(n=R())!==Pt?(e.substr(ur,16)===qt?(r=qt,ur+=16):(r=Pt,0===fr&&a(Ut)),r!==Pt&&(o=I())!==Pt&&(i=R())!==Pt?((s=d())===Pt&&(s=null),s!==Pt?(cr=t,t=n=zt(o)):(ur=t,t=Pt)):(ur=t,t=Pt)):(ur=t,t=Pt),t===Pt&&(t=ur,(n=l())!==Pt?(Ht.test(e.charAt(ur))?(r=e.charAt(ur),ur++):(r=Pt,0===fr&&a(Yt)),r===Pt&&(r=null),r!==Pt?t=n=[n,r]:(ur=t,t=Pt)):(ur=t,t=Pt),t===Pt&&(t=ur,(n=R())!==Pt?(Ht.test(e.charAt(ur))?(r=e.charAt(ur),ur++):(r=Pt,0===fr&&a(Yt)),r!==Pt?t=n=[n,r]:(ur=t,t=Pt)):(ur=t,t=Pt),t===Pt&&(t=ur,(n=R())!==Pt&&(r=f())!==Pt&&(o=R())!==Pt?((i=d())===Pt&&(i=null),i!==Pt?(cr=t,t=n=Wt(r)):(ur=t,t=Pt)):(ur=t,t=Pt)))))))),t}function d(){var t,n,r,o,i;return t=ur,(n=R())!==Pt?(44===e.charCodeAt(ur)?(r=Jt,ur++):(r=Pt,0===fr&&a(Kt)),r===Pt&&(r=null),r!==Pt?((o=l())===Pt&&(o=null),o!==Pt?(Ht.test(e.charAt(ur))?(i=e.charAt(ur),ur++):(i=Pt,0===fr&&a(Yt)),i===Pt&&(i=null),i!==Pt?t=n=[n,r,o,i]:(ur=t,t=Pt)):(ur=t,t=Pt)):(ur=t,t=Pt)):(ur=t,t=Pt),t}function l(){var t,n,r,o,i;if(t=ur,(n=R())!==Pt)if(35===e.charCodeAt(ur)?(r=Xt,ur++):(r=Pt,0===fr&&a(Vt)),r!==Pt){for(o=[],i=N();i!==Pt;)o.push(i),i=N();o!==Pt?t=n=[n,r,o]:(ur=t,t=Pt)}else ur=t,t=Pt;else ur=t,t=Pt;return t}function f(){var t,n,r,o;return t=ur,(n=h())!==Pt&&R()!==Pt?(e.substr(ur,2)===Qt?(r=Qt,ur+=2):(r=Pt,0===fr&&a(Zt)),r!==Pt&&R()!==Pt&&(o=f())!==Pt?(cr=t,t=n=$t(n,o)):(ur=t,t=Pt)):(ur=t,t=Pt),t===Pt&&(t=g()),t}function h(){var t;return(t=m())===Pt&&(t=v())===Pt&&(t=b()),t}function g(){var t;return(t=y())===Pt&&(t=m()),t}function m(){var t,e,n,r;return t=ur,(e=S())!==Pt&&(n=w())!==Pt&&(r=O())!==Pt?(cr=t,t=e=te(e,n,r)):(ur=t,t=Pt),t===Pt&&(t=ur,(e=S())===Pt&&(e=null),e!==Pt&&(n=_())!==Pt?((r=O())===Pt&&(r=null),r!==Pt?(cr=t,t=e=te(e,n,r)):(ur=t,t=Pt)):(ur=t,t=Pt)),t}function v(){var t,e,n;return t=ur,(e=w())!==Pt?((n=O())===Pt&&(n=null),n!==Pt?(cr=t,t=e=ee(e,n)):(ur=t,t=Pt)):(ur=t,t=Pt),t}function y(){var t,e,n;return t=ur,(e=S())===Pt&&(e=null),e!==Pt&&(n=w())!==Pt?(cr=t,t=e=ne(e,n)):(ur=t,t=Pt),t}function b(){var t,n,r,o;if(t=ur,39===e.charCodeAt(ur)?(n=re,ur++):(n=Pt,0===fr&&a(oe)),n!==Pt){for(r=[],o=T();o!==Pt;)r.push(o),o=T();r!==Pt?(39===e.charCodeAt(ur)?(o=re,ur++):(o=Pt,0===fr&&a(oe)),o!==Pt?(cr=t,t=n=ie(r)):(ur=t,t=Pt)):(ur=t,t=Pt)}else ur=t,t=Pt;return t===Pt&&(t=ur,(n=B())!==Pt&&(cr=t,n=se(n)),t=n),t}function w(){var t,e;return t=ur,(e=k())!==Pt&&(cr=t,e=ae(e)),(t=e)===Pt&&(t=ur,(e=P())!==Pt&&(cr=t,e=ae(e)),(t=e)===Pt&&(t=ur,(e=E())!==Pt&&(cr=t,e=ae(e)),t=e)),t}function P(){var t,n,r,o,i;if(t=ur,n=ur,ue.test(e.charAt(ur))?(r=e.charAt(ur),ur++):(r=Pt,0===fr&&a(ce)),r!==Pt){for(o=[],pe.test(e.charAt(ur))?(i=e.charAt(ur),ur++):(i=Pt,0===fr&&a(de));i!==Pt;)o.push(i),pe.test(e.charAt(ur))?(i=e.charAt(ur),ur++):(i=Pt,0===fr&&a(de));o!==Pt?n=r=[r,o]:(ur=n,n=Pt)}else ur=n,n=Pt;return n!==Pt&&(cr=t,n=le(n)),t=n}function k(){var t,e,n;return t=ur,(e=P())!==Pt&&(n=C())!==Pt?(cr=t,t=e=fe(e,n)):(ur=t,t=Pt),t}function E(){var t,e;return t=ur,(e=C())!==Pt&&(cr=t,e=he(e)),t=e}function _(){var t;return(t=k())===Pt&&(t=E()),t}function C(){var t,n,r,o,i;if(t=ur,40===e.charCodeAt(ur)?(n=ge,ur++):(n=Pt,0===fr&&a(me)),n!==Pt){for(r=[],ve.test(e.charAt(ur))?(o=e.charAt(ur),ur++):(o=Pt,0===fr&&a(ye));o!==Pt;)r.push(o),ve.test(e.charAt(ur))?(o=e.charAt(ur),ur++):(o=Pt,0===fr&&a(ye));r===Pt&&(r=null),r!==Pt?((o=D())===Pt&&(o=null),o!==Pt?(41===e.charCodeAt(ur)?(i=be,ur++):(i=Pt,0===fr&&a(we)),i!==Pt?(cr=t,t=n=Pe(r,o)):(ur=t,t=Pt)):(ur=t,t=Pt)):(ur=t,t=Pt)}else ur=t,t=Pt;return t}function D(){var t,n,r,o;if(t=ur,58===e.charCodeAt(ur)?(n=xt,ur++):(n=Pt,0===fr&&a(St)),n!==Pt){if(r=[],ke.test(e.charAt(ur))?(o=e.charAt(ur),ur++):(o=Pt,0===fr&&a(Ee)),o!==Pt)for(;o!==Pt;)r.push(o),ke.test(e.charAt(ur))?(o=e.charAt(ur),ur++):(o=Pt,0===fr&&a(Ee));else r=Pt;r!==Pt?(cr=t,t=n=_e(r)):(ur=t,t=Pt)}else ur=t,t=Pt;return t}function x(){var t,e,n;return t=ur,(e=I())!==Pt?((n=A())===Pt&&(n=null),n!==Pt?(cr=t,t=e=Ce(e,n)):(ur=t,t=Pt)):(ur=t,t=Pt),t}function S(){var t,e;return t=ur,(e=x())!==Pt&&L()!==Pt?(cr=t,t=e=De(e)):(ur=t,t=Pt),t}function O(){var t,e;return t=ur,L()!==Pt&&(e=x())!==Pt?(cr=t,t=De(e)):(ur=t,t=Pt),t}function I(){var t,n,r,o,i;if(t=ur,n=ur,ue.test(e.charAt(ur))?(r=e.charAt(ur),ur++):(r=Pt,0===fr&&a(ce)),r!==Pt){for(o=[],xe.test(e.charAt(ur))?(i=e.charAt(ur),ur++):(i=Pt,0===fr&&a(Se));i!==Pt;)o.push(i),xe.test(e.charAt(ur))?(i=e.charAt(ur),ur++):(i=Pt,0===fr&&a(Se));o!==Pt?n=r=[r,o]:(ur=n,n=Pt)}else ur=n,n=Pt;return n!==Pt&&(cr=t,n=Oe(n)),t=n}function A(){var t,n,r,o;if(t=ur,91===e.charCodeAt(ur)?(n=Ie,ur++):(n=Pt,0===fr&&a(Ae)),n!==Pt){if(r=[],Ne.test(e.charAt(ur))?(o=e.charAt(ur),ur++):(o=Pt,0===fr&&a(Te)),o!==Pt)for(;o!==Pt;)r.push(o),Ne.test(e.charAt(ur))?(o=e.charAt(ur),ur++):(o=Pt,0===fr&&a(Te));else r=Pt;r!==Pt?(93===e.charCodeAt(ur)?(o=Re,ur++):(o=Pt,0===fr&&a(Le)),o!==Pt?(cr=t,t=n=Be(r)):(ur=t,t=Pt)):(ur=t,t=Pt)}else ur=t,t=Pt;return t}function N(){var t;return Ge.test(e.charAt(ur))?(t=e.charAt(ur),ur++):(t=Pt,0===fr&&a(je)),t}function T(){var t,n,r;return t=ur,Fe.test(e.charAt(ur))?(n=e.charAt(ur),ur++):(n=Pt,0===fr&&a(Me)),n!==Pt?(qe.test(e.charAt(ur))?(r=e.charAt(ur),ur++):(r=Pt,0===fr&&a(Ue)),r!==Pt?(cr=t,t=n=ze()):(ur=t,t=Pt)):(ur=t,t=Pt),t===Pt&&(He.test(e.charAt(ur))?(t=e.charAt(ur),ur++):(t=Pt,0===fr&&a(Ye))),t}function R(){var t,n;for(t=[],32===e.charCodeAt(ur)?(n=We,ur++):(n=Pt,0===fr&&a(Je));n!==Pt;)t.push(n),32===e.charCodeAt(ur)?(n=We,ur++):(n=Pt,0===fr&&a(Je));return t===Pt&&(t=null),t}function L(){var t,n;if(t=[],32===e.charCodeAt(ur)?(n=We,ur++):(n=Pt,0===fr&&a(Je)),n!==Pt)for(;n!==Pt;)t.push(n),32===e.charCodeAt(ur)?(n=We,ur++):(n=Pt,0===fr&&a(Je));else t=Pt;return t}function B(){var t,e;return t=ur,z()!==Pt&&(e=H())!==Pt&&z()!==Pt?(cr=t,t=Ke(e)):(ur=t,t=Pt),t}function G(){var t,n,r,o;return t=ur,(n=z())!==Pt?(91===e.charCodeAt(ur)?(r=Ie,ur++):(r=Pt,0===fr&&a(Ae)),r!==Pt&&(o=z())!==Pt?t=n=[n,r,o]:(ur=t,t=Pt)):(ur=t,t=Pt),t}function j(){var t,n,r,o;return t=ur,(n=z())!==Pt?(123===e.charCodeAt(ur)?(r=Xe,ur++):(r=Pt,0===fr&&a(Ve)),r!==Pt&&(o=z())!==Pt?t=n=[n,r,o]:(ur=t,t=Pt)):(ur=t,t=Pt),t}function F(){var t,n,r,o;return t=ur,(n=z())!==Pt?(93===e.charCodeAt(ur)?(r=Re,ur++):(r=Pt,0===fr&&a(Le)),r!==Pt&&(o=z())!==Pt?t=n=[n,r,o]:(ur=t,t=Pt)):(ur=t,t=Pt),t}function M(){var t,n,r,o;return t=ur,(n=z())!==Pt?(125===e.charCodeAt(ur)?(r=Qe,ur++):(r=Pt,0===fr&&a(Ze)),r!==Pt&&(o=z())!==Pt?t=n=[n,r,o]:(ur=t,t=Pt)):(ur=t,t=Pt),t}function q(){var t,n,r,o;return t=ur,(n=z())!==Pt?(58===e.charCodeAt(ur)?(r=xt,ur++):(r=Pt,0===fr&&a(St)),r!==Pt&&(o=z())!==Pt?t=n=[n,r,o]:(ur=t,t=Pt)):(ur=t,t=Pt),t}function U(){var t,n,r,o;return t=ur,(n=z())!==Pt?(44===e.charCodeAt(ur)?(r=Jt,ur++):(r=Pt,0===fr&&a(Kt)),r!==Pt&&(o=z())!==Pt?t=n=[n,r,o]:(ur=t,t=Pt)):(ur=t,t=Pt),t}function z(){var t,n;for(fr++,t=[],tn.test(e.charAt(ur))?(n=e.charAt(ur),ur++):(n=Pt,0===fr&&a(en));n!==Pt;)t.push(n),tn.test(e.charAt(ur))?(n=e.charAt(ur),ur++):(n=Pt,0===fr&&a(en));return fr--,t===Pt&&(n=Pt,0===fr&&a($e)),t}function H(){var t;return(t=Y())===Pt&&(t=W())===Pt&&(t=J())===Pt&&(t=K())===Pt&&(t=V())===Pt&&(t=Q())===Pt&&(t=at()),t}function Y(){var t,n;return t=ur,e.substr(ur,5)===nn?(n=nn,ur+=5):(n=Pt,0===fr&&a(rn)),n!==Pt&&(cr=t,n=on()),t=n}function W(){var t,n;return t=ur,e.substr(ur,4)===sn?(n=sn,ur+=4):(n=Pt,0===fr&&a(an)),n!==Pt&&(cr=t,n=un()),t=n}function J(){var t,n;return t=ur,e.substr(ur,4)===cn?(n=cn,ur+=4):(n=Pt,0===fr&&a(pn)),n!==Pt&&(cr=t,n=dn()),t=n}function K(){var t,e,n,r,o,i;if(t=ur,j()!==Pt){if(e=ur,(n=X())!==Pt){for(r=[],o=ur,U()!==Pt&&(i=X())!==Pt?(cr=o,o=ln(n,i)):(ur=o,o=Pt);o!==Pt;)r.push(o),o=ur,U()!==Pt&&(i=X())!==Pt?(cr=o,o=ln(n,i)):(ur=o,o=Pt);r!==Pt?(cr=e,e=n=fn(n,r)):(ur=e,e=Pt)}else ur=e,e=Pt;e===Pt&&(e=null),e!==Pt&&(n=M())!==Pt?(cr=t,t=hn(e)):(ur=t,t=Pt)}else ur=t,t=Pt;return t}function X(){var t,e,n;return t=ur,(e=at())!==Pt&&q()!==Pt&&(n=H())!==Pt?(cr=t,t=e=gn(e,n)):(ur=t,t=Pt),t}function V(){var t,e,n,r,o,i;if(t=ur,G()!==Pt){if(e=ur,(n=H())!==Pt){for(r=[],o=ur,U()!==Pt&&(i=H())!==Pt?(cr=o,o=mn(n,i)):(ur=o,o=Pt);o!==Pt;)r.push(o),o=ur,U()!==Pt&&(i=H())!==Pt?(cr=o,o=mn(n,i)):(ur=o,o=Pt);r!==Pt?(cr=e,e=n=vn(n,r)):(ur=e,e=Pt)}else ur=e,e=Pt;e===Pt&&(e=null),e!==Pt&&(n=F())!==Pt?(cr=t,t=yn(e)):(ur=t,t=Pt)}else ur=t,t=Pt;return t}function Q(){var t,e,n,r;return fr++,t=ur,(e=ot())===Pt&&(e=null),e!==Pt&&rt()!==Pt?((n=nt())===Pt&&(n=null),n!==Pt?((r=et())===Pt&&(r=null),r!==Pt?(cr=t,t=e=wn()):(ur=t,t=Pt)):(ur=t,t=Pt)):(ur=t,t=Pt),fr--,t===Pt&&(e=Pt,0===fr&&a(bn)),t}function Z(){var t;return 46===e.charCodeAt(ur)?(t=Nt,ur++):(t=Pt,0===fr&&a(Tt)),t}function $(){var t;return Pn.test(e.charAt(ur))?(t=e.charAt(ur),ur++):(t=Pt,0===fr&&a(kn)),t}function tt(){var t;return En.test(e.charAt(ur))?(t=e.charAt(ur),ur++):(t=Pt,0===fr&&a(_n)),t}function et(){var t,e,n,r,o;if(t=ur,(e=tt())!==Pt)if((n=ot())===Pt&&(n=it()),n===Pt&&(n=null),n!==Pt){if(r=[],(o=lt())!==Pt)for(;o!==Pt;)r.push(o),o=lt();else r=Pt;r!==Pt?t=e=[e,n,r]:(ur=t,t=Pt)}else ur=t,t=Pt;else ur=t,t=Pt;return t}function nt(){var t,e,n,r;if(t=ur,(e=Z())!==Pt){if(n=[],(r=lt())!==Pt)for(;r!==Pt;)n.push(r),r=lt();else n=Pt;n!==Pt?t=e=[e,n]:(ur=t,t=Pt)}else ur=t,t=Pt;return t}function rt(){var t,e,n,r;if((t=st())===Pt)if(t=ur,(e=$())!==Pt){for(n=[],r=lt();r!==Pt;)n.push(r),r=lt();n!==Pt?t=e=[e,n]:(ur=t,t=Pt)}else ur=t,t=Pt;return t}function ot(){var t;return 45===e.charCodeAt(ur)?(t=Cn,ur++):(t=Pt,0===fr&&a(Dn)),t}function it(){var t;return 43===e.charCodeAt(ur)?(t=xn,ur++):(t=Pt,0===fr&&a(Sn)),t}function st(){var t;return 48===e.charCodeAt(ur)?(t=On,ur++):(t=Pt,0===fr&&a(In)),t}function at(){var t,e,n;if(fr++,t=ur,pt()!==Pt){for(e=[],n=ut();n!==Pt;)e.push(n),n=ut();e!==Pt&&(n=pt())!==Pt?(cr=t,t=Nn(e)):(ur=t,t=Pt)}else ur=t,t=Pt;return fr--,t===Pt&&0===fr&&a(An),t}function ut(){var t,n,r,o,i,s,u,c,p;return(t=dt())===Pt&&(t=ur,ct()!==Pt?(34===e.charCodeAt(ur)?(n=Tn,ur++):(n=Pt,0===fr&&a(Rn)),n===Pt&&(92===e.charCodeAt(ur)?(n=Ln,ur++):(n=Pt,0===fr&&a(Bn)),n===Pt&&(47===e.charCodeAt(ur)?(n=Gn,ur++):(n=Pt,0===fr&&a(jn)),n===Pt&&(n=ur,98===e.charCodeAt(ur)?(r=Fn,ur++):(r=Pt,0===fr&&a(Mn)),r!==Pt&&(cr=n,r=qn()),(n=r)===Pt&&(n=ur,102===e.charCodeAt(ur)?(r=Un,ur++):(r=Pt,0===fr&&a(zn)),r!==Pt&&(cr=n,r=Hn()),(n=r)===Pt&&(n=ur,110===e.charCodeAt(ur)?(r=Yn,ur++):(r=Pt,0===fr&&a(Wn)),r!==Pt&&(cr=n,r=Jn()),(n=r)===Pt&&(n=ur,114===e.charCodeAt(ur)?(r=Kn,ur++):(r=Pt,0===fr&&a(Xn)),r!==Pt&&(cr=n,r=Vn()),(n=r)===Pt&&(n=ur,116===e.charCodeAt(ur)?(r=Qn,ur++):(r=Pt,0===fr&&a(Zn)),r!==Pt&&(cr=n,r=$n()),(n=r)===Pt&&(n=ur,117===e.charCodeAt(ur)?(r=tr,ur++):(r=Pt,0===fr&&a(er)),r!==Pt?(o=ur,i=ur,(s=ft())!==Pt&&(u=ft())!==Pt&&(c=ft())!==Pt&&(p=ft())!==Pt?i=s=[s,u,c,p]:(ur=i,i=Pt),(o=i!==Pt?e.substring(o,ur):i)!==Pt?(cr=n,n=r=nr(o)):(ur=n,n=Pt)):(ur=n,n=Pt))))))))),n!==Pt?(cr=t,t=rr(n)):(ur=t,t=Pt)):(ur=t,t=Pt)),t}function ct(){var t;return 92===e.charCodeAt(ur)?(t=Ln,ur++):(t=Pt,0===fr&&a(Bn)),t}function pt(){var t;return 34===e.charCodeAt(ur)?(t=Tn,ur++):(t=Pt,0===fr&&a(Rn)),t}function dt(){var t;return or.test(e.charAt(ur))?(t=e.charAt(ur),ur++):(t=Pt,0===fr&&a(ir)),t}function lt(){var t;return Ne.test(e.charAt(ur))?(t=e.charAt(ur),ur++):(t=Pt,0===fr&&a(Te)),t}function ft(){var t;return sr.test(e.charAt(ur))?(t=e.charAt(ur),ur++):(t=Pt,0===fr&&a(ar)),t}function ht(t){return t[0]+t[1].join("")}function gt(t,e,n){bt.caseSensitive||(n=n.toLowerCase());var r={process:t,port:e?e.port:n};return e&&null!=e.index&&(r.index=e.index),r}function mt(t,e){return gt(t,e,gr)}function vt(t,e){return gt(t,e,mr)}var yt,bt=arguments.length>1?arguments[1]:{},wt=this,Pt={},kt={start:c},Et=c,_t=function(){return wt.getResult()},Ct="EXPORT=",Dt={type:"literal",value:"EXPORT=",description:'"EXPORT="'},xt=":",St={type:"literal",value:":",description:'":"'},Ot=function(t,e){return wt.registerExports(t,e)},It="INPORT=",At={type:"literal",value:"INPORT=",description:'"INPORT="'},Nt=".",Tt={type:"literal",value:".",description:'"."'},Rt=function(t,e,n){return wt.registerInports(t,e,n)},Lt="OUTPORT=",Bt={type:"literal",value:"OUTPORT=",description:'"OUTPORT="'},Gt=function(t,e,n){return wt.registerOutports(t,e,n)},jt="DEFAULT_INPORT=",Ft={type:"literal",value:"DEFAULT_INPORT=",description:'"DEFAULT_INPORT="'},Mt=function(t){gr=t},qt="DEFAULT_OUTPORT=",Ut={type:"literal",value:"DEFAULT_OUTPORT=",description:'"DEFAULT_OUTPORT="'},zt=function(t){mr=t},Ht=/^[\n\r\u2028\u2029]/,Yt={type:"class",value:"[\\n\\r\\u2028\\u2029]",description:"[\\n\\r\\u2028\\u2029]"},Wt=function(t){return wt.registerEdges(t)},Jt=",",Kt={type:"literal",value:",",description:'","'},Xt="#",Vt={type:"literal",value:"#",description:'"#"'},Qt="->",Zt={type:"literal",value:"->",description:'"->"'},$t=function(t,e){return[t,e]},te=function(t,e,n){return[{tgt:mt(e,t)},{src:vt(e,n)}]},ee=function(t,e){return{src:vt(t,e)}},ne=function(t,e){return{tgt:mt(e,t)}},re="'",oe={type:"literal",value:"'",description:'"\'"'},ie=function(t){return{data:t.join("")}},se=function(t){return{data:t}},ae=function(t){return t},ue=/^[a-zA-Z_]/,ce={type:"class",value:"[a-zA-Z_]",description:"[a-zA-Z_]"},pe=/^[a-zA-Z0-9_\-]/,de={type:"class",value:"[a-zA-Z0-9_\\-]",description:"[a-zA-Z0-9_\\-]"},le=function(t){return ht(t)},fe=function(t,e){return wt.addNode(t,e),t},he=function(t){return wt.addAnonymousNode(t,o().start.offset)},ge="(",me={type:"literal",value:"(",description:'"("'},ve=/^[a-zA-Z\/\-0-9_]/,ye={type:"class",value:"[a-zA-Z/\\-0-9_]",description:"[a-zA-Z/\\-0-9_]"},be=")",we={type:"literal",value:")",description:'")"'},Pe=function(t,e){var n={};return n.comp=t?t.join(""):"",e&&(n.meta=e.join("").split(",")),n},ke=/^[a-zA-Z\/=_,0-9]/,Ee={type:"class",value:"[a-zA-Z/=_,0-9]",description:"[a-zA-Z/=_,0-9]"},_e=function(t){return t},Ce=function(t,e){return{port:bt.caseSensitive?t:t.toLowerCase(),index:null!=e?e:void 0}},De=function(t){return t},xe=/^[a-zA-Z.0-9_]/,Se={type:"class",value:"[a-zA-Z.0-9_]",description:"[a-zA-Z.0-9_]"},Oe=function(t){return ht(t)},Ie="[",Ae={type:"literal",value:"[",description:'"["'},Ne=/^[0-9]/,Te={type:"class",value:"[0-9]",description:"[0-9]"},Re="]",Le={type:"literal",value:"]",description:'"]"'},Be=function(t){return parseInt(t.join(""))},Ge=/^[^\n\r\u2028\u2029]/,je={type:"class",value:"[^\\n\\r\\u2028\\u2029]",description:"[^\\n\\r\\u2028\\u2029]"},Fe=/^[\\]/,Me={type:"class",value:"[\\\\]",description:"[\\\\]"},qe=/^[']/,Ue={type:"class",value:"[']",description:"[']"},ze=function(){return"'"},He=/^[^']/,Ye={type:"class",value:"[^']",description:"[^']"},We=" ",Je={type:"literal",value:" ",description:'" "'},Ke=function(t){return t},Xe="{",Ve={type:"literal",value:"{",description:'"{"'},Qe="}",Ze={type:"literal",value:"}",description:'"}"'},$e={type:"other",description:"whitespace"},tn=/^[ \t\n\r]/,en={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},nn="false",rn={type:"literal",value:"false",description:'"false"'},on=function(){return!1},sn="null",an={type:"literal",value:"null",description:'"null"'},un=function(){return null},cn="true",pn={type:"literal",value:"true",description:'"true"'},dn=function(){return!0},ln=function(t,e){return e},fn=function(t,e){var n,r={};for(r[t.name]=t.value,n=0;n<e.length;n++)r[e[n].name]=e[n].value;return r},hn=function(t){return null!==t?t:{}},gn=function(t,e){return{name:t,value:e}},mn=function(t,e){return e},vn=function(t,e){return[t].concat(e)},yn=function(t){return null!==t?t:[]},bn={type:"other",description:"number"},wn=function(){return parseFloat(r())},Pn=/^[1-9]/,kn={type:"class",value:"[1-9]",description:"[1-9]"},En=/^[eE]/,_n={type:"class",value:"[eE]",description:"[eE]"},Cn="-",Dn={type:"literal",value:"-",description:'"-"'},xn="+",Sn={type:"literal",value:"+",description:'"+"'},On="0",In={type:"literal",value:"0",description:'"0"'},An={type:"other",description:"string"},Nn=function(t){return t.join("")},Tn='"',Rn={type:"literal",value:'"',description:'"\\""'},Ln="\\",Bn={type:"literal",value:"\\",description:'"\\\\"'},Gn="/",jn={type:"literal",value:"/",description:'"/"'},Fn="b",Mn={type:"literal",value:"b",description:'"b"'},qn=function(){return"\b"},Un="f",zn={type:"literal",value:"f",description:'"f"'},Hn=function(){return"\f"},Yn="n",Wn={type:"literal",value:"n",description:'"n"'},Jn=function(){return"\n"},Kn="r",Xn={type:"literal",value:"r",description:'"r"'},Vn=function(){return"\r"},Qn="t",Zn={type:"literal",value:"t",description:'"t"'},$n=function(){return"\t"},tr="u",er={type:"literal",value:"u",description:'"u"'},nr=function(t){return String.fromCharCode(parseInt(t,16))},rr=function(t){return t},or=/^[^\0-\x1F"\\]/,ir={type:"class",value:"[^\\0-\\x1F\\x22\\x5C]",description:"[^\\0-\\x1F\\x22\\x5C]"},sr=/^[0-9a-f]/i,ar={type:"class",value:"[0-9a-f]i",description:"[0-9a-f]i"},ur=0,cr=0,pr=[{line:1,column:1,seenCR:!1}],dr=0,lr=[],fr=0;if("startRule"in bt){if(!(bt.startRule in kt))throw new Error("Can't start parsing from rule \""+bt.startRule+'".');Et=kt[bt.startRule]}var hr,gr="IN",mr="OUT";delete(wt=this).exports,delete wt.inports,delete wt.outports,wt.edges=[],hr={};var vr=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};wt.serialize=function(t){var e,n,r,o,i,s,a,u,c,p,d,l,f,h,g,m,v,y,b,w,P,k,E;null==bt&&(bt={}),c=[],d="",r=function(t){return null!=s.processes[t].metadata&&(t=s.processes[t].metadata.label),t.indexOf("/")>-1&&(t=t.split("/").pop()),t},n=function(t,e){return null!=e.process&&null!=s.processes[e.process].metadata?t=s.processes[e.process].metadata.label:null!=e.process&&(t=e.process),t.indexOf("/")>-1&&(t=t.split("/").pop()),t},f=(s="string"==typeof t?JSON.parse(t):t).inports;for(u in f)l=n(u,i=f[u]),u=u.toUpperCase(),i.port=i.port.toUpperCase(),d+="INPORT="+l+"."+i.port+":"+u+"\n";h=s.outports;for(u in h)p=h[u],l=n(u,i),u=u.toUpperCase(),p.port=p.port.toUpperCase(),d+="OUTPORT="+l+"."+p.port+":"+u+"\n";for(d+="\n",o=0,a=(g=s.connections).length;o<a;o++)null!=(e=g[o]).data?(k=e.tgt.port.toUpperCase(),P=e.tgt.process,E=s.processes[P].component,w=r(P),vr.call(c,E)<0&&(w+="("+E+")",c.push(E)),d+='"'+e.data+'" -> '+k+" "+w+"\n"):(y=e.src.port.toUpperCase(),v=e.src.process,b=s.processes[v].component,m=r(v),vr.call(c,b)<0&&(m+="("+b+")",c.push(b)),k=e.tgt.port.toUpperCase(),P=e.tgt.process,E=s.processes[P].component,w=r(P),vr.call(c,E)<0&&(w+="("+E+")",c.push(E)),d+=m+" "+y+" -> "+k+" "+w+"\n");return d},wt.addNode=function(t,e){if(hr[t]||(hr[t]={}),e.comp&&(hr[t].component=e.comp),e.meta){for(var n={},r=0;r<e.meta.length;r++){var o=e.meta[r].split("=");1===o.length&&(o=["routes",o[0]]);var i=o[0],s=o[1];"x"!==i&&"y"!==i||(s=parseFloat(s)),n[i]=s}hr[t].metadata=n}};var yr={},br={};wt.addAnonymousNode=function(t,e){if(!br[e]){var n=t.comp.replace(/[^a-zA-Z0-9]+/,"_");yr[n]=(yr[n]||0)+1,br[e]="_"+n+"_"+yr[n],this.addNode(br[e],t)}return br[e]},wt.getResult=function(){var t={processes:hr,connections:wt.processEdges(),exports:wt.exports,inports:wt.inports,outports:wt.outports},e=wt.validateSchema;if(void 0!==bt.validateSchema&&(e=bt.validateSchema),e){if(void 0===r)var r=n(!function(){var t=new Error('Cannot find module "tv4"');throw t.code="MODULE_NOT_FOUND",t}());var o=n(33),i=r.validateMultiple(t,o);if(!i.valid)throw new Error("fbp: Did not validate againt graph schema:\n"+JSON.stringify(i.errors,null,2))}return t.caseSensitive=bt.caseSensitive,t};var wr=function(t,e){for(var n=-1,r=t?t.length:0,o=[];++n<r;){var i=t[n];i instanceof Array?Array.prototype.push.apply(o,e?i:wr(i)):o.push(i)}return o};if(wt.registerExports=function(t,e){wt.exports||(wt.exports=[]),bt.caseSensitive||(t=t.toLowerCase(),e=e.toLowerCase()),wt.exports.push({private:t,public:e})},wt.registerInports=function(t,e,n){wt.inports||(wt.inports={}),bt.caseSensitive||(n=n.toLowerCase(),e=e.toLowerCase()),wt.inports[n]={process:t,port:e}},wt.registerOutports=function(t,e,n){wt.outports||(wt.outports={}),bt.caseSensitive||(n=n.toLowerCase(),e=e.toLowerCase()),wt.outports[n]={process:t,port:e}},wt.registerEdges=function(t){Array.isArray(t)&&t.forEach(function(t,e){wt.edges.push(t)})},wt.processEdges=function(){var t,e;t=wr(wt.edges),e=[];for(var n=1;n<t.length;n+=1)("src"in t[n-1]||"data"in t[n-1])&&"tgt"in t[n]&&(t[n-1].tgt=t[n].tgt,e.push(t[n-1]),n++);return e},(yt=Et())!==Pt&&ur===e.length)return yt;throw yt!==Pt&&ur<e.length&&a({type:"end",description:"end of input"}),u(null,lr,dr<e.length?e.charAt(dr):null,dr<e.length?s(dr,dr+1):s(dr,dr))}}}()},function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema",id:"graph.json",title:"FBP graph",description:"A graph of FBP processes and connections between them.\nThis is the primary way of specifying FBP programs.\n",name:"graph",type:"object",additionalProperties:!1,properties:{properties:{type:"object",description:"User-defined properties attached to the graph.",additionalProperties:!0,properties:{name:{type:"string"}}},inports:{type:["object","undefined"],description:"Exported inports of the graph",additionalProperties:!0,patternProperties:{"[a-z0-9]+":{type:"object",properties:{process:{type:"string"},port:{type:"string"},metadata:{type:"object",additionalProperties:!0}}}}},outports:{type:["object","undefined"],description:"Exported outports of the graph",additionalProperties:!0,patternProperties:{"[a-z0-9]+":{type:"object",properties:{process:{type:"string"},port:{type:"string"},metadata:{type:"object",additionalProperties:!0}}}}},exports:{type:["array","undefined"],description:"Deprecated, use inports and outports instead"},groups:{type:"array",description:"List of groups of processes",items:{type:"object",additionalProperties:!1,properties:{name:{type:"string"},nodes:{type:"array",items:{type:"string"}},metadata:{additionalProperties:!0}}}},processes:{type:"object",description:"The processes of this graph.\nEach process is an instance of a component.\n",additionalProperties:!1,patternProperties:{"[a-zA-Z0-9_]+":{type:"object",properties:{component:{type:"string"},metadata:{type:"object",additionalProperties:!0}}}}},connections:{type:"array",description:"Connections of the graph.\nA connection either connects ports of two processes, or specifices an IIP as initial input packet to a port.\n",items:{type:"object",additionalProperties:!1,properties:{src:{type:"object",additionalProperties:!1,properties:{process:{type:"string"},port:{type:"string"},index:{type:"integer"}}},tgt:{type:"object",additionalProperties:!1,properties:{process:{type:"string"},port:{type:"string"},index:{type:"integer"}}},data:{},metadata:{type:"object",additionalProperties:!0}}}}}}},function(t,e,n){(function(){var t,r,o,i,s,a,u,c=function(t,e){function n(){this.constructor=t}for(var r in e)p.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},p={}.hasOwnProperty,d=function(t,e){return function(){return t.apply(e,arguments)}};t=n(2).EventEmitter,a=n(13),u=function(t){var e;switch(e=t.args,t.cmd){case"addNode":return e.id+"("+e.component+")";case"removeNode":return"DEL "+e.id+"("+e.component+")";case"renameNode":return"RENAME "+e.oldId+" "+e.newId;case"changeNode":return"META "+e.id;case"addEdge":return e.from.node+" "+e.from.port+" -> "+e.to.port+" "+e.to.node;case"removeEdge":return e.from.node+" "+e.from.port+" -X> "+e.to.port+" "+e.to.node;case"changeEdge":return"META "+e.from.node+" "+e.from.port+" -> "+e.to.port+" "+e.to.node;case"addInitial":return"'"+e.from.data+"' -> "+e.to.port+" "+e.to.node;case"removeInitial":return"'"+e.from.data+"' -X> "+e.to.port+" "+e.to.node;case"startTransaction":return">>> "+t.rev+": "+e.id;case"endTransaction":return"<<< "+t.rev+": "+e.id;case"changeProperties":return"PROPERTIES";case"addGroup":return"GROUP "+e.name;case"renameGroup":return"RENAME GROUP "+e.oldName+" "+e.newName;case"removeGroup":return"DEL GROUP "+e.name;case"changeGroup":return"META GROUP "+e.name;case"addInport":return"INPORT "+e.name;case"removeInport":return"DEL INPORT "+e.name;case"renameInport":return"RENAME INPORT "+e.oldId+" "+e.newId;case"changeInport":return"META INPORT "+e.name;case"addOutport":return"OUTPORT "+e.name;case"removeOutport":return"DEL OUTPORT "+e.name;case"renameOutport":return"RENAME OUTPORT "+e.oldId+" "+e.newId;case"changeOutport":return"META OUTPORT "+e.name;default:throw new Error("Unknown journal entry: "+t.cmd)}},s=function(t,e){var n,r,o;r={};for(n in t)o=t[n],r[n]=null;for(n in e)o=e[n],r[n]=o;return r},o=function(e){function n(t){this.graph=t,this.lastRevision=0}return c(n,t),n.prototype.lastRevision=0,n.prototype.putTransaction=function(t,e){return t>this.lastRevision&&(this.lastRevision=t),this.emit("transaction",t)},n.prototype.fetchTransaction=function(t,e){},n}(),i=function(t){function e(t){e.__super__.constructor.call(this,t),this.transactions=[]}return c(e,o),e.prototype.putTransaction=function(t,n){return e.__super__.putTransaction.call(this,t,n),this.transactions[t]=n},e.prototype.fetchTransaction=function(t){return this.transactions[t]},e}(),r=function(e){function r(t,e,n){this.endTransaction=d(this.endTransaction,this),this.startTransaction=d(this.startTransaction,this);var r,o,s,a,u,c,p,l,f,h,g,m,v,y,b,w,P,k,E,_;if(this.graph=t,this.entries=[],this.subscribed=!0,this.store=n||new i(this.graph),0===this.store.transactions.length){for(this.currentRevision=-1,this.startTransaction("initial",e),a=0,p=(y=this.graph.nodes).length;a<p;a++)v=y[a],this.appendCommand("addNode",v);for(c=0,l=(b=this.graph.edges).length;c<l;c++)r=b[c],this.appendCommand("addEdge",r);for(g=0,f=(w=this.graph.initializers).length;g<f;g++)s=w[g],this.appendCommand("addInitial",s);Object.keys(this.graph.properties).length>0&&this.appendCommand("changeProperties",this.graph.properties,{}),P=this.graph.inports;for(u in P)_=P[u],this.appendCommand("addInport",{name:u,port:_});k=this.graph.outports;for(u in k)_=k[u],this.appendCommand("addOutport",{name:u,port:_});for(m=0,h=(E=this.graph.groups).length;m<h;m++)o=E[m],this.appendCommand("addGroup",o);this.endTransaction("initial",e)}else this.currentRevision=this.store.lastRevision;this.graph.on("addNode",function(t){return function(e){return t.appendCommand("addNode",e)}}(this)),this.graph.on("removeNode",function(t){return function(e){return t.appendCommand("removeNode",e)}}(this)),this.graph.on("renameNode",function(t){return function(e,n){var r;return r={oldId:e,newId:n},t.appendCommand("renameNode",r)}}(this)),this.graph.on("changeNode",function(t){return function(e,n){return t.appendCommand("changeNode",{id:e.id,new:e.metadata,old:n})}}(this)),this.graph.on("addEdge",function(t){return function(e){return t.appendCommand("addEdge",e)}}(this)),this.graph.on("removeEdge",function(t){return function(e){return t.appendCommand("removeEdge",e)}}(this)),this.graph.on("changeEdge",function(t){return function(e,n){return t.appendCommand("changeEdge",{from:e.from,to:e.to,new:e.metadata,old:n})}}(this)),this.graph.on("addInitial",function(t){return function(e){return t.appendCommand("addInitial",e)}}(this)),this.graph.on("removeInitial",function(t){return function(e){return t.appendCommand("removeInitial",e)}}(this)),this.graph.on("changeProperties",function(t){return function(e,n){return t.appendCommand("changeProperties",{new:e,old:n})}}(this)),this.graph.on("addGroup",function(t){return function(e){return t.appendCommand("addGroup",e)}}(this)),this.graph.on("renameGroup",function(t){return function(e,n){return t.appendCommand("renameGroup",{oldName:e,newName:n})}}(this)),this.graph.on("removeGroup",function(t){return function(e){return t.appendCommand("removeGroup",e)}}(this)),this.graph.on("changeGroup",function(t){return function(e,n){return t.appendCommand("changeGroup",{name:e.name,new:e.metadata,old:n})}}(this)),this.graph.on("addExport",function(t){return function(e){return t.appendCommand("addExport",e)}}(this)),this.graph.on("removeExport",function(t){return function(e){return t.appendCommand("removeExport",e)}}(this)),this.graph.on("addInport",function(t){return function(e,n){return t.appendCommand("addInport",{name:e,port:n})}}(this)),this.graph.on("removeInport",function(t){return function(e,n){return t.appendCommand("removeInport",{name:e,port:n})}}(this)),this.graph.on("renameInport",function(t){return function(e,n){return t.appendCommand("renameInport",{oldId:e,newId:n})}}(this)),this.graph.on("changeInport",function(t){return function(e,n,r){return t.appendCommand("changeInport",{name:e,new:n.metadata,old:r})}}(this)),this.graph.on("addOutport",function(t){return function(e,n){return t.appendCommand("addOutport",{name:e,port:n})}}(this)),this.graph.on("removeOutport",function(t){return function(e,n){return t.appendCommand("removeOutport",{name:e,port:n})}}(this)),this.graph.on("renameOutport",function(t){return function(e,n){return t.appendCommand("renameOutport",{oldId:e,newId:n})}}(this)),this.graph.on("changeOutport",function(t){return function(e,n,r){return t.appendCommand("changeOutport",{name:e,new:n.metadata,old:r})}}(this)),this.graph.on("startTransaction",function(t){return function(e,n){return t.startTransaction(e,n)}}(this)),this.graph.on("endTransaction",function(t){return function(e,n){return t.endTransaction(e,n)}}(this))}return c(r,t),r.prototype.graph=null,r.prototype.entries=[],r.prototype.subscribed=!0,r.prototype.startTransaction=function(t,e){if(this.subscribed){if(this.entries.length>0)throw Error("Inconsistent @entries");return this.currentRevision++,this.appendCommand("startTransaction",{id:t,metadata:e},this.currentRevision)}},r.prototype.endTransaction=function(t,e){if(this.subscribed)return this.appendCommand("endTransaction",{id:t,metadata:e},this.currentRevision),this.store.putTransaction(this.currentRevision,this.entries),this.entries=[]},r.prototype.appendCommand=function(t,e,n){var r;if(this.subscribed)return r={cmd:t,args:a(e)},null!=n&&(r.rev=n),this.entries.push(r)},r.prototype.executeEntry=function(t){var e;switch(e=t.args,t.cmd){case"addNode":return this.graph.addNode(e.id,e.component);case"removeNode":return this.graph.removeNode(e.id);case"renameNode":return this.graph.renameNode(e.oldId,e.newId);case"changeNode":return this.graph.setNodeMetadata(e.id,s(e.old,e.new));case"addEdge":return this.graph.addEdge(e.from.node,e.from.port,e.to.node,e.to.port);case"removeEdge":return this.graph.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port);case"changeEdge":return this.graph.setEdgeMetadata(e.from.node,e.from.port,e.to.node,e.to.port,s(e.old,e.new));case"addInitial":return this.graph.addInitial(e.from.data,e.to.node,e.to.port);case"removeInitial":return this.graph.removeInitial(e.to.node,e.to.port);case"startTransaction":case"endTransaction":return null;case"changeProperties":return this.graph.setProperties(e.new);case"addGroup":return this.graph.addGroup(e.name,e.nodes,e.metadata);case"renameGroup":return this.graph.renameGroup(e.oldName,e.newName);case"removeGroup":return this.graph.removeGroup(e.name);case"changeGroup":return this.graph.setGroupMetadata(e.name,s(e.old,e.new));case"addInport":return this.graph.addInport(e.name,e.port.process,e.port.port,e.port.metadata);case"removeInport":return this.graph.removeInport(e.name);case"renameInport":return this.graph.renameInport(e.oldId,e.newId);case"changeInport":return this.graph.setInportMetadata(e.name,s(e.old,e.new));case"addOutport":return this.graph.addOutport(e.name,e.port.process,e.port.port,e.port.metadata(e.name));case"removeOutport":return this.graph.removeOutport;case"renameOutport":return this.graph.renameOutport(e.oldId,e.newId);case"changeOutport":return this.graph.setOutportMetadata(e.name,s(e.old,e.new));default:throw new Error("Unknown journal entry: "+t.cmd)}},r.prototype.executeEntryInversed=function(t){var e;switch(e=t.args,t.cmd){case"addNode":return this.graph.removeNode(e.id);case"removeNode":return this.graph.addNode(e.id,e.component);case"renameNode":return this.graph.renameNode(e.newId,e.oldId);case"changeNode":return this.graph.setNodeMetadata(e.id,s(e.new,e.old));case"addEdge":return this.graph.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port);case"removeEdge":return this.graph.addEdge(e.from.node,e.from.port,e.to.node,e.to.port);case"changeEdge":return this.graph.setEdgeMetadata(e.from.node,e.from.port,e.to.node,e.to.port,s(e.new,e.old));case"addInitial":return this.graph.removeInitial(e.to.node,e.to.port);case"removeInitial":return this.graph.addInitial(e.from.data,e.to.node,e.to.port);case"startTransaction":case"endTransaction":return null;case"changeProperties":return this.graph.setProperties(e.old);case"addGroup":return this.graph.removeGroup(e.name);case"renameGroup":return this.graph.renameGroup(e.newName,e.oldName);case"removeGroup":return this.graph.addGroup(e.name,e.nodes,e.metadata);case"changeGroup":return this.graph.setGroupMetadata(e.name,s(e.new,e.old));case"addInport":return this.graph.removeInport(e.name);case"removeInport":return this.graph.addInport(e.name,e.port.process,e.port.port,e.port.metadata);case"renameInport":return this.graph.renameInport(e.newId,e.oldId);case"changeInport":return this.graph.setInportMetadata(e.name,s(e.new,e.old));case"addOutport":return this.graph.removeOutport(e.name);case"removeOutport":return this.graph.addOutport(e.name,e.port.process,e.port.port,e.port.metadata);case"renameOutport":return this.graph.renameOutport(e.newId,e.oldId);case"changeOutport":return this.graph.setOutportMetadata(e.name,s(e.new,e.old));default:throw new Error("Unknown journal entry: "+t.cmd)}},r.prototype.moveToRevision=function(t){var e,n,r,o,i,s,a,u,c,p,d,l,f;if(t!==this.currentRevision){if(this.subscribed=!1,t>this.currentRevision)for(c=o=p=this.currentRevision+1,d=t;p<=d?o<=d:o>=d;c=p<=d?++o:--o)for(i=0,s=(l=this.store.fetchTransaction(c)).length;i<s;i++)n=l[i],this.executeEntry(n);else for(c=a=this.currentRevision,f=t+1;a>=f;c=a+=-1)for(r=u=(e=this.store.fetchTransaction(c)).length-1;u>=0;r=u+=-1)this.executeEntryInversed(e[r]);return this.currentRevision=t,this.subscribed=!0}},r.prototype.undo=function(){if(this.canUndo())return this.moveToRevision(this.currentRevision-1)},r.prototype.canUndo=function(){return this.currentRevision>0},r.prototype.redo=function(){if(this.canRedo())return this.moveToRevision(this.currentRevision+1)},r.prototype.canRedo=function(){return this.currentRevision<this.store.lastRevision},r.prototype.toPrettyString=function(t,e){var n,r,o,i,s,a,c,p,d;for(a=[],c=o=p=t|=0,d=e|=this.store.lastRevision;p<=d?o<d:o>d;c=p<=d?++o:--o)for(i=0,s=(n=this.store.fetchTransaction(c)).length;i<s;i++)r=n[i],a.push(u(r));return a.join("\n")},r.prototype.toJSON=function(t,e){var n,r,o,i,s,a,c,p;for(n=[],a=o=t|=0,c=e|=this.store.lastRevision;o<c;a=o+=1)for(i=0,s=(p=this.store.fetchTransaction(a)).length;i<s;i++)r=p[i],n.push(u(r));return n},r.prototype.save=function(t,e){var r;return r=JSON.stringify(this.toJSON(),null,4),n(6).writeFile(t+".json",r,"utf-8",function(n,r){if(n)throw n;return e(t)})},r}(),e.Journal=r,e.JournalStore=o,e.MemoryJournalStore=i}).call(this)},function(module,exports,__webpack_require__){var registerCustomLoaders=function(t,e,n){if(!e.length)return n();var r=e.shift();t.registerLoader(r,function(r){if(r)return n(r);registerCustomLoaders(t,e,n)})},sources={"browser-app/DoSomething":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n\n  # Define a meaningful icon for component from http://fontawesome.io/icons/\n  c.icon = 'cog'\n\n  # Provide a description on component usage\n  c.description = 'do X'\n\n  # Add input ports\n  c.inPorts.add 'in',\n    datatype: 'string'\n\n  # Add output ports\n  c.outPorts.add 'out',\n    datatype: 'string'\n\n  # What to do when port receives a packet\n  c.process (input, output) ->\n    # Check that input has received data packet\n    return unless input.hasData 'in'\n    # Read the contents of the data packet\n    data = input.getData 'in'\n    # Send the contents to output port\n    output.send\n      out: data\n    # Finish processing\n    output.done()\n"},Graph:{language:"javascript",source:"(function() {\n  var Graph, noflo,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  noflo = require(\"../lib/NoFlo\");\n\n  Graph = (function(superClass) {\n    extend(Graph, superClass);\n\n    function Graph(metadata1) {\n      this.metadata = metadata1;\n      this.network = null;\n      this.ready = true;\n      this.started = false;\n      this.starting = false;\n      this.baseDir = null;\n      this.loader = null;\n      this.load = 0;\n      this.inPorts = new noflo.InPorts({\n        graph: {\n          datatype: 'all',\n          description: 'NoFlo graph definition to be used with the subgraph component',\n          required: true\n        }\n      });\n      this.outPorts = new noflo.OutPorts;\n      this.inPorts.graph.on('ip', (function(_this) {\n        return function(packet) {\n          if (packet.type !== 'data') {\n            return;\n          }\n          return _this.setGraph(packet.data, function(err) {\n            if (err) {\n              return _this.error(err);\n            }\n          });\n        };\n      })(this));\n    }\n\n    Graph.prototype.setGraph = function(graph, callback) {\n      this.ready = false;\n      if (typeof graph === 'object') {\n        if (typeof graph.addNode === 'function') {\n          this.createNetwork(graph, callback);\n          return;\n        }\n        noflo.graph.loadJSON(graph, (function(_this) {\n          return function(err, instance) {\n            if (err) {\n              return callback(err);\n            }\n            instance.baseDir = _this.baseDir;\n            return _this.createNetwork(instance, callback);\n          };\n        })(this));\n        return;\n      }\n      if (graph.substr(0, 1) !== \"/\" && graph.substr(1, 1) !== \":\" && process && process.cwd) {\n        graph = (process.cwd()) + \"/\" + graph;\n      }\n      return noflo.graph.loadFile(graph, (function(_this) {\n        return function(err, instance) {\n          if (err) {\n            return callback(err);\n          }\n          instance.baseDir = _this.baseDir;\n          return _this.createNetwork(instance, callback);\n        };\n      })(this));\n    };\n\n    Graph.prototype.createNetwork = function(graph, callback) {\n      this.description = graph.properties.description || '';\n      this.icon = graph.properties.icon || this.icon;\n      if (!graph.name) {\n        graph.name = this.nodeId;\n      }\n      graph.componentLoader = this.loader;\n      return noflo.createNetwork(graph, (function(_this) {\n        return function(err, network1) {\n          _this.network = network1;\n          if (err) {\n            return callback(err);\n          }\n          _this.emit('network', _this.network);\n          _this.subscribeNetwork(_this.network);\n          return _this.network.connect(function(err) {\n            var name, node, ref;\n            if (err) {\n              return callback(err);\n            }\n            ref = _this.network.processes;\n            for (name in ref) {\n              node = ref[name];\n              _this.findEdgePorts(name, node);\n            }\n            _this.setToReady();\n            return callback();\n          });\n        };\n      })(this), true);\n    };\n\n    Graph.prototype.subscribeNetwork = function(network) {\n      var contexts;\n      contexts = [];\n      this.network.on('start', (function(_this) {\n        return function() {\n          var ctx;\n          ctx = {};\n          contexts.push(ctx);\n          return _this.activate(ctx);\n        };\n      })(this));\n      return this.network.on('end', (function(_this) {\n        return function() {\n          var ctx;\n          ctx = contexts.pop();\n          if (!ctx) {\n            return;\n          }\n          return _this.deactivate(ctx);\n        };\n      })(this));\n    };\n\n    Graph.prototype.isExportedInport = function(port, nodeName, portName) {\n      var exported, i, len, priv, pub, ref, ref1;\n      ref = this.network.graph.inports;\n      for (pub in ref) {\n        priv = ref[pub];\n        if (!(priv.process === nodeName && priv.port === portName)) {\n          continue;\n        }\n        return pub;\n      }\n      ref1 = this.network.graph.exports;\n      for (i = 0, len = ref1.length; i < len; i++) {\n        exported = ref1[i];\n        if (!(exported.process === nodeName && exported.port === portName)) {\n          continue;\n        }\n        this.network.graph.checkTransactionStart();\n        this.network.graph.removeExport(exported[\"public\"]);\n        this.network.graph.addInport(exported[\"public\"], exported.process, exported.port, exported.metadata);\n        this.network.graph.checkTransactionEnd();\n        return exported[\"public\"];\n      }\n      return false;\n    };\n\n    Graph.prototype.isExportedOutport = function(port, nodeName, portName) {\n      var exported, i, len, priv, pub, ref, ref1;\n      ref = this.network.graph.outports;\n      for (pub in ref) {\n        priv = ref[pub];\n        if (!(priv.process === nodeName && priv.port === portName)) {\n          continue;\n        }\n        return pub;\n      }\n      ref1 = this.network.graph.exports;\n      for (i = 0, len = ref1.length; i < len; i++) {\n        exported = ref1[i];\n        if (!(exported.process === nodeName && exported.port === portName)) {\n          continue;\n        }\n        this.network.graph.checkTransactionStart();\n        this.network.graph.removeExport(exported[\"public\"]);\n        this.network.graph.addOutport(exported[\"public\"], exported.process, exported.port, exported.metadata);\n        this.network.graph.checkTransactionEnd();\n        return exported[\"public\"];\n      }\n      return false;\n    };\n\n    Graph.prototype.setToReady = function() {\n      if (typeof process !== 'undefined' && process.execPath && process.execPath.indexOf('node') !== -1) {\n        return process.nextTick((function(_this) {\n          return function() {\n            _this.ready = true;\n            return _this.emit('ready');\n          };\n        })(this));\n      } else {\n        return setTimeout((function(_this) {\n          return function() {\n            _this.ready = true;\n            return _this.emit('ready');\n          };\n        })(this), 0);\n      }\n    };\n\n    Graph.prototype.findEdgePorts = function(name, process) {\n      var inPorts, outPorts, port, portName, targetPortName;\n      inPorts = process.component.inPorts.ports || process.component.inPorts;\n      outPorts = process.component.outPorts.ports || process.component.outPorts;\n      for (portName in inPorts) {\n        port = inPorts[portName];\n        targetPortName = this.isExportedInport(port, name, portName);\n        if (targetPortName === false) {\n          continue;\n        }\n        this.inPorts.add(targetPortName, port);\n        this.inPorts[targetPortName].once('connect', (function(_this) {\n          return function() {\n            if (_this.starting) {\n              return;\n            }\n            if (_this.isStarted()) {\n              return;\n            }\n            return _this.start(function() {});\n          };\n        })(this));\n      }\n      for (portName in outPorts) {\n        port = outPorts[portName];\n        targetPortName = this.isExportedOutport(port, name, portName);\n        if (targetPortName === false) {\n          continue;\n        }\n        this.outPorts.add(targetPortName, port);\n      }\n      return true;\n    };\n\n    Graph.prototype.isReady = function() {\n      return this.ready;\n    };\n\n    Graph.prototype.isSubgraph = function() {\n      return true;\n    };\n\n    Graph.prototype.setUp = function(callback) {\n      this.starting = true;\n      if (!this.isReady()) {\n        this.once('ready', (function(_this) {\n          return function() {\n            return _this.setUp(callback);\n          };\n        })(this));\n        return;\n      }\n      if (!this.network) {\n        return callback(null);\n      }\n      return this.network.start(function(err) {\n        if (err) {\n          return callback(err);\n        }\n        this.starting = false;\n        return callback();\n      });\n    };\n\n    Graph.prototype.tearDown = function(callback) {\n      this.starting = false;\n      if (!this.network) {\n        return callback(null);\n      }\n      return this.network.stop(function(err) {\n        if (err) {\n          return callback(err);\n        }\n        return callback();\n      });\n    };\n\n    return Graph;\n\n  })(noflo.Component);\n\n  exports.getComponent = function(metadata) {\n    return new Graph(metadata);\n  };\n\n}).call(this);\n"},"core/Callback":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'This component calls a given callback function for each\n  IP it receives.  The Callback component is typically used to connect\n  NoFlo with external Node.js code.'\n  c.icon = 'sign-out'\n\n  c.inPorts.add 'in',\n    description: 'Object passed as argument of the callback'\n    datatype: 'all'\n  c.inPorts.add 'callback',\n    description: 'Callback to invoke'\n    datatype: 'function'\n    control: true\n    required: true\n  c.outPorts.add 'error',\n    datatype: 'object'\n\n  c.process (input, output) ->\n    return unless input.hasData 'callback', 'in'\n    [callback, data] = input.getData 'callback', 'in'\n    unless typeof callback is 'function'\n      output.done new Error 'The provided callback must be a function'\n      return\n\n    # Call the callback when receiving data\n    try\n      callback data\n    catch e\n      return output.done e\n    output.done()\n"},"core/Copy":{language:"coffeescript",source:"noflo = require 'noflo'\nowl = require 'owl-deepcopy'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'deep (i.e. recursively) copy an object'\n  c.icon = 'copy'\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be copied'\n  c.outPorts.add 'out',\n    datatype: 'all'\n    description: 'Copy of the original packet'\n\n  c.process (input, output) ->\n    return unless input.hasData 'in'\n    data = input.getData 'in'\n\n    copy = owl.deepCopy data\n    output.sendDone\n      out: copy\n    return\n"},"core/DisconnectAfterPacket":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Makes each data packet a stream of its own'\n  c.icon = 'pause'\n  c.forwardBrackets = {}\n  c.autoOrdering = false\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be forward with disconnection'\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  brackets = {}\n  c.tearDown = (callback) ->\n    brackets = {}\n  c.process (input, output) ->\n    # Force auto-ordering to be off for this one\n    c.autoOrdering = false\n\n    data = input.get 'in'\n    brackets[input.scope] = [] unless brackets[input.scope]\n    if data.type is 'openBracket'\n      brackets[input.scope].push data.data\n      output.done()\n      return\n    if data.type is 'closeBracket'\n      brackets[input.scope].pop()\n      output.done()\n      return\n\n    return unless data.type is 'data'\n\n    for bracket in brackets[input.scope]\n      output.sendIP 'out', new noflo.IP 'openBracket', bracket\n    output.sendIP 'out', data\n    closes = brackets[input.scope].slice 0\n    closes.reverse()\n    for bracket in closes\n      output.sendIP 'out', new noflo.IP 'closeBracket', bracket\n\n    output.done()\n"},"core/Drop":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'This component drops every packet it receives with no\n  action'\n  c.icon = 'trash-o'\n\n  c.inPorts.add 'in',\n    datatypes: 'all'\n    description: 'Packet to be dropped'\n\n  c.process (input, output) ->\n    data = input.get 'in'\n    data.drop()\n    output.done()\n    return\n"},"core/Kick":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'This component generates a single packet and sends it to\n  the output port. Mostly usable for debugging, but can also be useful\n  for starting up networks.'\n  c.icon = 'share'\n\n  c.inPorts.add 'in',\n    datatype: 'bang'\n    description: 'Signal to send the data packet'\n  c.inPorts.add 'data',\n    datatype: 'all'\n    description: 'Packet to be sent'\n    control: true\n    default: null\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    return unless input.hasStream 'in'\n    return if input.attached('data').length and not input.hasData 'data'\n    bang = input.getData 'in'\n    data = input.getData 'data'\n    output.send\n      out: data\n    output.done()\n"},"core/MakeFunction":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Evaluates a function each time data hits the \"in\" port\n  and sends the return value to \"out\". Within the function \"x\" will\n  be the variable from the in port. For example, to make a ^2 function\n  input \"return x*x;\" to the function port.'\n  c.icon = 'code'\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be processed'\n  c.inPorts.add 'function',\n    datatype: 'string'\n    description: 'Function to evaluate'\n    control: true\n  c.outPorts.add 'out',\n    datatype: 'all'\n  c.outPorts.add 'function',\n    datatype: 'function'\n  c.outPorts.add 'error',\n    datatype: 'object'\n\n  prepareFunction = (func, callback) ->\n    if typeof func is 'function'\n      callback null, func\n      return\n    try\n      newFunc = Function 'x', func\n    catch e\n      callback e\n      return\n    callback null, newFunc\n\n  c.process (input, output) ->\n    return if input.attached('in').length and not input.hasData 'in'\n    if input.hasData 'function', 'in'\n      # Both function and input data\n      prepareFunction input.getData('function'), (err, func) ->\n        if err\n          output.done e\n          return\n        data = input.getData 'in'\n        try\n          result = func data\n        catch e\n          output.done e\n          return\n        output.sendDone\n          function: func\n          out: result\n        return\n      return\n    return unless input.hasData 'function'\n    prepareFunction input.getData('function'), (err, func) ->\n      if err\n        output.done e\n        return\n      output.sendDone\n        function: func\n      return\n    return\n"},"core/Merge":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'This component receives data on multiple input ports and\n    sends the same data out to the connected output port'\n  c.icon = 'compress'\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be forwarded'\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    data = input.get 'in'\n    output.sendDone\n      out: data\n"},"core/Output":{language:"coffeescript",source:"noflo = require 'noflo'\n\nunless noflo.isBrowser()\n  util = require 'util'\nelse\n  util =\n    inspect: (data) -> data\n\nlog = (options, data) ->\n  if options?\n    console.log util.inspect data,\n      options.showHidden, options.depth, options.colors\n  else\n    console.log data\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Sends the data items to console.log'\n  c.icon = 'bug'\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be printed through console.log'\n  c.inPorts.add 'options',\n    datatype: 'object'\n    description: 'Options to be passed to console.log'\n    control: true\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    return unless input.hasData 'in'\n    return if input.attached('options').length and not input.hasData 'options'\n\n    options = null\n    if input.has 'options'\n      options = input.getData 'options'\n\n    data = input.getData 'in'\n    log options, data\n    output.sendDone\n      out: data\n"},"core/ReadGlobal":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Returns the value of a global variable.'\n  c.icon = 'usd'\n\n  # inPorts\n  c.inPorts.add 'name',\n    description: 'The name of the global variable.'\n\n  # outPorts\n  c.outPorts.add 'value',\n    description: 'The value of the variable.'\n\n  c.outPorts.add 'error',\n    description: 'Any errors that occured reading the variables value.'\n\n  c.forwardBrackets =\n    name: ['value', 'error']\n\n  c.process (input, output) ->\n    return unless input.hasData 'name'\n    data = input.getData 'name'\n\n    value = unless noflo.isBrowser() then global[data] else window[data]\n\n    if typeof value is 'undefined'\n      err = new Error \"\\\"#{data}\\\" is undefined on the global object.\"\n      output.sendDone err\n      return\n    output.sendDone\n      value: value\n"},"core/Repeat":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Forwards packets and metadata in the same way\n  it receives them'\n  c.icon = 'forward'\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to forward'\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    data = input.get 'in'\n    output.sendDone\n      out: data\n"},"core/RepeatAsync":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = \"Like 'Repeat', except repeat on next tick\"\n  c.icon = 'step-forward'\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to forward'\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    data = input.get 'in'\n    setTimeout ->\n      output.sendDone\n        out: data\n    , 0\n"},"core/RepeatDelayed":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Forward packet after a set delay'\n  c.icon = 'clock-o'\n\n  c.timers = []\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be forwarded with a delay'\n  c.inPorts.add 'delay',\n    datatype: 'number'\n    description: 'How much to delay'\n    default: 500\n    control: true\n\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.tearDown = (callback) ->\n    clearTimeout timer for timer in c.timers\n    c.timers = []\n    callback()\n\n  c.process (input, output) ->\n    return unless input.hasData 'in'\n    return if input.attached('delay').length and not input.hasData 'delay'\n\n    delay = 500\n    if input.hasData 'delay'\n      delay = input.getData 'delay'\n    payload = input.get 'in'\n\n    timer = setTimeout ->\n      c.timers.splice c.timers.indexOf(timer), 1\n      output.sendDone\n        out: payload\n    , delay\n    c.timers.push timer\n"},"core/RunInterval":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Send a packet at the given interval'\n  c.icon = 'clock-o'\n  c.inPorts.add 'interval',\n    datatype: 'number'\n    description: 'Interval at which output packets are emitted (ms)'\n    required: true\n    control: true\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start the emission'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n    description: 'Stop the emission'\n  c.outPorts.add 'out',\n    datatype: 'bang'\n\n  c.timers = {}\n\n  cleanUp = (scope) ->\n    return unless c.timers[scope]\n    clearInterval c.timers[scope].interval\n    c.timers[scope].deactivate()\n    c.timers[scope] = null\n\n  c.tearDown = (callback) ->\n    for scope, context of c.timers\n      cleanUp scope\n    c.timers = {}\n    callback()\n\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      return unless input.hasData 'interval'\n      start = input.get 'start'\n      return unless start.type is 'data'\n      interval = parseInt input.getData 'interval'\n      # Ensure we deactivate previous interval in this scope, if any\n      cleanUp start.scope\n\n      # Set up interval\n      context.interval = setInterval ->\n        bang = new noflo.IP 'data', true\n        bang.scope = start.scope\n        c.outPorts.out.sendIP bang\n      , interval\n\n      # Register scope, we keep it active until stopped\n      c.timers[start.scope] = context\n      return\n\n    if input.hasData 'stop'\n      stop = input.get 'stop'\n      return unless stop.type is 'data'\n      # Deactivate interval in this scope\n      cleanUp stop.scope\n      return\n"},"core/RunTimeout":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Send a packet after the given time in ms'\n  c.icon = 'clock-o'\n\n  c.timer = {}\n\n  c.inPorts.add 'time',\n    datatype: 'number'\n    description: 'Time after which a packet will be sent'\n    required: true\n    control: true\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start the timeout before sending a packet'\n  c.outPorts.add 'out',\n    datatype: 'bang'\n\n  c.forwardBrackets =\n    start: ['out']\n\n  c.stopTimer = (scope) ->\n    return unless c.timer[scope]\n    clearTimeout c.timer[scope].timeout\n    c.timer[scope].deactivate()\n    delete c.timer[scope]\n\n  c.tearDown = (callback) ->\n    for scope, timer of c.timer\n      c.stopTimer scope\n    callback()\n\n  c.process (input, output, context) ->\n    return unless input.hasData 'time', 'start'\n    time = input.getData 'time'\n    bang = input.getData 'start'\n    # Ensure we deactivate previous timeout, if any\n    c.stopTimer input.scope\n    # Set up new timer\n    context.timeout = setTimeout ->\n      c.timer = null\n      output.sendDone\n        out: true\n    , time\n    c.timer[input.scope] = context\n    return\n"},"core/SendNext":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Sends next packet in buffer when receiving a bang'\n  c.icon = 'forward'\n\n  c.inPorts.add 'data',\n    datatype: 'all'\n  c.inPorts.add 'in',\n    datatype: 'bang'\n  c.outPorts.add 'out',\n    datatype: 'all'\n  c.outPorts.add 'empty',\n    datatype: 'bang'\n    required: false\n\n  c.forwardBrackets = {}\n  c.process (input, output) ->\n    return unless input.hasData 'in'\n    bang = input.getData 'in'\n\n    unless input.hasData 'data'\n      # No data packets in the buffer, send \"empty\"\n      output.sendDone\n        empty: true\n      return\n\n    sent = false\n    # Loop until we've either drained the buffer completely, or until\n    # we hit the next data packet\n    while input.has 'data'\n      if sent\n        # If we already sent data, we look ahead to see if next packet is data and bail out\n        buf = c.inPorts.data.getBuffer bang.scope\n        break if buf[0].type is 'data'\n\n      packet = input.get 'data'\n      output.send\n        out: packet\n      sent = true if packet.type is 'data'\n    # After the loop we can deactivate\n    output.done()\n"},"core/Split":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.icon = 'expand'\n  c.description = 'This component receives data on a single input port and\n    sends the same data out to all connected output ports'\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be forwarded'\n\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    data = input.get 'in'\n    output.sendDone\n      out: data\n"},"dom/AddClass":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Add a class to an element'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'class',\n    datatype: 'string'\n\n  c.process (input, output) ->\n    return unless input.has 'element', 'class'\n    [element, className] = input.getData 'element', 'class'\n    element.classList.add className\n    output.done()\n"},"dom/AppendChild":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Append elements as children of a parent element'\n  c.inPorts.add 'parent',\n    datatype: 'object'\n  c.inPorts.add 'child',\n    datatype: 'object'\n\n  c.process (input, output) ->\n    return unless input.hasData 'parent', 'child'\n    [parent, child] = input.getData 'parent', 'child'\n    parent.appendChild child\n    output.done()\n"},"dom/CreateElement":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Create a new DOM Element'\n  c.inPorts.add 'tagname',\n    datatype: 'string'\n  c.inPorts.add 'container',\n    datatype: 'object'\n  c.outPorts.add 'element',\n    datatype: 'object'\n  c.forwardBrackets =\n    tagname: ['element']\n\n  c.process (input, output) ->\n    return unless input.hasData 'tagname'\n    if c.inPorts.container.isAttached()\n      # If container is attached, we want it too\n      return unless input.hasData 'container'\n\n    tagname = input.getData 'tagname'\n    element = document.createElement tagname\n    if input.hasData 'container'\n      container = input.getData 'container'\n      container.appendChild element\n\n    output.sendDone\n      element: element\n"},"dom/CreateFragment":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c. description = 'Create a new DOM DocumentFragment'\n  c.inPorts.add 'in',\n    datatype: 'bang'\n  c.outPorts.add 'fragment',\n    datatype: 'object'\n\n  c.forwardBrackets =\n    in: ['fragment']\n\n  c.process (input, output) ->\n    return unless input.hasData 'in'\n    input.getData 'in'\n    fragment = document.createDocumentFragment()\n    output.sendDone\n      fragment: fragment\n"},"dom/GetAttribute":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = \"Reads the given attribute from the DOM element on the in\n    port.\"\n\n  # Define in ports.\n  c.inPorts.add 'element',\n    datatype: 'object'\n    description: 'The element from which to read the attribute from.'\n    required: true\n\n  c.inPorts.add 'attribute',\n    datatype: 'string'\n    description: 'The attribute which is read from the DOM element.'\n    required: true\n    control: true\n\n  # Define out ports.\n  c.outPorts.add 'out',\n    datatype: 'string'\n    description: 'Value of the attribute being read.'\n\n  c.forwardBrackets =\n    element: ['out']\n\n  # On data flow.\n  c.process (input, output) ->\n    return unless input.hasData 'element', 'attribute'\n    [element, attribute] = input.getData 'element', 'attribute'\n    value = element.getAttribute attribute\n    output.sendDone\n      out: value\n"},"dom/GetElement":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description ='Get a DOM element matching a query'\n  c.inPorts.add 'in',\n    datatype: 'object'\n    description: 'DOM element to constrain the query to'\n  c.inPorts.add 'selector',\n    datatype: 'string'\n    description: 'CSS selector'\n  c.outPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'error',\n    datatype: 'object'\n  c.forwardBrackets =\n    selector: ['element', 'error']\n  c.process (input, output) ->\n    return unless input.hasData 'selector'\n    return unless input.hasData 'in' if input.attached('in').length > 0\n    if input.hasData 'in'\n      # Element-scoped selector\n      [container, selector] = input.getData 'in', 'selector'\n      unless typeof container.querySelector is 'function'\n        output.done new Error 'Given container doesn\\'t support querySelectors'\n        return\n      el = container.querySelectorAll selector\n      unless el.length\n        output.done new Error \"No element matching '#{selector}' found under container\"\n        return\n      for element in el\n        output.send\n          element: element\n      output.done()\n      return\n    selector = input.getData 'selector'\n    el = document.querySelectorAll selector\n    unless el.length\n      output.done new Error \"No element matching '#{selector}' found under document\"\n      return\n    for element in el\n      output.send\n        element: element\n    output.done()\n"},"dom/HasClass":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Check if an element has a given class'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'class',\n    datatype: 'string'\n  c.outPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'missed',\n    datatype: 'object'\n  c.process (input, output) ->\n    return unless input.hasData 'element', 'class'\n    [element, klass] = input.getData 'element', 'class'\n    if element.classList.contains klass\n      output.sendDone\n        element: element\n      return\n    output.sendDone\n      missed: element\n"},"dom/Listen":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'addEventListener for specified event type'\n  c.icon = 'stethoscope'\n\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'type',\n    datatype: 'string'\n  c.inPorts.add 'preventdefault',\n    datatype: 'boolean'\n    control: true\n    default: false\n  c.outPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'event',\n    datatype: 'object'\n\n  c.elements = {}\n  cleanUp = (scope) ->\n    return unless c.elements[scope]\n    {element, event, listener} = c.elements[scope]\n    element.removeEventListener event, listener\n    c.elements[scope].deactivate()\n    delete c.elements[scope]\n  c.tearDown = (callback) ->\n    for scope, element of c.elements\n      cleanUp scope\n    c.elements = {}\n    callback()\n  c.forwardBrackets = {}\n\n  c.process (input, output, context) ->\n\n    return unless input.hasData 'element', 'type'\n    [element, type] = input.getData 'element', 'type'\n\n    preventDefault = false\n    if input.hasData 'preventdefault'\n      preventDefault = input.getData 'preventdefault'\n\n    scope = null\n    cleanUp scope\n\n    context.element = element\n    context.event = type\n    context.listener = (event) ->\n      event.preventDefault() if preventDefault\n      output.send\n        element: context.element\n        event: event\n    c.elements[context] = context\n    element.addEventListener type, context.listener\n"},"dom/ReadHtml":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Read HTML from an existing element'\n  c.inPorts.add 'container',\n    datatype: 'object'\n  c.outPorts.add 'html',\n    datatype: 'string'\n  c.forwardBrackets =\n    container: ['html']\n  c.process (input, output) ->\n    return unless input.hasData 'container'\n    container = input.getData 'container'\n    output.sendDone\n      html: container.innerHTML\n"},"dom/RemoveClass":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Remove a class from an element'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'class',\n    datatype: 'string'\n\n  c.process (input, output) ->\n    return unless input.has 'element', 'class'\n    [element, className] = input.getData 'element', 'class'\n    element.classList.remove className\n    output.done()\n"},"dom/RemoveElement":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Remove an element from DOM'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.process (input, output) ->\n    return unless input.hasData 'element'\n    element = input.getData 'element'\n    return unless element.parentNode\n    element.parentNode.removeChild element\n    output.done()\n"},"dom/RequestAnimationFrame":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nrequestAnimationFrame =\n  window.requestAnimationFrame       ||\n  window.webkitRequestAnimationFrame ||\n  window.mozRequestAnimationFrame    ||\n  window.oRequestAnimationFrame      ||\n  window.msRequestAnimationFrame     ||\n  (callback, element) ->\n    window.setTimeout( ->\n      callback(+new Date())\n    , 1000 / 60)\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Sends bangs that correspond with screen refresh rate.'\n  c.icon = 'film'\n\n  c.inPorts.add 'start',\n    datatype: 'bang'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n  c.outPorts.add 'out',\n    datatype: 'bang'\n\n  c.running = {}\n  cleanUp = (scope) ->\n    return unless c.running[scope]\n    c.running[scope].deactivate()\n    delete c.running[scope]\n  c.tearDown = (callback) ->\n    for scope, running of c.running\n      cleanUp scope\n    c.running = {}\n    callback()\n  c.animate = (scope, output) ->\n    # Stop when context has been stopped\n    return unless c.running[scope]\n    # Send bang\n    output.send true\n    # Request next frame\n    requestAnimationFrame c.animate.bind c, scope, output\n\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      start = input.get 'start'\n      return unless start.type is 'data'\n      # Ensure previous was deactivated\n      cleanUp start.scope\n\n      # Register scope\n      c.running[start.scope] = context\n\n      # Request first frame\n      requestAnimationFrame c.animate.bind c, start.scope, output\n      return\n\n    if input.hasData 'stop'\n      stop = input.get 'stop'\n      return unless stop.type is 'data'\n      # Deactivate this scope\n      cleanUp stop.scope\n      return\n"},"dom/SetAttribute":{language:"coffeescript",source:"'use strict'\n\n# @runtime noflo-browser\n\nnoflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = \"Set the given attribute on the DOM element to the received\n    value.\"\n    \n  # Define in ports.\n  c.inPorts.add 'element',\n    datatype: 'object'\n    description: 'The element on which to set the attribute.'\n\n  c.inPorts.add 'attribute',\n    datatype: 'string'\n    description: 'The attribute which is set on the DOM element.'\n\n  c.inPorts.add 'value',\n    datatype: 'string'\n    description: 'Value of the attribute being set.'\n  \n  # Define out ports.\n  c.outPorts.add 'element',\n    datatype: 'object'\n    description: 'The element that was updated.'\n\n  c.forwardBrackets =\n    element: ['element']\n    value: ['element']\n\n  c.process (input, output) ->\n    return unless input.hasData 'element', 'attribute', 'value'\n    [element, attribute, value] = input.getData 'element', 'attribute', 'value'\n    if typeof value is 'object'\n      if toString.call(value) is '[object Array]'\n        value = value.join ' '\n      else\n        newVal = []\n        newVal.push val for key, val of value\n        value = newVal.join ' '\n    if attribute is \"value\"\n      element.value = value\n    else\n      element.setAttribute attribute, value\n\n    output.sendDone\n      element: element\n"},"dom/WriteHtml":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Write HTML inside an existing element'\n  c.inPorts.add 'container',\n    datatype: 'object'\n  c.inPorts.add 'html',\n    datatype: 'string'\n  c.outPorts.add 'container',\n    datatype: 'object'\n  c.process (input, output) ->\n    return unless input.hasData 'container', 'html'\n    [container, html] = input.getData 'container', 'html'\n    container.innerHTML = html\n    output.sendDone\n      container: container\n"},"interaction/Focus":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.icon = 'i-cursor'\n  c.description = 'focus element'\n  c.inPorts.add 'element',\n    datatype: 'object'\n    description: 'element to be focused'\n    control: true\n  c.inPorts.add 'trigger',\n    datatype: 'bang'\n    description: 'trigger focus'\n  c.outPorts.add 'out',\n    datatype: 'bang'\n  c.process (input, output) ->\n    return unless input.hasData 'element', 'trigger'\n    element = input.getData 'element'\n    input.getData 'trigger'\n    window.setTimeout ->\n      element.focus()\n      output.sendDone\n        out: true\n    , 0\n"},"interaction/ListenChange":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen to changes on an input element'\n  c.icon = 'hourglass'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'value',\n    datatype: 'object'\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      element.el.removeEventListener 'change', element.listener, false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element'\n    data =\n      el: input.getData 'element'\n      listener: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        output.send\n          value: event.target.value\n      ctx: context\n    data.el.addEventListener 'change', data.listener, false\n    c.elements.push data\n    return\n"},"interaction/ListenDrag":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description =  'Listen to drag events on a DOM element'\n  c.icon = 'arrows'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'start',\n    datatype: 'object'\n  c.outPorts.add 'movey',\n    datatype: 'number'\n  c.outPorts.add 'movex',\n    datatype: 'number'\n  c.outPorts.add 'end',\n    datatype: 'object'\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      element.el.removeEventListener 'dragstart', element.dragstart, false\n      element.el.removeEventListener 'drag', element.dragmove, false\n      element.el.removeEventListener 'dragend', element.dragend, false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element'\n    data =\n      el: input.getData 'element'\n      dragstart: (event) ->\n        event.stopPropagation()\n        output.send\n          start: event\n      dragmove: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        output.send\n          movex: event.clientX\n          movey: event.clientY\n      dragend: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        output.send\n          end: event\n      ctx: context\n    data.el.addEventListener 'dragstart', data.dragstart, false\n    data.el.addEventListener 'drag', data.dragmove, false\n    data.el.addEventListener 'dragend', data.dragend, false\n    c.elements.push data\n    return\n"},"interaction/ListenHash":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen for hash changes in browser\\'s URL bar'\n  c.icon = 'slack'\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start listening for hash changes'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n    description: 'Stop listening for hash changes'\n  c.outPorts.add 'initial',\n    datatype: 'string'\n  c.outPorts.add 'change',\n    datatype: 'string'\n  c.current = null\n  c.subscriber = null\n  unsubscribe = ->\n    return unless c.subscriber\n    window.removeEventListener 'hashchange', c.subscriber.callback, false\n    c.subscriber.ctx.deactivate()\n    c.subscriber = null\n  c.tearDown = (callback) ->\n    c.current = null\n    do unsubscribe\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      input.getData 'start'\n      # Ensure previous subscription is ended\n      do unsubscribe\n      sendHash = (port) ->\n        oldHash = c.current\n        c.current = window.location.href.split('#')[1] or ''\n        if oldHash\n          output.send\n            change: new noflo.IP 'openBracket', oldHash\n        payload = {}\n        payload[port] = c.current\n        output.send payload\n        if oldHash\n          output.send\n            change: new noflo.IP 'closeBracket', oldHash\n      c.subscriber =\n        callback: (event) ->\n          sendHash 'change'\n        ctx: context\n      # Send initial\n      sendHash 'initial'\n      window.addEventListener 'hashchange', c.subscriber.callback, false\n      return\n    if input.hasData 'stop'\n      input.getData 'stop'\n      do unsubscribe\n      output.done()\n      return\n"},"interaction/ListenKeyboard":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen for key presses on a given DOM element'\n  c.icon = 'keyboard-o'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'stop',\n    datatype: 'object'\n  c.outPorts.add 'keypress',\n    datatype: 'integer'\n  c.elements = []\n  unsubcribe = (element) ->\n    element.el.removeEventListener 'keypress', element.listener, false\n    element.ctx.deactivate()\n  c.tearDown = (callback) ->\n    unsubscribe element for element in c.elements\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'element'\n      data =\n        el: input.getData 'element'\n        listener: (event) ->\n          output.send\n            keypress: event.keyCode\n        ctx: context\n      data.el.addEventListener 'keypress', data.listener, false\n      c.elements.push data\n      return\n    if input.hasData 'stop'\n      element = input.getData 'stop'\n      ctx = null\n      for el in c.elements\n        continue unless el.el is element\n        ctx = el\n      return unless ctx\n      unsubscribe ctx\n      output.done()\n"},"interaction/ListenKeyboardShortcuts":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen for keyboard shortcuts and route them'\n  c.icon = 'keyboard-o'\n  c.inPorts.add 'keys',\n    datatype: 'array'\n  c.inPorts.add 'ignoreinput',\n    datatype: 'boolean'\n    default: true\n    control: true\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n  c.outPorts.add 'shortcut',\n    datatype: 'bang'\n    addressable: true\n  c.outPorts.add 'missed',\n    datatype: 'integer'\n  c.subscriber = null\n  unsubscribe = ->\n    return unless c.subscriber\n    document.removeEventListener 'keydown', c.subscriber.callback, false\n    c.subscriber.ctx.deactivate()\n    c.subscriber = null\n  c.tearDown = (callback) ->\n    do unsubscribe\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'keys'\n      keys = input.getData 'keys'\n\n      # Ensure previous subscription is ended\n      do unsubscribe\n\n      # Older version of this component used string input\n      keys = keys.split ',' if typeof keys is 'string'\n\n      # We allow some common keyboard shortcuts to be passed as strings\n      for key, index in keys\n        switch key\n          when '-' then keys[index] = 189\n          when '=' then keys[index] = 187\n          when '0' then keys[index] = 48\n          when 'a' then keys[index] = 65\n          when 'x' then keys[index] = 88\n          when 'c' then keys[index] = 67\n          when 'v' then keys[index] = 86\n          when 'z' then keys[index] = 90\n          when 'r' then keys[index] = 82\n\n      ignoreInput = if input.hasData('ignoreinput') then input.getData('ignoreinput') else true\n\n      c.subscriber =\n        callback: (event) ->\n          return unless event.ctrlKey or event.metaKey\n          return if event.target.tagName is 'TEXTAREA' and ignoreInput\n          return if event.target.tagName is 'INPUT' and ignoreInput\n          return if String(event.target.contentEditable) is 'true' and ignoreInput\n          route = keys.indexOf event.keyCode\n          if route is -1\n            output.send\n              missed: event.keyCode\n            return\n          event.preventDefault()\n          event.stopPropagation()\n          output.send\n            shortcut: new noflo.IP 'data', event.keyCode,\n              index: route\n        ctx: context\n      document.addEventListener 'keydown', c.subscriber.callback, false\n      return\n    if input.hasData 'stop'\n      input.getData 'stop'\n      do unsubscribe\n      output.done()\n      return\n"},"interaction/ListenMouse":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.icon = 'mouse-pointer'\n  c.description = 'Listen to mouse events on a DOM element'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'click',\n    datatype: 'object'\n  c.outPorts.add 'dblclick',\n    datatype: 'object'\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      element.el.removeEventListener 'click', element.click, false\n      element.el.removeEventListener 'dblclick', element.dblclick, false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element'\n    data =\n      el: input.getData 'element'\n      click: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        output.send\n          click: event\n      dblclick: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        output.send\n          dblclick: event\n      ctx: context\n    data.el.addEventListener 'click', data.click, false\n    data.el.addEventListener 'dblclick', data.dblclick, false\n    c.elements.push data\n    return\n"},"interaction/ListenPointer":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen to pointer events on a DOM element'\n  c.icon = 'pencil-square-o'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'action',\n    datatype: 'string'\n    default: 'none'\n    control: true\n  events = [\n    'down'\n    'up'\n    'cancel'\n    'move'\n    'over'\n    'out'\n    'enter'\n    'leave'\n  ]\n  for event in events\n    c.outPorts.add event,\n      datatype: 'object'\n      description: \"Sends event on pointer#{event}\"\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      if element.el.removeAttribute\n        element.el.removeAttribute 'touch-action'\n      for event in events\n        element.el.removeEventListener \"pointer#{event}\", element[\"pointer#{event}\"], false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element'\n    action = if input.hasData('action') then input.getData('action') else 'none'\n    data =\n      el: input.getData 'element'\n      ctx: context\n    data.el.setAttribute 'touch-action', action\n    events.forEach (event) ->\n      data[\"pointer#{event}\"] = (ev) ->\n        ev.preventDefault()\n        ev.stopPropagation()\n        payload = {}\n        payload[event] = ev.target.value\n        output.send payload\n      data.el.addEventListener \"pointer#{event}\", data[\"pointer#{event}\"], false\n    c.elements.push data\n    return\n"},"interaction/ListenResize":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen to window resize events'\n  c.icon = 'desktop'\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start listening for screen resizes'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n    description: 'Stop listening for screen resizes'\n  c.outPorts.add 'width',\n    datatype: 'number'\n  c.outPorts.add 'height',\n    datatype: 'number'\n  c.subscriber = null\n  unsubscribe = ->\n    return unless c.subscriber\n    window.removeEventListener 'resize', c.subscriber.callback, false\n    c.subscriber.ctx.deactivate()\n    c.subscriber = null\n  c.tearDown = (callback) ->\n    do unsubscribe\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      input.getData 'start'\n      # Ensure previous subscription is ended\n      do unsubscribe\n      c.subscriber =\n        callback: (event) ->\n          output.send\n            width: window.innerWidth\n            height: window.innerHeight\n        ctx: context\n      output.send\n        width: window.innerWidth\n        height: window.innerHeight\n      window.addEventListener 'resize', c.subscriber.callback, false\n      return\n    if input.hasData 'stop'\n      input.getData 'stop'\n      do unsubscribe\n      output.done()\n      return\n"},"interaction/ListenScroll":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen to scroll events on the browser window'\n  c.icon = 'arrows-v'\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start listening for hash changes'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n    description: 'Stop listening for hash changes'\n  c.outPorts.add 'top',\n    datatype: 'number'\n  c.outPorts.add 'bottom',\n    datatype: 'number'\n  c.outPorts.add 'left',\n    datatype: 'number'\n  c.outPorts.add 'right',\n    datatype: 'number'\n  c.subscriber = null\n  unsubscribe = ->\n    return unless c.subscriber\n    window.removeEventListener 'scroll', c.subscriber.callback, false\n    c.subscriber.ctx.deactivate()\n    c.subscriber = null\n  c.tearDown = (callback) ->\n    do unsubscribe\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      input.getData 'start'\n      # Ensure previous subscription is ended\n      do unsubscribe\n      c.subscriber =\n        callback: (event) ->\n          top = window.scrollY\n          left = window.scrollX\n          output.send\n            top: top\n            bottom: top + window.innerHeight\n            left: left\n            right: left.window.innerWidth\n        ctx: context\n      window.addEventListener 'scroll', c.subscriber.callback, false\n      return\n    if input.hasData 'stop'\n      input.getData 'stop'\n      do unsubscribe\n      output.done()\n      return\n"},"interaction/ListenSpeech":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen for user\\'s microphone and recognize phrases'\n  c.icon = 'microphone'\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start listening for hash changes'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n    description: 'Stop listening for hash changes'\n  c.outPorts.add 'result',\n    datatype: 'string'\n  c.outPorts.add 'error',\n    datatype: 'object'\n  c.subscriber = null\n  unsubscribe = ->\n    return unless c.subscriber\n    do c.subscriber.recognition.stop\n    do c.subscriber.ctx.deactivate\n    c.subscriber = null\n  c.tearDown = (callback) ->\n    do unsubscribe\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      input.getData 'start'\n      # Ensure previous subscription is ended\n      do unsubscribe\n      unless window.webkitSpeechRecognition\n        output.done new Error 'Speech recognition support not available'\n        return\n      c.subscriber =\n        sent: []\n        callback: (event) ->\n          for result, idx in event.results\n            continue unless result.isFinal\n            if c.subscriber.sent.indexOf(idx) isnt -1\n              continue\n            output.send\n              result: result[0].transcript\n            c.subscriber.sent.push idx\n        error: (err) ->\n          output.send\n            error: err\n        ctx: context\n      c.subscriber.recognition = new window.webkitSpeechRecognition\n      c.subscriber.recognition.continuous = true\n      c.subscriber.recognition.start()\n      c.subscriber.recognition.onresult = c.subscriber.callback\n      c.subscriber.recognition.onerror = c.subscriber.error\n      return\n    if input.hasData 'stop'\n      input.getData 'stop'\n      do unsubscribe\n      output.done()\n      return\n"},"interaction/ListenTouch":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen to touch events on a DOM element'\n  c.icon = 'hand-o-up'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'start',\n    datatype: 'object'\n  c.outPorts.add 'movex',\n    datatype: 'number'\n  c.outPorts.add 'movey',\n    datatype: 'number'\n  c.outPorts.add 'end',\n    datatype: 'object'\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      element.el.removeEventListener 'touchstart', element.touchstart, false\n      element.el.removeEventListener 'touchmove', element.touchmove, false\n      element.el.removeEventListener 'touchend', element.touchend, false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element'\n    data =\n      el: input.getData 'element'\n      touchstart: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        return unless event.changedTouches\n        return unless event.changedTouches.length\n        for touch, idx in event.changedTouches\n          output.send\n            start: new noflo.IP 'data', event,\n              touch: idx\n      touchmove: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        return unless event.changedTouches\n        return unless event.changedTouches.length\n        for touch, idx in event.changedTouches\n          output.send\n            movex: new noflo.IP 'data', touch.pageX,\n              touch: idx\n            movey: new noflo.IP 'data', touch.pageY,\n              touch: idx\n      touchend: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        return unless event.changedTouches\n        return unless event.changedTouches.length\n        for touch, idx in event.changedTouches\n          output.send\n            end: new noflo.IP 'data', event,\n              touch: idx\n      ctx: context\n    data.el.addEventListener 'touchstart', data.touchstart, false\n    data.el.addEventListener 'touchmove', data.touchmove, false\n    data.el.addEventListener 'touchend', data.touchend, false\n    c.elements.push data\n    return\n"},"interaction/ReadCoordinates":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Read the coordinates from a DOM event'\n  c.icon = 'map-marker'\n  c.inPorts.add 'event',\n    datatype: 'object'\n  c.outPorts.add 'screen',\n    datatype: 'object'\n  c.outPorts.add 'client',\n    datatype: 'object'\n  c.outPorts.add 'page',\n    datatype: 'object'\n  c.forwardBrackets =\n    event: ['screen', 'client', 'page']\n  c.process (input, output) ->\n    return unless input.hasData 'event'\n    event = input.getData 'event'\n    output.sendDone\n      screen:\n        x: event.screenX\n        y: event.screenY\n      client:\n        x: event.clientX\n        y: event.clientY\n      page:\n        x: event.pageX\n        y: event.pageY\n"},"interaction/ReadGamepad":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Read the state of a gamepad'\n  c.icon = 'gamepad'\n  c.inPorts.add 'gamepad',\n    datatype: 'integer'\n  c.outPorts.add 'out',\n    datatype: 'object'\n  c.outPorts.add 'error',\n    datatype: 'object'\n  c.lastTimestamps = {}\n  c.tearDown = (callback) ->\n    c.lastTimestamps = {}\n    do callback\n  c.process (input, output) ->\n    return unless input.hasData 'gamepad'\n    gamepad = input.getData 'gamepad'\n    unless navigator.webkitGetGamepads\n      output.done new Error \"No WebKit Gamepad API available\"\n      return\n    gamepadState = navigator.webkitGetGamepads()[gamepad]\n    unless gamepadState\n      output.done new Error \"Gamepad '#{gamepad}' not available\"\n    if c.lastTimestamps[gamepad] = gamepadState.timestamp\n      # No change\n      output.done()\n      return\n    c.lastTimestamps[gamepad] = gamepadState.timestamp\n    output.sendDone\n      out: gamepadState\n"},"interaction/SetHash":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Set the hash in browser\\'s URL bar'\n  c.icon = 'slack'\n  c.inPorts.add 'hash',\n    datatype: 'string'\n  c.outPorts.add 'out',\n    datatype: 'string'\n  c.process (input, output) ->\n    return unless input.hasData 'hash'\n    hash = input.getData 'hash'\n    window.location.hash = \"##{hash}\"\n    output.sendDone\n      out: hash\n"}};exports.setSource=function(loader,packageId,name,source,language,callback){var implementation,originalSource=source;if("coffeescript"===language){if(!window.CoffeeScript)return callback(new Error("CoffeeScript compiler not available"));try{source=window.CoffeeScript.compile(source,{bare:!0})}catch(t){return callback(t)}}if("es6"===language||"es2015"===language){if(!window.babel)return callback(new Error("Babel compiler not available"));try{source=window.babel.transform(source).code}catch(t){return callback(t)}}try{var withExports="(function () { var exports = {}; "+source+"; return exports; })();";implementation=eval(withExports)}catch(t){return callback(t)}if(!implementation&&!implementation.getComponent)return callback(new Error("Provided source failed to create a runnable component"));var fullName=packageId+"/"+name;sources[fullName]={language:language,source:originalSource},loader.registerComponent(packageId,name,implementation,callback)},exports.getSource=function(t,e,n){if(!t.components[e])return n(new Error("Component "+e+" not available"));var r=t.components[e],o=e.split("/"),i={name:o[1],library:o[0]};return t.isGraph(r)?(i.code=JSON.stringify(r,null,2),i.language="json",n(null,i)):sources[e]?(i.code=sources[e].source,i.language=sources[e].language,n(null,i)):"function"==typeof r?(i.code=r.toString(),i.language="javascript",n(null,i)):"function"==typeof r.getComponent?(i.code=r.getComponent.toString(),i.language="javascript",n(null,i)):n(new Error("Unable to get sources for "+e))},exports.register=function(t,e){var n=[];if(t.setLibraryIcon("dom","html5"),t.registerComponent("browser-app","DoSomething",__webpack_require__(36)),t.registerComponent("browser-app","main",__webpack_require__(37)),t.registerComponent(null,"Graph",__webpack_require__(38)),t.registerComponent("core","Callback",__webpack_require__(39)),t.registerComponent("core","Copy",__webpack_require__(40)),t.registerComponent("core","DisconnectAfterPacket",__webpack_require__(42)),t.registerComponent("core","Drop",__webpack_require__(43)),t.registerComponent("core","Kick",__webpack_require__(44)),t.registerComponent("core","MakeFunction",__webpack_require__(45)),t.registerComponent("core","Merge",__webpack_require__(46)),t.registerComponent("core","Output",__webpack_require__(47)),t.registerComponent("core","ReadGlobal",__webpack_require__(50)),t.registerComponent("core","Repeat",__webpack_require__(51)),t.registerComponent("core","RepeatAsync",__webpack_require__(52)),t.registerComponent("core","RepeatDelayed",__webpack_require__(53)),t.registerComponent("core","RunInterval",__webpack_require__(54)),t.registerComponent("core","RunTimeout",__webpack_require__(55)),t.registerComponent("core","SendNext",__webpack_require__(56)),t.registerComponent("core","Split",__webpack_require__(57)),t.registerComponent("dom","AddClass",__webpack_require__(58)),t.registerComponent("dom","AppendChild",__webpack_require__(59)),t.registerComponent("dom","CreateElement",__webpack_require__(60)),t.registerComponent("dom","CreateFragment",__webpack_require__(61)),t.registerComponent("dom","GetAttribute",__webpack_require__(62)),t.registerComponent("dom","GetElement",__webpack_require__(63)),t.registerComponent("dom","HasClass",__webpack_require__(64)),t.registerComponent("dom","Listen",__webpack_require__(65)),t.registerComponent("dom","ReadHtml",__webpack_require__(66)),t.registerComponent("dom","RemoveClass",__webpack_require__(67)),t.registerComponent("dom","RemoveElement",__webpack_require__(68)),t.registerComponent("dom","RequestAnimationFrame",__webpack_require__(69)),t.registerComponent("dom","SetAttribute",__webpack_require__(70)),t.registerComponent("dom","WriteHtml",__webpack_require__(71)),t.registerComponent("interaction","Focus",__webpack_require__(72)),t.registerComponent("interaction","ListenChange",__webpack_require__(73)),t.registerComponent("interaction","ListenDrag",__webpack_require__(74)),t.registerComponent("interaction","ListenHash",__webpack_require__(75)),t.registerComponent("interaction","ListenKeyboard",__webpack_require__(76)),t.registerComponent("interaction","ListenKeyboardShortcuts",__webpack_require__(77)),t.registerComponent("interaction","ListenMouse",__webpack_require__(78)),t.registerComponent("interaction","ListenPointer",__webpack_require__(79)),t.registerComponent("interaction","ListenResize",__webpack_require__(80)),t.registerComponent("interaction","ListenScroll",__webpack_require__(81)),t.registerComponent("interaction","ListenSpeech",__webpack_require__(82)),t.registerComponent("interaction","ListenTouch",__webpack_require__(83)),t.registerComponent("interaction","ReadCoordinates",__webpack_require__(84)),t.registerComponent("interaction","ReadGamepad",__webpack_require__(85)),t.registerComponent("interaction","SetHash",__webpack_require__(86)),!n.length)return e();registerCustomLoaders(t,n,e)}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.icon="cog",t.description="do X",t.inPorts.add("in",{datatype:"string"}),t.outPorts.add("out",{datatype:"string"}),t.process(function(t,e){var n;if(t.hasData("in"))return n=t.getData("in"),e.send({out:n}),e.done()})}},function(t,e){t.exports={properties:{name:"main",environment:{type:"noflo-browser",content:"<button id='button'>Go!</button>\n<p id='message'></p>"},icon:""},inports:{},outports:{},groups:[],processes:{"dom/GetElement_7amk2":{component:"dom/GetElement",metadata:{label:"dom/GetElement",x:252,y:180,width:72,height:72}},"core/Output_cg49":{component:"core/Output",metadata:{label:"core/Output",x:432,y:360,width:72,height:72}},"dom/WriteHtml_fpz6j":{component:"dom/WriteHtml",metadata:{label:"dom/WriteHtml",x:684,y:288,width:72,height:72}},"dom/GetElement_xvz54":{component:"dom/GetElement",metadata:{label:"dom/GetElement",x:252,y:288,width:72,height:72}},"interaction/ListenMouse_1l373":{component:"interaction/ListenMouse",metadata:{label:"interaction/ListenMouse",x:432,y:180,width:72,height:72}},"core/Kick_ey1nh":{component:"core/Kick",metadata:{label:"core/Kick",x:576,y:180,width:72,height:72}}},connections:[{src:{process:"dom/GetElement_xvz54",port:"element"},tgt:{process:"dom/WriteHtml_fpz6j",port:"container"},metadata:{}},{src:{process:"dom/GetElement_7amk2",port:"element"},tgt:{process:"interaction/ListenMouse_1l373",port:"element"},metadata:{route:0}},{src:{process:"dom/GetElement_7amk2",port:"error"},tgt:{process:"core/Output_cg49",port:"in"},metadata:{route:1}},{src:{process:"dom/GetElement_xvz54",port:"error"},tgt:{process:"core/Output_cg49",port:"in"},metadata:{route:1}},{src:{process:"interaction/ListenMouse_1l373",port:"click"},tgt:{process:"core/Kick_ey1nh",port:"in"},metadata:{}},{src:{process:"core/Kick_ey1nh",port:"out"},tgt:{process:"dom/WriteHtml_fpz6j",port:"html"},metadata:{}},{data:"#button",tgt:{process:"dom/GetElement_7amk2",port:"selector"}},{data:"#message",tgt:{process:"dom/GetElement_xvz54",port:"selector"}},{data:"Hello World!",tgt:{process:"core/Kick_ey1nh",port:"data"}}]}},function(t,e,n){(function(t){(function(){var r,o,i=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;o=n(0),r=function(e){function n(t){this.metadata=t,this.network=null,this.ready=!0,this.started=!1,this.starting=!1,this.baseDir=null,this.loader=null,this.load=0,this.inPorts=new o.InPorts({graph:{datatype:"all",description:"NoFlo graph definition to be used with the subgraph component",required:!0}}),this.outPorts=new o.OutPorts,this.inPorts.graph.on("ip",function(t){return function(e){if("data"===e.type)return t.setGraph(e.data,function(e){if(e)return t.error(e)})}}(this))}return i(n,e),n.prototype.setGraph=function(e,n){return this.ready=!1,"object"==typeof e?"function"==typeof e.addNode?void this.createNetwork(e,n):void o.graph.loadJSON(e,function(t){return function(e,r){return e?n(e):(r.baseDir=t.baseDir,t.createNetwork(r,n))}}(this)):("/"!==e.substr(0,1)&&":"!==e.substr(1,1)&&t&&t.cwd&&(e=t.cwd()+"/"+e),o.graph.loadFile(e,function(t){return function(e,r){return e?n(e):(r.baseDir=t.baseDir,t.createNetwork(r,n))}}(this)))},n.prototype.createNetwork=function(t,e){return this.description=t.properties.description||"",this.icon=t.properties.icon||this.icon,t.name||(t.name=this.nodeId),t.componentLoader=this.loader,o.createNetwork(t,function(t){return function(n,r){return t.network=r,n?e(n):(t.emit("network",t.network),t.subscribeNetwork(t.network),t.network.connect(function(n){var r,o,i;if(n)return e(n);i=t.network.processes;for(r in i)o=i[r],t.findEdgePorts(r,o);return t.setToReady(),e()}))}}(this),!0)},n.prototype.subscribeNetwork=function(t){var e;return e=[],this.network.on("start",function(t){return function(){var n;return n={},e.push(n),t.activate(n)}}(this)),this.network.on("end",function(t){return function(){var n;if(n=e.pop())return t.deactivate(n)}}(this))},n.prototype.isExportedInport=function(t,e,n){var r,o,i,s,a,u,c;u=this.network.graph.inports;for(a in u)if((s=u[a]).process===e&&s.port===n)return a;for(o=0,i=(c=this.network.graph.exports).length;o<i;o++)if((r=c[o]).process===e&&r.port===n)return this.network.graph.checkTransactionStart(),this.network.graph.removeExport(r.public),this.network.graph.addInport(r.public,r.process,r.port,r.metadata),this.network.graph.checkTransactionEnd(),r.public;return!1},n.prototype.isExportedOutport=function(t,e,n){var r,o,i,s,a,u,c;u=this.network.graph.outports;for(a in u)if((s=u[a]).process===e&&s.port===n)return a;for(o=0,i=(c=this.network.graph.exports).length;o<i;o++)if((r=c[o]).process===e&&r.port===n)return this.network.graph.checkTransactionStart(),this.network.graph.removeExport(r.public),this.network.graph.addOutport(r.public,r.process,r.port,r.metadata),this.network.graph.checkTransactionEnd(),r.public;return!1},n.prototype.setToReady=function(){return void 0!==t&&t.execPath&&-1!==t.execPath.indexOf("node")?t.nextTick(function(t){return function(){return t.ready=!0,t.emit("ready")}}(this)):setTimeout(function(t){return function(){return t.ready=!0,t.emit("ready")}}(this),0)},n.prototype.findEdgePorts=function(t,e){var n,r,o,i,s;n=e.component.inPorts.ports||e.component.inPorts,r=e.component.outPorts.ports||e.component.outPorts;for(i in n)o=n[i],!1!==(s=this.isExportedInport(o,t,i))&&(this.inPorts.add(s,o),this.inPorts[s].once("connect",function(t){return function(){if(!t.starting&&!t.isStarted())return t.start(function(){})}}(this)));for(i in r)o=r[i],!1!==(s=this.isExportedOutport(o,t,i))&&this.outPorts.add(s,o);return!0},n.prototype.isReady=function(){return this.ready},n.prototype.isSubgraph=function(){return!0},n.prototype.setUp=function(t){this.starting=!0;{if(this.isReady())return this.network?this.network.start(function(e){return e?t(e):(this.starting=!1,t())}):t(null);this.once("ready",function(e){return function(){return e.setUp(t)}}(this))}},n.prototype.tearDown=function(t){return this.starting=!1,this.network?this.network.stop(function(e){return e?t(e):t()}):t(null)},n}(o.Component),e.getComponent=function(t){return new r(t)}}).call(this)}).call(e,n(1))},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="This component calls a given callback function for each IP it receives.  The Callback component is typically used to connect NoFlo with external Node.js code.",t.icon="sign-out",t.inPorts.add("in",{description:"Object passed as argument of the callback",datatype:"all"}),t.inPorts.add("callback",{description:"Callback to invoke",datatype:"function",control:!0,required:!0}),t.outPorts.add("error",{datatype:"object"}),t.process(function(t,e){var n,r,o,i;if(t.hasData("callback","in")){if(i=t.getData("callback","in"),n=i[0],r=i[1],"function"==typeof n){try{n(r)}catch(t){return o=t,e.done(o)}return e.done()}e.done(new Error("The provided callback must be a function"))}})}},function(t,e,n){var r,o;r=n(0),o=n(41),e.getComponent=function(){var t;return t=new r.Component,t.description="deep (i.e. recursively) copy an object",t.icon="copy",t.inPorts.add("in",{datatype:"all",description:"Packet to be copied"}),t.outPorts.add("out",{datatype:"all",description:"Copy of the original packet"}),t.process(function(t,e){var n,r;t.hasData("in")&&(r=t.getData("in"),n=o.deepCopy(r),e.sendDone({out:n}))})}},function(t,e,n){function r(){}function o(t){return"object"==typeof t?(r.prototype=t,new r):t}function i(t){for(var e in t)this[e]=t[e]}function s(){this.copiedObjects=[];var t=this;this.recursiveDeepCopy=function(e){return t.deepCopy(e)},this.depth=0}function a(t,e){var n=new s;return e&&(n.maxDepth=e),n.deepCopy(t)}var u=[];i.prototype={constructor:i,canCopy:function(t){return!1},create:function(t){},populate:function(t,e,n){}},s.prototype={constructor:s,maxDepth:256,cacheResult:function(t,e){this.copiedObjects.push([t,e])},getCachedResult:function(t){for(var e=this.copiedObjects,n=e.length,r=0;r<n;r++)if(e[r][0]===t)return e[r][1]},deepCopy:function(t){if(null===t)return null;if("object"!=typeof t)return t;var e=this.getCachedResult(t);if(e)return e;for(var n=0;n<u.length;n++){var r=u[n];if(r.canCopy(t))return this.applyDeepCopier(r,t)}throw new Error("no DeepCopier is able to copy "+t)},applyDeepCopier:function(t,e){var n=t.create(e);if(this.cacheResult(e,n),++this.depth>this.maxDepth)throw new Error("Exceeded max recursion depth in deep copy.");return t.populate(this.recursiveDeepCopy,e,n),this.depth--,n}},a.DeepCopier=i,a.deepCopiers=u,a.register=function(t){t instanceof i||(t=new i(t)),u.unshift(t)},a.register({canCopy:function(t){return!0},create:function(t){return t.hasOwnProperty&&t instanceof t.constructor?o(t.constructor.prototype):{}},populate:function(t,e,n){for(var r in e)e.hasOwnProperty&&e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}}),a.register({canCopy:function(t){return t instanceof Array},create:function(t){return new t.constructor},populate:function(t,e,n){for(var r=0;r<e.length;r++)n.push(t(e[r]));return n}}),a.register({canCopy:function(t){return t instanceof Date},create:function(t){return new Date(t)}});var c=n(2).EventEmitter;a.register({canCopy:function(t){return t instanceof c},create:function(t){return t.hasOwnProperty&&t instanceof t.constructor?o(t.constructor.prototype):{}},populate:function(t,e,n){for(var r in e)e.hasOwnProperty&&!e.hasOwnProperty(r)||(n[r]=t(e[r]));return n}}),a.register({canCopy:function(t){return!1},create:function(t){return t===document?document:t.cloneNode(!1)},populate:function(t,e,n){if(e===document)return document;if(e.childNodes&&e.childNodes.length)for(var r=0;r<e.childNodes.length;r++){var o=t(e.childNodes[r]);n.appendChild(o)}}}),e.DeepCopyAlgorithm=s,e.copy=function(t){if("object"!=typeof t)return t;var e=t.valueOf();if(t!=e)return new t.constructor(e);if(t instanceof t.constructor&&t.constructor!==Object){r=o(t.constructor.prototype);for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n])}else{var r={};for(var n in t)r[n]=t[n]}return r},e.clone=o,e.deepCopy=a},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t,e;return e=new r.Component,e.description="Makes each data packet a stream of its own",e.icon="pause",e.forwardBrackets={},e.autoOrdering=!1,e.inPorts.add("in",{datatype:"all",description:"Packet to be forward with disconnection"}),e.outPorts.add("out",{datatype:"all"}),t={},e.tearDown=function(e){return t={}},e.process(function(n,o){var i,s,a,u,c,p,d,l;if(e.autoOrdering=!1,a=n.get("in"),t[n.scope]||(t[n.scope]=[]),"openBracket"===a.type)return t[n.scope].push(a.data),void o.done();if("closeBracket"===a.type)return t[n.scope].pop(),void o.done();if("data"===a.type){for(u=0,p=(l=t[n.scope]).length;u<p;u++)i=l[u],o.sendIP("out",new r.IP("openBracket",i));for(o.sendIP("out",a),(s=t[n.scope].slice(0)).reverse(),c=0,d=s.length;c<d;c++)i=s[c],o.sendIP("out",new r.IP("closeBracket",i));return o.done()}})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="This component drops every packet it receives with no action",t.icon="trash-o",t.inPorts.add("in",{datatypes:"all",description:"Packet to be dropped"}),t.process(function(t,e){t.get("in").drop(),e.done()})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="This component generates a single packet and sends it to the output port. Mostly usable for debugging, but can also be useful for starting up networks.",t.icon="share",t.inPorts.add("in",{datatype:"bang",description:"Signal to send the data packet"}),t.inPorts.add("data",{datatype:"all",description:"Packet to be sent",control:!0,default:null}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n;if(t.hasStream("in")&&(!t.attached("data").length||t.hasData("data")))return t.getData("in"),n=t.getData("data"),e.send({out:n}),e.done()})}},function(t,n,r){var o;o=r(0),n.getComponent=function(){var t,n;return t=new o.Component,t.description='Evaluates a function each time data hits the "in" port and sends the return value to "out". Within the function "x" will be the variable from the in port. For example, to make a ^2 function input "return x*x;" to the function port.',t.icon="code",t.inPorts.add("in",{datatype:"all",description:"Packet to be processed"}),t.inPorts.add("function",{datatype:"string",description:"Function to evaluate",control:!0}),t.outPorts.add("out",{datatype:"all"}),t.outPorts.add("function",{datatype:"function"}),t.outPorts.add("error",{datatype:"object"}),n=function(t,e){var n,r;{if("function"!=typeof t){try{r=Function("x",t)}catch(t){return n=t,void e(n)}return e(null,r)}e(null,t)}},t.process(function(t,r){t.attached("in").length&&!t.hasData("in")||(t.hasData("function","in")?n(t.getData("function"),function(e,n){var o,i,s;if(e)r.done(i);else{o=t.getData("in");try{s=n(o)}catch(t){return i=t,void r.done(i)}r.sendDone({function:n,out:s})}}):t.hasData("function")&&n(t.getData("function"),function(t,n){t?r.done(e):r.sendDone({function:n})}))})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="This component receives data on multiple input ports and sends the same data out to the connected output port",t.icon="compress",t.inPorts.add("in",{datatype:"all",description:"Packet to be forwarded"}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n;return n=t.get("in"),e.sendDone({out:n})})}},function(t,e,n){var r,o,i;o=n(0),i=o.isBrowser()?{inspect:function(t){return t}}:n(16),r=function(t,e){return null!=t?console.log(i.inspect(e,t.showHidden,t.depth,t.colors)):console.log(e)},e.getComponent=function(){var t;return t=new o.Component,t.description="Sends the data items to console.log",t.icon="bug",t.inPorts.add("in",{datatype:"all",description:"Packet to be printed through console.log"}),t.inPorts.add("options",{datatype:"object",description:"Options to be passed to console.log",control:!0}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n,o;if(t.hasData("in")&&(!t.attached("options").length||t.hasData("options")))return o=null,t.has("options")&&(o=t.getData("options")),n=t.getData("in"),r(o,n),e.sendDone({out:n})})}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){(function(t){var r;r=n(0),e.getComponent=function(){var e;return e=new r.Component,e.description="Returns the value of a global variable.",e.icon="usd",e.inPorts.add("name",{description:"The name of the global variable."}),e.outPorts.add("value",{description:"The value of the variable."}),e.outPorts.add("error",{description:"Any errors that occured reading the variables value."}),e.forwardBrackets={name:["value","error"]},e.process(function(e,n){var o,i,s;if(e.hasData("name"))return o=e.getData("name"),void 0===(s=r.isBrowser()?window[o]:t[o])?(i=new Error('"'+o+'" is undefined on the global object.'),void n.sendDone(i)):n.sendDone({value:s})})}}).call(e,n(9))},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Forwards packets and metadata in the same way it receives them",t.icon="forward",t.inPorts.add("in",{datatype:"all",description:"Packet to forward"}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n;return n=t.get("in"),e.sendDone({out:n})})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Like 'Repeat', except repeat on next tick",t.icon="step-forward",t.inPorts.add("in",{datatype:"all",description:"Packet to forward"}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n;return n=t.get("in"),setTimeout(function(){return e.sendDone({out:n})},0)})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Forward packet after a set delay",t.icon="clock-o",t.timers=[],t.inPorts.add("in",{datatype:"all",description:"Packet to be forwarded with a delay"}),t.inPorts.add("delay",{datatype:"number",description:"How much to delay",default:500,control:!0}),t.outPorts.add("out",{datatype:"all"}),t.tearDown=function(e){var n,r,o,i;for(n=0,r=(o=t.timers).length;n<r;n++)i=o[n],clearTimeout(i);return t.timers=[],e()},t.process(function(e,n){var r,o,i;if(e.hasData("in")&&(!e.attached("delay").length||e.hasData("delay")))return r=500,e.hasData("delay")&&(r=e.getData("delay")),o=e.get("in"),i=setTimeout(function(){return t.timers.splice(t.timers.indexOf(i),1),n.sendDone({out:o})},r),t.timers.push(i)})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t,e;return t=new r.Component,t.description="Send a packet at the given interval",t.icon="clock-o",t.inPorts.add("interval",{datatype:"number",description:"Interval at which output packets are emitted (ms)",required:!0,control:!0}),t.inPorts.add("start",{datatype:"bang",description:"Start the emission"}),t.inPorts.add("stop",{datatype:"bang",description:"Stop the emission"}),t.outPorts.add("out",{datatype:"bang"}),t.timers={},e=function(e){if(t.timers[e])return clearInterval(t.timers[e].interval),t.timers[e].deactivate(),t.timers[e]=null},t.tearDown=function(n){var r,o;r=t.timers;for(o in r)r[o],e(o);return t.timers={},n()},t.forwardBrackets={},t.process(function(n,o,i){var s,a,u;if(n.hasData("start")){if(!n.hasData("interval"))return;if("data"!==(a=n.get("start")).type)return;return s=parseInt(n.getData("interval")),e(a.scope),i.interval=setInterval(function(){var e;return e=new r.IP("data",!0),e.scope=a.scope,t.outPorts.out.sendIP(e)},s),void(t.timers[a.scope]=i)}if(n.hasData("stop")){if("data"!==(u=n.get("stop")).type)return;e(u.scope)}})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Send a packet after the given time in ms",t.icon="clock-o",t.timer={},t.inPorts.add("time",{datatype:"number",description:"Time after which a packet will be sent",required:!0,control:!0}),t.inPorts.add("start",{datatype:"bang",description:"Start the timeout before sending a packet"}),t.outPorts.add("out",{datatype:"bang"}),t.forwardBrackets={start:["out"]},t.stopTimer=function(e){if(t.timer[e])return clearTimeout(t.timer[e].timeout),t.timer[e].deactivate(),delete t.timer[e]},t.tearDown=function(e){var n,r;n=t.timer;for(r in n)n[r],t.stopTimer(r);return e()},t.process(function(e,n,r){var o;e.hasData("time","start")&&(o=e.getData("time"),e.getData("start"),t.stopTimer(e.scope),r.timeout=setTimeout(function(){return t.timer=null,n.sendDone({out:!0})},o),t.timer[e.scope]=r)})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Sends next packet in buffer when receiving a bang",t.icon="forward",t.inPorts.add("data",{datatype:"all"}),t.inPorts.add("in",{datatype:"bang"}),t.outPorts.add("out",{datatype:"all"}),t.outPorts.add("empty",{datatype:"bang",required:!1}),t.forwardBrackets={},t.process(function(e,n){var r,o,i;if(e.hasData("in")){if(r=e.getData("in"),e.hasData("data")){for(i=!1;e.has("data")&&(!i||"data"!==t.inPorts.data.getBuffer(r.scope)[0].type);)o=e.get("data"),n.send({out:o}),"data"===o.type&&(i=!0);return n.done()}n.sendDone({empty:!0})}})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.icon="expand",t.description="This component receives data on a single input port and sends the same data out to all connected output ports",t.inPorts.add("in",{datatype:"all",description:"Packet to be forwarded"}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n;return n=t.get("in"),e.sendDone({out:n})})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Add a class to an element",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("class",{datatype:"string"}),t.process(function(t,e){var n,r,o;if(t.has("element","class"))return o=t.getData("element","class"),r=o[0],n=o[1],r.classList.add(n),e.done()})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Append elements as children of a parent element",t.inPorts.add("parent",{datatype:"object"}),t.inPorts.add("child",{datatype:"object"}),t.process(function(t,e){var n,r,o;if(t.hasData("parent","child"))return o=t.getData("parent","child"),r=o[0],n=o[1],r.appendChild(n),e.done()})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Create a new DOM Element",t.inPorts.add("tagname",{datatype:"string"}),t.inPorts.add("container",{datatype:"object"}),t.outPorts.add("element",{datatype:"object"}),t.forwardBrackets={tagname:["element"]},t.process(function(e,n){var r,o;if(e.hasData("tagname")&&(!t.inPorts.container.isAttached()||e.hasData("container")))return o=e.getData("tagname"),r=document.createElement(o),e.hasData("container")&&e.getData("container").appendChild(r),n.sendDone({element:r})})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Create a new DOM DocumentFragment",t.inPorts.add("in",{datatype:"bang"}),t.outPorts.add("fragment",{datatype:"object"}),t.forwardBrackets={in:["fragment"]},t.process(function(t,e){var n;if(t.hasData("in"))return t.getData("in"),n=document.createDocumentFragment(),e.sendDone({fragment:n})})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Reads the given attribute from the DOM element on the in port.",t.inPorts.add("element",{datatype:"object",description:"The element from which to read the attribute from.",required:!0}),t.inPorts.add("attribute",{datatype:"string",description:"The attribute which is read from the DOM element.",required:!0,control:!0}),t.outPorts.add("out",{datatype:"string",description:"Value of the attribute being read."}),t.forwardBrackets={element:["out"]},t.process(function(t,e){var n,r,o,i;if(t.hasData("element","attribute"))return o=t.getData("element","attribute"),r=o[0],n=o[1],i=r.getAttribute(n),e.sendDone({out:i})})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Get a DOM element matching a query",t.inPorts.add("in",{datatype:"object",description:"DOM element to constrain the query to"}),t.inPorts.add("selector",{datatype:"string",description:"CSS selector"}),t.outPorts.add("element",{datatype:"object"}),t.outPorts.add("error",{datatype:"object"}),t.forwardBrackets={selector:["element","error"]},t.process(function(t,e){var n,r,o,i,s,a,u,c,p;if(t.hasData("selector")&&(!(t.attached("in").length>0)||t.hasData("in")))if(t.hasData("in")){if(c=t.getData("in","selector"),n=c[0],p=c[1],"function"!=typeof n.querySelector)return void e.done(new Error("Given container doesn't support querySelectors"));if(!(r=n.querySelectorAll(p)).length)return void e.done(new Error("No element matching '"+p+"' found under container"));for(i=0,a=r.length;i<a;i++)o=r[i],e.send({element:o});e.done()}else{if(p=t.getData("selector"),(r=document.querySelectorAll(p)).length){for(s=0,u=r.length;s<u;s++)o=r[s],e.send({element:o});return e.done()}e.done(new Error("No element matching '"+p+"' found under document"))}})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Check if an element has a given class",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("class",{datatype:"string"}),t.outPorts.add("element",{datatype:"object"}),t.outPorts.add("missed",{datatype:"object"}),t.process(function(t,e){var n,r,o;if(t.hasData("element","class")){if(o=t.getData("element","class"),n=o[0],r=o[1],!n.classList.contains(r))return e.sendDone({missed:n});e.sendDone({element:n})}})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t,e;return t=new r.Component,t.description="addEventListener for specified event type",t.icon="stethoscope",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("type",{datatype:"string"}),t.inPorts.add("preventdefault",{datatype:"boolean",control:!0,default:!1}),t.outPorts.add("element",{datatype:"object"}),t.outPorts.add("event",{datatype:"object"}),t.elements={},e=function(e){var n,r,o,i;if(t.elements[e])return i=t.elements[e],n=i.element,r=i.event,o=i.listener,n.removeEventListener(r,o),t.elements[e].deactivate(),delete t.elements[e]},t.tearDown=function(n){var r,o;r=t.elements;for(o in r)r[o],e(o);return t.elements={},n()},t.forwardBrackets={},t.process(function(n,r,o){var i,s,a,u;if(n.hasData("element","type"))return a=n.getData("element","type"),i=a[0],u=a[1],s=!1,n.hasData("preventdefault")&&(s=n.getData("preventdefault")),null,e(null),o.element=i,o.event=u,o.listener=function(t){return s&&t.preventDefault(),r.send({element:o.element,event:t})},t.elements[o]=o,i.addEventListener(u,o.listener)})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Read HTML from an existing element",t.inPorts.add("container",{datatype:"object"}),t.outPorts.add("html",{datatype:"string"}),t.forwardBrackets={container:["html"]},t.process(function(t,e){var n;if(t.hasData("container"))return n=t.getData("container"),e.sendDone({html:n.innerHTML})})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Remove a class from an element",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("class",{datatype:"string"}),t.process(function(t,e){var n,r,o;if(t.has("element","class"))return o=t.getData("element","class"),r=o[0],n=o[1],r.classList.remove(n),e.done()})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Remove an element from DOM",t.inPorts.add("element",{datatype:"object"}),t.process(function(t,e){var n;if(t.hasData("element")&&(n=t.getData("element")).parentNode)return n.parentNode.removeChild(n),e.done()})}},function(t,e,n){var r,o;r=n(0),o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout(function(){return t(+new Date)},1e3/60)},e.getComponent=function(){var t,e;return t=new r.Component,t.description="Sends bangs that correspond with screen refresh rate.",t.icon="film",t.inPorts.add("start",{datatype:"bang"}),t.inPorts.add("stop",{datatype:"bang"}),t.outPorts.add("out",{datatype:"bang"}),t.running={},e=function(e){if(t.running[e])return t.running[e].deactivate(),delete t.running[e]},t.tearDown=function(n){var r,o;r=t.running;for(o in r)r[o],e(o);return t.running={},n()},t.animate=function(e,n){if(t.running[e])return n.send(!0),o(t.animate.bind(t,e,n))},t.forwardBrackets={},t.process(function(n,r,i){var s,a;if(n.hasData("start")){if("data"!==(s=n.get("start")).type)return;return e(s.scope),t.running[s.scope]=i,void o(t.animate.bind(t,s.scope,r))}if(n.hasData("stop")){if("data"!==(a=n.get("stop")).type)return;e(a.scope)}})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Set the given attribute on the DOM element to the received value.",t.inPorts.add("element",{datatype:"object",description:"The element on which to set the attribute."}),t.inPorts.add("attribute",{datatype:"string",description:"The attribute which is set on the DOM element."}),t.inPorts.add("value",{datatype:"string",description:"Value of the attribute being set."}),t.outPorts.add("element",{datatype:"object",description:"The element that was updated."}),t.forwardBrackets={element:["element"],value:["element"]},t.process(function(t,e){var n,r,o,i,s,a,u;if(t.hasData("element","attribute","value")){if(s=t.getData("element","attribute","value"),r=s[0],n=s[1],"object"==typeof(u=s[2]))if("[object Array]"===toString.call(u))u=u.join(" ");else{i=[];for(o in u)a=u[o],i.push(a);u=i.join(" ")}return"value"===n?r.value=u:r.setAttribute(n,u),e.sendDone({element:r})}})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Write HTML inside an existing element",t.inPorts.add("container",{datatype:"object"}),t.inPorts.add("html",{datatype:"string"}),t.outPorts.add("container",{datatype:"object"}),t.process(function(t,e){var n,r,o;if(t.hasData("container","html"))return o=t.getData("container","html"),n=o[0],r=o[1],n.innerHTML=r,e.sendDone({container:n})})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.icon="i-cursor",t.description="focus element",t.inPorts.add("element",{datatype:"object",description:"element to be focused",control:!0}),t.inPorts.add("trigger",{datatype:"bang",description:"trigger focus"}),t.outPorts.add("out",{datatype:"bang"}),t.process(function(t,e){var n;if(t.hasData("element","trigger"))return n=t.getData("element"),t.getData("trigger"),window.setTimeout(function(){return n.focus(),e.sendDone({out:!0})},0)})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Listen to changes on an input element",t.icon="hourglass",t.inPorts.add("element",{datatype:"object"}),t.outPorts.add("value",{datatype:"object"}),t.elements=[],t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)(n=i[r]).el.removeEventListener("change",n.listener,!1),n.ctx.deactivate();return t.elements=[],e()},t.forwardBrackets={},t.process(function(e,n,r){var o;e.hasData("element")&&((o={el:e.getData("element"),listener:function(t){return t.preventDefault(),t.stopPropagation(),n.send({value:t.target.value})},ctx:r}).el.addEventListener("change",o.listener,!1),t.elements.push(o))})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Listen to drag events on a DOM element",t.icon="arrows",t.inPorts.add("element",{datatype:"object"}),t.outPorts.add("start",{datatype:"object"}),t.outPorts.add("movey",{datatype:"number"}),t.outPorts.add("movex",{datatype:"number"}),t.outPorts.add("end",{datatype:"object"}),t.elements=[],t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)(n=i[r]).el.removeEventListener("dragstart",n.dragstart,!1),n.el.removeEventListener("drag",n.dragmove,!1),n.el.removeEventListener("dragend",n.dragend,!1),n.ctx.deactivate();return t.elements=[],e()},t.forwardBrackets={},t.process(function(e,n,r){var o;e.hasData("element")&&((o={el:e.getData("element"),dragstart:function(t){return t.stopPropagation(),n.send({start:t})},dragmove:function(t){return t.preventDefault(),t.stopPropagation(),n.send({movex:t.clientX,movey:t.clientY})},dragend:function(t){return t.preventDefault(),t.stopPropagation(),n.send({end:t})},ctx:r}).el.addEventListener("dragstart",o.dragstart,!1),o.el.addEventListener("drag",o.dragmove,!1),o.el.addEventListener("dragend",o.dragend,!1),t.elements.push(o))})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t,e;return t=new r.Component,t.description="Listen for hash changes in browser's URL bar",t.icon="slack",t.inPorts.add("start",{datatype:"bang",description:"Start listening for hash changes"}),t.inPorts.add("stop",{datatype:"bang",description:"Stop listening for hash changes"}),t.outPorts.add("initial",{datatype:"string"}),t.outPorts.add("change",{datatype:"string"}),t.current=null,t.subscriber=null,e=function(){if(t.subscriber)return window.removeEventListener("hashchange",t.subscriber.callback,!1),t.subscriber.ctx.deactivate(),t.subscriber=null},t.tearDown=function(n){return t.current=null,e(),n()},t.forwardBrackets={},t.process(function(n,o,i){var s;if(n.hasData("start"))return n.getData("start"),e(),s=function(e){var n,i;if(n=t.current,t.current=window.location.href.split("#")[1]||"",n&&o.send({change:new r.IP("openBracket",n)}),i={},i[e]=t.current,o.send(i),n)return o.send({change:new r.IP("closeBracket",n)})},t.subscriber={callback:function(t){return s("change")},ctx:i},s("initial"),void window.addEventListener("hashchange",t.subscriber.callback,!1);n.hasData("stop")&&(n.getData("stop"),e(),o.done())})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Listen for key presses on a given DOM element",t.icon="keyboard-o",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("stop",{datatype:"object"}),t.outPorts.add("keypress",{datatype:"integer"}),t.elements=[],function(t){return t.el.removeEventListener("keypress",t.listener,!1),t.ctx.deactivate()},t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)n=i[r],unsubscribe(n);return t.elements=[],e()},t.forwardBrackets={},t.process(function(e,n,r){var o,i,s,a,u,c,p;if(e.hasData("element"))return(i={el:e.getData("element"),listener:function(t){return n.send({keypress:t.keyCode})},ctx:r}).el.addEventListener("keypress",i.listener,!1),void t.elements.push(i);if(e.hasData("stop")){for(a=e.getData("stop"),o=null,u=0,c=(p=t.elements).length;u<c;u++)(s=p[u]).el===a&&(o=s);if(!o)return;return unsubscribe(o),n.done()}})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t,e;return t=new r.Component,t.description="Listen for keyboard shortcuts and route them",t.icon="keyboard-o",t.inPorts.add("keys",{datatype:"array"}),t.inPorts.add("ignoreinput",{datatype:"boolean",default:!0,control:!0}),t.inPorts.add("stop",{datatype:"bang"}),t.outPorts.add("shortcut",{datatype:"bang",addressable:!0}),t.outPorts.add("missed",{datatype:"integer"}),t.subscriber=null,e=function(){if(t.subscriber)return document.removeEventListener("keydown",t.subscriber.callback,!1),t.subscriber.ctx.deactivate(),t.subscriber=null},t.tearDown=function(t){return e(),t()},t.forwardBrackets={},t.process(function(n,o,i){var s,a,u,c,p;if(n.hasData("keys")){for(c=n.getData("keys"),e(),"string"==typeof c&&(c=c.split(",")),u=s=0,p=c.length;s<p;u=++s)switch(c[u]){case"-":c[u]=189;break;case"=":c[u]=187;break;case"0":c[u]=48;break;case"a":c[u]=65;break;case"x":c[u]=88;break;case"c":c[u]=67;break;case"v":c[u]=86;break;case"z":c[u]=90;break;case"r":c[u]=82}return a=!n.hasData("ignoreinput")||n.getData("ignoreinput"),t.subscriber={callback:function(t){var e;if((t.ctrlKey||t.metaKey)&&!("TEXTAREA"===t.target.tagName&&a||"INPUT"===t.target.tagName&&a||"true"===String(t.target.contentEditable)&&a)){if(-1!==(e=c.indexOf(t.keyCode)))return t.preventDefault(),t.stopPropagation(),o.send({shortcut:new r.IP("data",t.keyCode,{index:e})});o.send({missed:t.keyCode})}},ctx:i},void document.addEventListener("keydown",t.subscriber.callback,!1)}n.hasData("stop")&&(n.getData("stop"),e(),o.done())})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.icon="mouse-pointer",t.description="Listen to mouse events on a DOM element",t.inPorts.add("element",{datatype:"object"}),t.outPorts.add("click",{datatype:"object"}),t.outPorts.add("dblclick",{datatype:"object"}),t.elements=[],t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)(n=i[r]).el.removeEventListener("click",n.click,!1),n.el.removeEventListener("dblclick",n.dblclick,!1),n.ctx.deactivate();return t.elements=[],e()},t.forwardBrackets={},t.process(function(e,n,r){var o;e.hasData("element")&&((o={el:e.getData("element"),click:function(t){return t.preventDefault(),t.stopPropagation(),n.send({click:t})},dblclick:function(t){return t.preventDefault(),t.stopPropagation(),n.send({dblclick:t})},ctx:r}).el.addEventListener("click",o.click,!1),o.el.addEventListener("dblclick",o.dblclick,!1),t.elements.push(o))})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t,e,n,o,i;for((t=new r.Component).description="Listen to pointer events on a DOM element",t.icon="pencil-square-o",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("action",{datatype:"string",default:"none",control:!0}),o=0,i=(n=["down","up","cancel","move","over","out","enter","leave"]).length;o<i;o++)e=n[o],t.outPorts.add(e,{datatype:"object",description:"Sends event on pointer"+e});return t.elements=[],t.tearDown=function(r){var o,i,s,a,u,c;for(i=0,a=(c=t.elements).length;i<a;i++){for((o=c[i]).el.removeAttribute&&o.el.removeAttribute("touch-action"),s=0,u=n.length;s<u;s++)e=n[s],o.el.removeEventListener("pointer"+e,o["pointer"+e],!1);o.ctx.deactivate()}return t.elements=[],r()},t.forwardBrackets={},t.process(function(e,r,o){var i,s;e.hasData("element")&&(i=e.hasData("action")?e.getData("action"):"none",(s={el:e.getData("element"),ctx:o}).el.setAttribute("touch-action",i),n.forEach(function(t){return s["pointer"+t]=function(e){var n;return e.preventDefault(),e.stopPropagation(),n={},n[t]=e.target.value,r.send(n)},s.el.addEventListener("pointer"+t,s["pointer"+t],!1)}),t.elements.push(s))})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t,e;return t=new r.Component,t.description="Listen to window resize events",t.icon="desktop",t.inPorts.add("start",{datatype:"bang",description:"Start listening for screen resizes"}),t.inPorts.add("stop",{datatype:"bang",description:"Stop listening for screen resizes"}),t.outPorts.add("width",{datatype:"number"}),t.outPorts.add("height",{datatype:"number"}),t.subscriber=null,e=function(){if(t.subscriber)return window.removeEventListener("resize",t.subscriber.callback,!1),t.subscriber.ctx.deactivate(),t.subscriber=null},t.tearDown=function(t){return e(),t()},t.forwardBrackets={},t.process(function(n,r,o){if(n.hasData("start"))return n.getData("start"),e(),t.subscriber={callback:function(t){return r.send({width:window.innerWidth,height:window.innerHeight})},ctx:o},r.send({width:window.innerWidth,height:window.innerHeight}),void window.addEventListener("resize",t.subscriber.callback,!1);n.hasData("stop")&&(n.getData("stop"),e(),r.done())})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t,e;return t=new r.Component,t.description="Listen to scroll events on the browser window",t.icon="arrows-v",t.inPorts.add("start",{datatype:"bang",description:"Start listening for hash changes"}),t.inPorts.add("stop",{datatype:"bang",description:"Stop listening for hash changes"}),t.outPorts.add("top",{datatype:"number"}),t.outPorts.add("bottom",{datatype:"number"}),t.outPorts.add("left",{datatype:"number"}),t.outPorts.add("right",{datatype:"number"}),t.subscriber=null,e=function(){if(t.subscriber)return window.removeEventListener("scroll",t.subscriber.callback,!1),t.subscriber.ctx.deactivate(),t.subscriber=null},t.tearDown=function(t){return e(),t()},t.forwardBrackets={},t.process(function(n,r,o){if(n.hasData("start"))return n.getData("start"),e(),t.subscriber={callback:function(t){var e,n;return n=window.scrollY,e=window.scrollX,r.send({top:n,bottom:n+window.innerHeight,left:e,right:e.window.innerWidth})},ctx:o},void window.addEventListener("scroll",t.subscriber.callback,!1);n.hasData("stop")&&(n.getData("stop"),e(),r.done())})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t,e;return t=new r.Component,t.description="Listen for user's microphone and recognize phrases",t.icon="microphone",t.inPorts.add("start",{datatype:"bang",description:"Start listening for hash changes"}),t.inPorts.add("stop",{datatype:"bang",description:"Stop listening for hash changes"}),t.outPorts.add("result",{datatype:"string"}),t.outPorts.add("error",{datatype:"object"}),t.subscriber=null,e=function(){if(t.subscriber)return t.subscriber.recognition.stop(),t.subscriber.ctx.deactivate(),t.subscriber=null},t.tearDown=function(t){return e(),t()},t.forwardBrackets={},t.process(function(n,r,o){if(n.hasData("start"))return n.getData("start"),e(),window.webkitSpeechRecognition?(t.subscriber={sent:[],callback:function(e){var n,o,i,s,a,u;for(u=[],o=n=0,i=(s=e.results).length;n<i;o=++n)(a=s[o]).isFinal&&-1===t.subscriber.sent.indexOf(o)&&(r.send({result:a[0].transcript}),u.push(t.subscriber.sent.push(o)));return u},error:function(t){return r.send({error:t})},ctx:o},t.subscriber.recognition=new window.webkitSpeechRecognition,t.subscriber.recognition.continuous=!0,t.subscriber.recognition.start(),t.subscriber.recognition.onresult=t.subscriber.callback,void(t.subscriber.recognition.onerror=t.subscriber.error)):void r.done(new Error("Speech recognition support not available"));n.hasData("stop")&&(n.getData("stop"),e(),r.done())})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Listen to touch events on a DOM element",t.icon="hand-o-up",t.inPorts.add("element",{datatype:"object"}),t.outPorts.add("start",{datatype:"object"}),t.outPorts.add("movex",{datatype:"number"}),t.outPorts.add("movey",{datatype:"number"}),t.outPorts.add("end",{datatype:"object"}),t.elements=[],t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)(n=i[r]).el.removeEventListener("touchstart",n.touchstart,!1),n.el.removeEventListener("touchmove",n.touchmove,!1),n.el.removeEventListener("touchend",n.touchend,!1),n.ctx.deactivate();return t.elements=[],e()},t.forwardBrackets={},t.process(function(e,n,o){var i;e.hasData("element")&&((i={el:e.getData("element"),touchstart:function(t){var e,o,i,s,a;if(t.preventDefault(),t.stopPropagation(),t.changedTouches&&t.changedTouches.length){for(a=[],o=e=0,i=(s=t.changedTouches).length;e<i;o=++e)s[o],a.push(n.send({start:new r.IP("data",t,{touch:o})}));return a}},touchmove:function(t){var e,o,i,s,a,u;if(t.preventDefault(),t.stopPropagation(),t.changedTouches&&t.changedTouches.length){for(a=[],o=e=0,i=(s=t.changedTouches).length;e<i;o=++e)u=s[o],a.push(n.send({movex:new r.IP("data",u.pageX,{touch:o}),movey:new r.IP("data",u.pageY,{touch:o})}));return a}},touchend:function(t){var e,o,i,s,a;if(t.preventDefault(),t.stopPropagation(),t.changedTouches&&t.changedTouches.length){for(a=[],o=e=0,i=(s=t.changedTouches).length;e<i;o=++e)s[o],a.push(n.send({end:new r.IP("data",t,{touch:o})}));return a}},ctx:o}).el.addEventListener("touchstart",i.touchstart,!1),i.el.addEventListener("touchmove",i.touchmove,!1),i.el.addEventListener("touchend",i.touchend,!1),t.elements.push(i))})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Read the coordinates from a DOM event",t.icon="map-marker",t.inPorts.add("event",{datatype:"object"}),t.outPorts.add("screen",{datatype:"object"}),t.outPorts.add("client",{datatype:"object"}),t.outPorts.add("page",{datatype:"object"}),t.forwardBrackets={event:["screen","client","page"]},t.process(function(t,e){var n;if(t.hasData("event"))return n=t.getData("event"),e.sendDone({screen:{x:n.screenX,y:n.screenY},client:{x:n.clientX,y:n.clientY},page:{x:n.pageX,y:n.pageY}})})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Read the state of a gamepad",t.icon="gamepad",t.inPorts.add("gamepad",{datatype:"integer"}),t.outPorts.add("out",{datatype:"object"}),t.outPorts.add("error",{datatype:"object"}),t.lastTimestamps={},t.tearDown=function(e){return t.lastTimestamps={},e()},t.process(function(e,n){var r,o;if(e.hasData("gamepad"))if(r=e.getData("gamepad"),navigator.webkitGetGamepads){if((o=navigator.webkitGetGamepads()[r])||n.done(new Error("Gamepad '"+r+"' not available")),!(t.lastTimestamps[r]=o.timestamp))return t.lastTimestamps[r]=o.timestamp,n.sendDone({out:o});n.done()}else n.done(new Error("No WebKit Gamepad API available"))})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return t=new r.Component,t.description="Set the hash in browser's URL bar",t.icon="slack",t.inPorts.add("hash",{datatype:"string"}),t.outPorts.add("out",{datatype:"string"}),t.process(function(t,e){var n;if(t.hasData("hash"))return n=t.getData("hash"),window.location.hash="#"+n,e.sendDone({out:n})})}},function(t,e,n){function r(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}function o(t){function n(){if(n.enabled){var t=n,r=+new Date,i=r-(o||r);t.diff=i,t.prev=o,t.curr=r,o=r;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var u=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;u++;var o=e.formatters[r];if("function"==typeof o){var i=s[u];n=o.call(t,i),s.splice(u,1),u--}return n}),e.formatArgs.call(t,s),(n.log||e.log||console.log.bind(console)).apply(t,s)}}var o;return n.namespace=t,n.enabled=e.enabled(t),n.useColors=e.useColors(),n.color=r(t),n.destroy=i,"function"==typeof e.init&&e.init(n),e.instances.push(n),n}function i(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=o.debug=o.default=o).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){e.save(t),e.names=[],e.skips=[];var n,r=("string"==typeof t?t:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var i=e.instances[n];i.enabled=e.enabled(i.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(88),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e){function n(t){if(!((t=String(t)).length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*p;case"days":case"day":case"d":return n*c;case"hours":case"hour":case"hrs":case"hr":case"h":return n*u;case"minutes":case"minute":case"mins":case"min":case"m":return n*a;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function r(t){return t>=c?Math.round(t/c)+"d":t>=u?Math.round(t/u)+"h":t>=a?Math.round(t/a)+"m":t>=s?Math.round(t/s)+"s":t+"ms"}function o(t){return i(t,c,"day")||i(t,u,"hour")||i(t,a,"minute")||i(t,s,"second")||t+" ms"}function i(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}var s=1e3,a=60*s,u=60*a,c=24*u,p=365.25*c;t.exports=function(t,e){e=e||{};var i=typeof t;if("string"===i&&t.length>0)return n(t);if("number"===i&&!1===isNaN(t))return e.long?o(t):r(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){(function(t){(function(){var r,o,i,s,a=function(t,e){return function(){return t.apply(e,arguments)}},u=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=n(11),o=n(18),i=n(5),r=function(e){function n(t,e,n){if(this.inPortName=null!=t?t:"in",this.outPortName=null!=e?e:"out",this.errPortName=null!=n?n:"error",this.error=a(this.error,this),i.deprecated("noflo.AsyncComponent is deprecated. Please port to Process API"),!this.inPorts[this.inPortName])throw new Error("no inPort named '"+this.inPortName+"'");if(!this.outPorts[this.outPortName])throw new Error("no outPort named '"+this.outPortName+"'");this.load=0,this.q=[],this.errorGroups=[],this.outPorts.load=new s.Port,this.inPorts[this.inPortName].on("begingroup",function(t){return function(e){return t.load>0?t.q.push({name:"begingroup",data:e}):(t.errorGroups.push(e),t.outPorts[t.outPortName].beginGroup(e))}}(this)),this.inPorts[this.inPortName].on("endgroup",function(t){return function(){return t.load>0?t.q.push({name:"endgroup"}):(t.errorGroups.pop(),t.outPorts[t.outPortName].endGroup())}}(this)),this.inPorts[this.inPortName].on("disconnect",function(t){return function(){return t.load>0?t.q.push({name:"disconnect"}):(t.outPorts[t.outPortName].disconnect(),t.errorGroups=[],t.outPorts.load.isAttached()?t.outPorts.load.disconnect():void 0)}}(this)),this.inPorts[this.inPortName].on("data",function(t){return function(e){return t.q.length>0?t.q.push({name:"data",data:e}):t.processData(e)}}(this))}return u(n,e),n.prototype.processData=function(t){return this.incrementLoad(),this.doAsync(t,function(t){return function(e){return e&&t.error(e,t.errorGroups,t.errPortName),t.decrementLoad()}}(this))},n.prototype.incrementLoad=function(){if(this.load++,this.outPorts.load.isAttached()&&this.outPorts.load.send(this.load),this.outPorts.load.isAttached())return this.outPorts.load.disconnect()},n.prototype.doAsync=function(t,e){return e(new Error("AsyncComponents must implement doAsync"))},n.prototype.decrementLoad=function(){if(0===this.load)throw new Error("load cannot be negative");return this.load--,this.outPorts.load.isAttached()&&this.outPorts.load.send(this.load),this.outPorts.load.isAttached()&&this.outPorts.load.disconnect(),void 0!==t&&t.execPath&&-1!==t.execPath.indexOf("node")?t.nextTick(function(t){return function(){return t.processQueue()}}(this)):setTimeout(function(t){return function(){return t.processQueue()}}(this),0)},n.prototype.processQueue=function(){var t,e;if(!(this.load>0))for(e=!1;this.q.length>0;)switch((t=this.q[0]).name){case"begingroup":if(e)return;this.outPorts[this.outPortName].beginGroup(t.data),this.errorGroups.push(t.data),this.q.shift();break;case"endgroup":if(e)return;this.outPorts[this.outPortName].endGroup(),this.errorGroups.pop(),this.q.shift();break;case"disconnect":if(e)return;this.outPorts[this.outPortName].disconnect(),this.outPorts.load.isAttached()&&this.outPorts.load.disconnect(),this.errorGroups=[],this.q.shift();break;case"data":this.processData(t.data),this.q.shift(),e=!0}},n.prototype.tearDown=function(t){return this.q=[],this.errorGroups=[],t()},n.prototype.error=function(t,e,n){var r,o,i,s,a;if(null==e&&(e=[]),null==n&&(n="error"),!this.outPorts[n]||!this.outPorts[n].isAttached()&&this.outPorts[n].isRequired())throw t;for(o=0,s=e.length;o<s;o++)r=e[o],this.outPorts[n].beginGroup(r);for(this.outPorts[n].send(t),i=0,a=e.length;i<a;i++)r=e[i],this.outPorts[n].endGroup();this.outPorts[n].disconnect()},n}(o.Component),e.AsyncComponent=r}).call(this)}).call(e,n(1))},function(t,e,n){(function(t){(function(){var r,o,i,s,a,u,c,p,d,l,f,h,g,m,v,y,b,w,P,k,E,_,C,D,x=[].slice,S={}.hasOwnProperty;s=n(12).StreamSender,n(12).StreamReceiver,o=n(7),r=n(4),y=n(5),D=n(17),d=n(3)("noflo:helpers"),m=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(arg)},e.MapComponent=function(t,e,n){return y.deprecated("noflo.helpers.MapComponent is deprecated. Please port to Process API"),n||(n={}),n.inPort||(n.inPort="in"),n.outPort||(n.outPort="out"),t.forwardBrackets||(t.forwardBrackets={}),t.forwardBrackets[n.inPort]=[n.outPort],t.process(function(r,o){var i,s,a;if(r.hasData(n.inPort))return i=r.getData(n.inPort),s=l(t,n.inPort,r),a=h([n.outPort],o),e(i,s,a),o.done()})},e.WirePattern=function(e,n,r){var o,i,s,u;if(o="in"in n?n.in:"in",m(o)||(o=[o]),i="out"in n?n.out:"out",m(i)||(i=[i]),"error"in n||(n.error="error"),"async"in n||(n.async=!1),"ordered"in n||(n.ordered=!0),"group"in n||(n.group=!1),"field"in n||(n.field=null),"forwardGroups"in n||(n.forwardGroups=!1),n.forwardGroups&&("string"==typeof n.forwardGroups&&(n.forwardGroups=[n.forwardGroups]),"boolean"==typeof n.forwardGroups&&(n.forwardGroups=o)),"receiveStreams"in n||(n.receiveStreams=!1),n.receiveStreams)throw new Error("WirePattern receiveStreams is deprecated");if("sendStreams"in n||(n.sendStreams=!1),n.sendStreams)throw new Error("WirePattern sendStreams is deprecated");return n.async&&(n.sendStreams=i),"params"in n||(n.params=[]),"string"==typeof n.params&&(n.params=[n.params]),"name"in n||(n.name=""),"dropInput"in n||(n.dropInput=!1),"arrayPolicy"in n||(n.arrayPolicy={in:"any",params:"all"}),n.inPorts=o,n.outPorts=i,a(n,r),n.legacy||(void 0!==t&&null!==t&&null!=(s=t.env)?s.NOFLO_WIREPATTERN_LEGACY:void 0)?(y.deprecated("noflo.helpers.WirePattern legacy mode is deprecated"),u=v):u=w,u(e,n,r)},w=function(t,e,n){return E(t,e),C(t),k(t,e),t.ordered=e.ordered,t.process(function(r,o,i){var s,a,c,p,g,m;if(u(e,r,o)){if(t.params=b(e,r),s=f(e,r),c=l(t,e.inPorts[0],r),p=h(e.outPorts,o),d("WirePattern Process API call with",s,c,t.params,i.scope),g=function(){throw new Error("noflo.helpers.WirePattern postpone is deprecated")},m=function(){throw new Error("noflo.helpers.WirePattern resume is deprecated")},!e.async){if(a=_(t,e,o),n.call(t,s,c,p,g,m,r.scope),o.result.__resolved)return;return a(),void o.done()}return a=_(t,e,o),n.call(t,s,c,p,function(t){return a(),o.done(t)},g,m,r.scope)}})},a=function(t,e){t.group&&y.deprecated("noflo.helpers.WirePattern group option is deprecated. Please port to Process API"),t.field&&y.deprecated("noflo.helpers.WirePattern field option is deprecated. Please port to Process API"),e.length>4&&y.deprecated("noflo.helpers.WirePattern postpone and resume are deprecated. Please port to Process API"),t.async||y.deprecated("noflo.helpers.WirePattern synchronous is deprecated. Please port to Process API"),"error"!==t.error&&y.deprecated('noflo.helpers.WirePattern custom error port name is deprecated. Please switch to "error" or port to WirePattern')},E=function(t,e){var n,r,o,i,s;for(s=[],n=0,r=(i=e.params).length;n<r;n++)o=i[n],s.push(t.inPorts[o].options.control=!0);return s},k=function(t,e){var n,r,o,i,s,a,u,c;if(t.forwardBrackets={},e.forwardGroups)for(r=e.inPorts,m(e.forwardGroups)&&(r=e.forwardGroups),o=0,s=r.length;o<s;o++){for(n=r[o],t.forwardBrackets[n]=[],i=0,a=(c=e.outPorts).length;i<a;i++)u=c[i],t.forwardBrackets[n].push(u);t.outPorts.error&&t.forwardBrackets[n].push("error")}},_=function(t,e,n){var o,i,s,a;return i=[],o=function(e,n){return null==n&&(n=[]),y.deprecated("noflo.helpers.WirePattern error method is deprecated. Please send error to callback instead"),i.push({err:e,groups:n}),t.hasErrors=!0},s=function(t,e){return null==t&&(t=null),null==e&&(e=[]),y.deprecated("noflo.helpers.WirePattern fail method is deprecated. Please send error to callback instead"),t&&o(t,e),a(),n.done()},a=function(){if(i.length)return e.name&&n.sendIP("error",new r("openBracket",e.name)),i.forEach(function(t){var e,o,i,s,a,u,c,p;for(o=0,s=(u=t.groups).length;o<s;o++)e=u[o],n.sendIP("error",new r("openBracket",e));for(n.sendIP("error",new r("data",t.err)),p=[],i=0,a=(c=t.groups).length;i<a;i++)e=c[i],p.push(n.sendIP("error",new r("closeBracket",e)));return p}),e.name&&n.sendIP("error",new r("closeBracket",e.name)),t.hasErrors=!1,i=[]},t.hasErrors=!1,t.error=o,t.fail=s,a},C=function(t){var e;return e=Object.keys(t.inPorts.ports).filter(function(e){return!!t.inPorts[e].options.control&&!!t.inPorts[e].hasDefault()}),t.sendDefaults=function(){return y.deprecated("noflo.helpers.WirePattern sendDefaults method is deprecated. Please start with a Network"),e.forEach(function(e){var n;return n=o.createSocket(),t.inPorts[e].attach(n),n.send(),n.disconnect(),t.inPorts[e].detach(n)})}},b=function(t,e){var n,r,o,i,s,a,u,c,p;if(!t.params.length)return{};for(u={},r=0,i=(c=t.params).length;r<i;r++)if(a=c[r],e.ports[a].isAddressable())for(u[a]={},o=0,s=(p=e.attached(a)).length;o<s;o++)n=p[o],e.hasData([a,n])&&(u[a][n]=e.getData([a,n]));else u[a]=e.getData(a);return u},P=function(t,e){var n,r,o,i,s,a,u,c,p,d,l;for(p=null,n=[],d=[],r=i=0,a=t.length;i<a;r=++i)if("openBracket"!==(o=t[r]).type){if("closeBracket"!==o.type)e(o,n)?(p=d.slice(0)).push(o):d=[];else if(n.pop(),p&&p.push(o),d.length&&d.pop(),p&&!d.length)break}else n.push(o.data),d.push(o);if(0!==(l=t.indexOf(p[0]))){for(t.splice(l,p.length),p.reverse(),c=[],s=0,u=p.length;s<u;s++)o=p[s],c.push(t.unshift(o));return c}},g=function(t,e,n,r,o){var i;if(e.group||e.field)return e.group&&(i=n.ports[r].getBuffer(n.scope,o),P(i,function(t,e){var r,i,s,a;for(a=n.collatedBy.brackets,o=i=0,s=a.length;i<s;o=++i)if(r=a[o],e[o]!==r)return!1;return!0})),e.field?(t[e.field]=n.collatedBy.field,i=n.ports[r].getBuffer(n.scope,o),P(i,function(n){return n.data[e.field]===t[e.field]})):void 0},f=function(t,e){var n,r,o,i,s,a,u,c,p;for(n={},o=0,s=(c=t.inPorts).length;o<s;o++)if(u=c[o],e.ports[u].isAddressable())for(n[u]={},i=0,a=(p=e.attached(u)).length;i<a;i++)r=p[i],e.hasData([u,r])&&(g(n,t,e,u,r),n[u][r]=e.getData([u,r]));else e.hasData(u)&&(g(n,t,e,u),n[u]=e.getData(u));return 1===t.inPorts.length?n[t.inPorts[0]]:n},l=function(t,e,n){var r,o;return null==(null!=(r=n.result.__bracketContext)?r[e]:void 0)?[]:(null!=(o=n.collatedBy)?o.brackets:void 0)?n.collatedBy.brackets:n.result.__bracketContext[e].filter(function(t){return t.source===e}).map(function(t){return t.ip.data})},h=function(t,e){var n;return n={},t.forEach(function(t){return n[t]={connect:function(){},beginGroup:function(n,o){var i;return i=new r("openBracket",n),i.index=o,e.sendIP(t,i)},send:function(n,o){var i;return i=new r("data",n),i.index=o,e.sendIP(t,i)},endGroup:function(n,o){var i;return i=new r("closeBracket",n),i.index=o,e.sendIP(t,i)},disconnect:function(){}}}),1===t.length?n[t[0]]:n},u=function(t,e,n){var r,o,i,s,a,u,d,l,f,h,g;if(f=p(t,e),i=c(t,e),t.dropInput&&!f){for(l=!1,s=0,u=(g=t.inPorts).length;s<u;s++)if(h=g[s],e.ports[h].isAddressable()){if(!(r=e.attached(h)).length)continue;for(a=0,d=r.length;a<d;a++)for(o=r[a];e.has([h,o]);)l=!0,e.get([h,o]).drop()}else for(;e.has(h);)l=!0,e.get(h).drop();l&&n.done()}return i&&f},p=function(t,e){var n,r,o,i,s,a;for(r=0,o=(s=t.params).length;r<o;r++)if(i=s[r],e.ports[i].isRequired())if(e.ports[i].isAddressable()){if(!(n=e.attached(i)).length)return!1;if(a=n.filter(function(t){return e.hasData([i,t])}),"all"===t.arrayPolicy.params){if(a.length!==n.length)return!1;continue}if(!a.length)return!1}else if(!e.hasData(i))return!1;return!0},c=function(t,e){var n,r,o,i,s,a,u,c,p,d;for(t.group&&(r={},e.collatedBy={brackets:[],ready:!1},o=function(t,e){var n,r,o,i;for(r=o=0,i=t.length;o<i;r=++o)if(n=t[r],e[r]!==n)return!1;return!0},i=function(n,i){var s,a;if(a=i.slice(0),t.group instanceof RegExp){if(!(a=a.slice(0,1)).length)return!1;if(!t.group.test(a[0]))return!1}return e.collatedBy.ready?o(e.collatedBy.brackets,a):(s=a.join(":"),r[s]||(r[s]=[]),-1===r[s].indexOf(c)&&r[s].push(c),t.inPorts.indexOf(c)!==t.inPorts.length-1||r[s].length===t.inPorts.length&&(!e.collatedBy.ready&&(e.collatedBy.ready=!0,e.collatedBy.brackets=a,!0)))}),t.field&&(e.collatedBy={field:void 0,ready:!1}),s=function(n){var r,o,s,a,u,c,p;if(!t.group&&!t.field)return e.hasData(n);if(t.group){for(p=[],[],s=!1,u=0,c=(r=e.ports[n].getBuffer(e.scope)).length;u<c;u++)if("openBracket"!==(a=r[u]).type)if("closeBracket"!==a.type)o=i(a,p);else{if(p.pop(),p.length)continue;if(!o)continue;s=!0}else p.push(a.data);return s}return t.field?e.hasStream(n,function(n){return e.collatedBy.ready?n.data[t.field]===e.collatedBy.field:(e.collatedBy.field=n.data[t.field],e.collatedBy.ready=!0,!0)}):void 0},a=0,u=(p=t.inPorts).length;a<u;a++)if(c=p[a],e.ports[c].isAddressable()){if(!(n=e.attached(c)).length)return!1;if(d=n.filter(function(t){return s([c,t])}),"all"===t.arrayPolicy.in){if(d.length!==n.length)return!1;continue}if(!d.length)return!1}else if(!s(c))return!1;return!0},i=function(){function t(t,e){this.port=t,this.scope=e}return t.prototype.connect=function(t){return null==t&&(t=null),this.port.openBracket(null,{scope:this.scope},t)},t.prototype.beginGroup=function(t,e){return null==e&&(e=null),this.port.openBracket(t,{scope:this.scope},e)},t.prototype.send=function(t,e){return null==e&&(e=null),this.port.sendIP("data",t,{scope:this.scope},e,!1)},t.prototype.endGroup=function(t,e){return null==e&&(e=null),this.port.closeBracket(t,{scope:this.scope},e)},t.prototype.disconnect=function(t){return null==t&&(t=null),this.endGroup(t)},t.prototype.isConnected=function(){return this.port.isConnected()},t.prototype.isAttached=function(){return this.port.isAttached()},t}(),v=function(t,n,r){var a,u,c,p,l,f,h,g,m,v,y,b,w,P,k,E,_,C,S,O,I,A,N,T,R,L,B,G,j;"gcFrequency"in n||(n.gcFrequency=100),"gcTimeout"in n||(n.gcTimeout=300),!1!==(p=n.forwardGroups)&&n.group&&(p=!0);for(m=0,b=(A=n.inPorts).length;m<b;m++)if(S=A[m],!t.inPorts[S])throw new Error("no inPort named '"+S+"'");for(v=0,w=(N=n.outPorts).length;v<w;v++)if(S=N[v],!t.outPorts[S])throw new Error("no outPort named '"+S+"'");l=function(){var e,r,o,i,s;for(s=[],e=0,r=(i=n.outPorts).length;e<r;e++)o=i[e],t.outPorts[o].isConnected()?s.push(t.outPorts[o].disconnect()):s.push(void 0);return s},G=function(e){var r,o,i,s,a;for(a=[],r=0,o=(s=n.outPorts).length;r<o;r++)i=s[r],a.push(t.outPorts[i].beginGroup(e));return a},c=function(e){var r,o,i,s,a;for(a=[],r=0,o=(s=n.outPorts).length;r<o;r++)i=s[r],a.push(t.outPorts[i].endGroup(e));return a},t.requiredParams=[],t.defaultedParams=[],t.gcCounter=0,t._wpData={},a=function(e){return e in t._wpData||(t._wpData[e]={},t._wpData[e].groupedData={},t._wpData[e].groupedGroups={},t._wpData[e].groupedDisconnects={},t._wpData[e].outputQ=[],t._wpData[e].taskQ=[],t._wpData[e].params={},t._wpData[e].completeParams=[],t._wpData[e].receivedParams=[],t._wpData[e].defaultsSent=!1,t._wpData[e].disconnectData={},t._wpData[e].disconnectQ=[],t._wpData[e].groupBuffers={},t._wpData[e].keyBuffers={},t._wpData[e].gcTimestamps={}),t._wpData[e]},t.params={},j=function(e){return t.params=a(e).params},I=function(t){for(var e,r,o,i,s;a(t).outputQ.length>0;){if(i=a(t).outputQ[0],e=!1,null===i)l(),e=!0;else{1===n.outPorts.length&&((s={})[n.outPorts[0]]=i,i=s);for(r in i)(o=i[r]).resolved&&(o.flush(),e=!0)}if(e&&a(t).outputQ.shift(),!e)return}},n.async&&("load"in t.outPorts&&(t.load=0),t.beforeProcess=function(e,r){if(n.ordered&&a(e).outputQ.push(r),t.load++,t.emit("activate",t.load),"load"in t.outPorts&&t.outPorts.load.isAttached())return t.outPorts.load.send(t.load),t.outPorts.load.disconnect()},t.afterProcess=function(e,n,r){return I(e),t.load--,"load"in t.outPorts&&t.outPorts.load.isAttached()&&(t.outPorts.load.send(t.load),t.outPorts.load.disconnect()),t.emit("deactivate",t.load)}),t.sendDefaults=function(e){var n,r,i,s,u;if(t.defaultedParams.length>0)for(n=0,r=(s=t.defaultedParams).length;n<r;n++)i=s[n],-1===a(e).receivedParams.indexOf(i)&&(u=o.createSocket(),t.inPorts[i].attach(u),u.send(),u.disconnect(),t.inPorts[i].detach(u));return a(e).defaultsSent=!0},B=function(e){var n,r,o;if(a(e).completeParams.length===t.requiredParams.length&&a(e).taskQ.length>0){for(o=a(e).taskQ.slice(0),a(e).taskQ=[],n=[];o.length>0;)r=o.shift(),n.push(r());return n}};for(y=0,P=(T=n.params).length;y<P;y++){if(O=T[y],!t.inPorts[O])throw new Error("no inPort named '"+O+"'");t.inPorts[O].isRequired()&&t.requiredParams.push(O),t.inPorts[O].hasDefault()&&t.defaultedParams.push(O)}for(f=function(e){var r;return r=t.inPorts[e],r.handle=function(o){var i,s,u,c;if(i=o.type,u=o.data,c=o.scope,s=o.index,"data"===i){if(r.isAddressable()){if(e in a(c).params||(a(c).params[e]={}),a(c).params[e][s]=u,"all"===n.arrayPolicy.params&&Object.keys(a(c).params[e]).length<r.listAttached().length)return}else a(c).params[e]=u;return-1===a(c).completeParams.indexOf(e)&&t.requiredParams.indexOf(e)>-1&&a(c).completeParams.push(e),a(c).receivedParams.push(e),B(c)}}},_=0,k=(R=n.params).length;_<k;_++)f(O=R[_]);for(t.dropRequest=function(t,e){if(e in a(t).disconnectData&&delete a(t).disconnectData[e],e in a(t).groupedData&&delete a(t).groupedData[e],e in a(t).groupedGroups)return delete a(t).groupedGroups[e]},g=function(){var e,r,o,i,s,u,c,p;if(t.gcCounter++,t.gcCounter%n.gcFrequency==0){for(u=[],i=0,o=(s=Object.keys(t._wpData)).length;i<o;i++)c=s[i],e=(new Date).getTime(),u.push(function(){var o,i;o=a(c).gcTimestamps,i=[];for(r in o)p=o[r],e-p>1e3*n.gcTimeout?(t.dropRequest(c,r),i.push(delete a(c).gcTimestamps[r])):i.push(void 0);return i}());return u}},h=function(o){var u,f;return u=t.inPorts[o],f=p instanceof Array&&-1!==p.indexOf(o),u.handle=function(h){var m,v,y,b,w,P,k,E,_,C,O,A,N,T,R,L,F,M,q,U,z,H,Y,W,J,K,X,V,Q,Z,$,tt,et,nt,rt,ot,it;switch(k=h.index,F=h.data,Z=h.scope,o in a(Z).groupBuffers||(a(Z).groupBuffers[o]=[]),o in a(Z).keyBuffers||(a(Z).keyBuffers[o]=null),h.type){case"openBracket":if(null===F)return;if(a(Z).groupBuffers[o].push(F),n.forwardGroups&&(!0===p||f)&&!n.async)return G(F);break;case"closeBracket":if(a(Z).groupBuffers[o]=a(Z).groupBuffers[o].slice(0,a(Z).groupBuffers[o].length-1),!n.forwardGroups||!0!==p&&!f||n.async||c(F),0===a(Z).groupBuffers[o].length){if(1===n.inPorts.length)return n.async||n.StreamSender?n.ordered?(a(Z).outputQ.push(null),I(Z)):a(Z).disconnectQ.push(!0):l();v=!1,(E=a(Z).keyBuffers[o])in a(Z).disconnectData||(a(Z).disconnectData[E]=[]);for(P=N=0,H=a(Z).disconnectData[E].length;0<=H?N<H:N>H;P=0<=H?++N:--N)if(!(o in a(Z).disconnectData[E][P])){v=!0,a(Z).disconnectData[E][P][o]=!0,Object.keys(a(Z).disconnectData[E][P]).length===n.inPorts.length&&(a(Z).disconnectData[E].shift(),n.async||n.StreamSender?n.ordered?(a(Z).outputQ.push(null),I(Z)):a(Z).disconnectQ.push(!0):l(),0===a(Z).disconnectData[E].length&&delete a(Z).disconnectData[E]);break}if(!v)return T={},T[o]=!0,a(Z).disconnectData[E].push(T)}break;case"data":if(1!==n.inPorts.length||u.isAddressable()){if(E="",n.group&&a(Z).groupBuffers[o].length>0){if(E=a(Z).groupBuffers[o].toString(),n.group instanceof RegExp){for(K=null,U=0,_=(Y=a(Z).groupBuffers[o]).length;U<_;U++)if(w=Y[U],n.group.test(w)){K=w;break}E=K||""}}else n.field&&"object"==typeof F&&n.field in F&&(E=F[n.field]);a(Z).keyBuffers[o]=E,E in a(Z).groupedData||(a(Z).groupedData[E]=[]),E in a(Z).groupedGroups||(a(Z).groupedGroups[E]=[]),v=!1,X=n.inPorts.length,n.field&&++X;for(P=z=0,W=a(Z).groupedData[E].length;0<=W?z<W:z>W;P=0<=W?++z:--z)if(!(o in a(Z).groupedData[E][P])||t.inPorts[o].isAddressable()&&"all"===n.arrayPolicy.in&&!(k in a(Z).groupedData[E][P][o])){if(v=!0,t.inPorts[o].isAddressable()?(o in a(Z).groupedData[E][P]||(a(Z).groupedData[E][P][o]={}),a(Z).groupedData[E][P][o][k]=F):a(Z).groupedData[E][P][o]=F,f?a(Z).groupedGroups[E][P]=D.unique(x.call(a(Z).groupedGroups[E][P]).concat(x.call(a(Z).groupBuffers[o]))):!0===p&&(a(Z).groupedGroups[E][P][o]=a(Z).groupBuffers[o]),t.inPorts[o].isAddressable()&&"all"===n.arrayPolicy.in&&Object.keys(a(Z).groupedData[E][P][o]).length<t.inPorts[o].listAttached().length)return;if(Object.keys(a(Z).groupedData[E][P]).length===X){m=a(Z).groupedData[E].splice(P,1)[0],1===n.inPorts.length&&u.isAddressable()&&(m=m[o]),b=a(Z).groupedGroups[E].splice(P,1)[0],!0===p&&(b=D.intersection.apply(null,D.getValues(b))),0===a(Z).groupedData[E].length&&delete a(Z).groupedData[E],0===a(Z).groupedGroups[E].length&&delete a(Z).groupedGroups[E],n.group&&E&&delete a(Z).gcTimestamps[E];break}return}if(!v){if(T={},n.field&&(T[n.field]=E),t.inPorts[o].isAddressable()?(T[o]={},T[o][k]=F):T[o]=F,1!==n.inPorts.length||!t.inPorts[o].isAddressable()||"any"!==n.arrayPolicy.in&&1!==t.inPorts[o].listAttached().length)return a(Z).groupedData[E].push(T),f?a(Z).groupedGroups[E].push(a(Z).groupBuffers[o]):!0===p?((et={})[o]=a(Z).groupBuffers[o],a(Z).groupedGroups[E].push(et)):a(Z).groupedGroups[E].push([]),void(n.group&&E&&(a(Z).gcTimestamps[E]=(new Date).getTime()));m=T[o],b=a(Z).groupBuffers[o]}}else m=F,b=a(Z).groupBuffers[o];if(n.dropInput&&a(Z).completeParams.length!==t.requiredParams.length)return;for(L={},Q=0,C=(J=n.outPorts).length;Q<C;Q++)S=J[Q],it=new i(t.outPorts[S],Z),n.async||n.sendStreams&&-1!==n.sendStreams.indexOf(S)?L[S]=new s(it,n.ordered):L[S]=it;if(1===n.outPorts.length&&(L=L[n.outPorts[0]]),b||(b=[]),b=function(){var t,e,n;for(e=[],n=0,t=b.length;n<t;n++)null!==(y=b[n])&&e.push(y);return e}(),ot=b.slice(0),rt=function(e){var r,i,s,u,c;e&&t.error(e,ot,"error",Z),"function"==typeof t.fail&&t.hasErrors&&t.fail(null,[],Z),u=L,1===n.outPorts.length&&((u={})[o]=L),r=!1,a(Z).disconnectQ.length>0&&(a(Z).disconnectQ.shift(),r=!0);for(S in u){if(s=u[S],n.forwardGroups&&n.async)for(c=0,i=ot.length;c<i;c++)P=ot[c],s.endGroup();r&&s.disconnect(),(n.async||n.StreamSender)&&s.done()}if("function"==typeof t.afterProcess)return t.afterProcess(Z,e||t.hasErrors,L)},"function"==typeof t.beforeProcess&&t.beforeProcess(Z,L),n.forwardGroups&&n.async)if(1===n.outPorts.length)for($=0,O=b.length;$<O;$++)y=b[$],L.beginGroup(y);else for(S in L)for(R=L[S],nt=0,A=b.length;nt<A;nt++)y=b[nt],R.beginGroup(y);return e.MultiError(t,n.name,n.error,b,Z),d("WirePattern Legacy API call with",m,b,t.params,Z),n.async?(M=function(){},V=function(){},q=!1,tt=function(){return j(Z),r.call(t,m,b,L,rt,M,V,Z)},M=function(t){if(null==t&&(t=!0),q=t,t)return a(Z).taskQ.push(tt)},V=function(){return q?B():tt()}):tt=function(){return j(Z),r.call(t,m,b,L,null,null,null,Z),rt()},a(Z).taskQ.push(tt),B(Z),g()}}},C=0,E=(L=n.inPorts).length;C<E;C++)h(O=L[C]);return u=t.tearDown,t.tearDown=function(e){return t.requiredParams=[],t.defaultedParams=[],t.gcCounter=0,t._wpData={},t.params={},u.call(t,e)},t},e.GroupedInput=e.WirePattern,e.CustomError=function(t,n){var r;return r=new Error(t),e.CustomizeError(r,n)},e.CustomizeError=function(t,e){var n,r;for(n in e)S.call(e,n)&&(r=e[n],t[n]=r);return t},e.MultiError=function(t,e,n,r,o){var i;return null==e&&(e=""),null==n&&(n="error"),null==r&&(r=[]),null==o&&(o=null),y.deprecated("noflo.helpers.MultiError is deprecated. Send errors to error port instead"),t.hasErrors=!1,t.errors=[],t.name&&!e&&(e=t.name),e||(e="Component"),t.error=function(e,n){return null==n&&(n=[]),t.errors.push({err:e,groups:r.concat(n)}),t.hasErrors=!0},t.fail=function(r,i){var s,a,u,c,p,d,l,f,h,g,m;if(null==r&&(r=null),null==i&&(i=[]),r&&t.error(r,i),t.hasErrors&&n in t.outPorts&&t.outPorts[n].isAttached()){for(e&&t.outPorts[n].openBracket(e,{scope:o}),u=0,d=(h=t.errors).length;u<d;u++){for(c=0,l=(g=(s=h[u]).groups).length;c<l;c++)a=g[c],t.outPorts[n].openBracket(a,{scope:o});for(t.outPorts[n].data(s.err,{scope:o}),p=0,f=(m=s.groups).length;p<f;p++)a=m[p],t.outPorts[n].closeBracket(a,{scope:o})}return e&&t.outPorts[n].closeBracket(e,{scope:o}),t.hasErrors=!1,t.errors=[]}},i=t.tearDown,t.tearDown=function(e){return t.hasErrors=!1,t.errors=[],i.call(t,e)},t}}).call(this)}).call(e,n(1))},function(t,e,n){(function(){var t,r,o,i=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;o=n(11),r=n(5),t=function(t){function e(t){this.type=t,r.deprecated("noflo.ArrayPort is deprecated. Please port to noflo.InPort/noflo.OutPort and use addressable: true"),e.__super__.constructor.call(this,this.type)}return i(e,t),e.prototype.attach=function(t,e){return null==e&&(e=null),null===e&&(e=this.sockets.length),this.sockets[e]=t,this.attachSocket(t,e)},e.prototype.connect=function(t){null==t&&(t=null);{if(null!==t){if(!this.sockets[t])throw new Error(this.getId()+": No connection '"+t+"' available");return this.sockets[t].connect()}if(!this.sockets.length)throw new Error(this.getId()+": No connections available");this.sockets.forEach(function(t){if(t)return t.connect()})}},e.prototype.beginGroup=function(t,e){null==e&&(e=null);{if(null!==e){if(!this.sockets[e])throw new Error(this.getId()+": No connection '"+e+"' available");return this.isConnected(e)?this.sockets[e].beginGroup(t):(this.sockets[e].once("connect",function(n){return function(){return n.sockets[e].beginGroup(t)}}(this)),this.sockets[e].connect())}if(!this.sockets.length)throw new Error(this.getId()+": No connections available");this.sockets.forEach(function(e){return function(n,r){if(n)return e.beginGroup(t,r)}}(this))}},e.prototype.send=function(t,e){null==e&&(e=null);{if(null!==e){if(!this.sockets[e])throw new Error(this.getId()+": No connection '"+e+"' available");return this.isConnected(e)?this.sockets[e].send(t):(this.sockets[e].once("connect",function(n){return function(){return n.sockets[e].send(t)}}(this)),this.sockets[e].connect())}if(!this.sockets.length)throw new Error(this.getId()+": No connections available");this.sockets.forEach(function(e){return function(n,r){if(n)return e.send(t,r)}}(this))}},e.prototype.endGroup=function(t){null==t&&(t=null);{if(null!==t){if(!this.sockets[t])throw new Error(this.getId()+": No connection '"+t+"' available");return this.sockets[t].endGroup()}if(!this.sockets.length)throw new Error(this.getId()+": No connections available");this.sockets.forEach(function(t){return function(e,n){if(e)return t.endGroup(n)}}(this))}},e.prototype.disconnect=function(t){var e,n,r,o;if(null==t&&(t=null),null!==t){if(this.sockets[t])return this.sockets[t].disconnect()}else{if(!this.sockets.length)throw new Error(this.getId()+": No connections available");for(e=0,n=(r=this.sockets).length;e<n;e++){if(!(o=r[e]))return;o.disconnect()}}},e.prototype.isConnected=function(t){var e;return null==t&&(t=null),null===t?(e=!1,this.sockets.forEach(function(t){if(t)return t.isConnected()?e=!0:void 0}),e):!!this.sockets[t]&&this.sockets[t].isConnected()},e.prototype.isAddressable=function(){return!0},e.prototype.isAttached=function(t){var e,n,r;if(void 0===t){for(e=0,n=(r=this.sockets).length;e<n;e++)if(r[e])return!0;return!1}return!!this.sockets[t]},e}(o.Port),e.ArrayPort=t}).call(this)},function(t,e,n){(function(t){(function(){var r,o,i,s,a,u,c,p,d,l,f,h;r=n(10).ComponentLoader,s=n(15).Network,i=n(4),u=n(7),o=n(8).Graph,c=function(e,n){return e||(e={}),e.name||(e.name=n),e.loader&&(e.baseDir=e.loader.baseDir),!e.baseDir&&t&&t.cwd&&(e.baseDir=t.cwd()),e.loader||(e.loader=new r(e.baseDir)),e.raw||(e.raw=!1),e},l=function(t,e,n){return e.loader.load(t,function(r,i){var a,u,c,p,d,l;if(r)return n(r);a=new o(e.name),p=e.name,a.addNode(p,t),u=i.inPorts.ports||i.inPorts,d=i.outPorts.ports||i.outPorts;for(l in u)u[l],a.addInport(l,p,l);for(l in d)d[l],a.addOutport(l,p,l);return a.componentLoader=e.loader,(c=new s(a,e)).connect(function(t){return t?n(t):n(null,c)})})},f=function(t,e,n,r){var o,s,a,c,p,d;return p=t.getNode(n.name),o=Object.keys(t.graph.inports),s={},o.forEach(function(t){return s[t]=u.createSocket(),p.component.inPorts[t].attach(s[t])}),d=[],a=Object.keys(t.graph.outports),c={},a.forEach(function(t){return c[t]=u.createSocket(),p.component.outPorts[t].attach(c[t]),c[t].on("ip",function(e){var n;return n={},n[t]=e,d.push(n)})}),t.once("end",function(){var t,e;for(t in c)e=c[t],p.component.outPorts[t].detach(e);return c={},s={},r(null,d)}),t.start(function(t){var n,o,a,u,c,p;if(t)return r(t);for(c=[],n=0,a=e.length;n<a;n++)o=e[n],c.push(function(){var t;t=[];for(u in o)p=o[u],i.isIP(p)?s[u].post(p):t.push(s[u].post(new i("data",p)));return t}());return c})},a=function(t,e){var n;if("object"!=typeof t)return"simple";if(Array.isArray(t))return t.filter(function(t){return"map"===a(t,e)}).length===t.length?"sequence":"simple";if(!Object.keys(t).length)return"simple";for(n in t)if(t[n],!e.graph.inports[n])return"simple";return"map"},d=function(t,e,n){var r,o;return"sequence"===e?t:"map"===e?[t]:(r=Object.keys(n.graph.inports)[0],n.graph.inports.in&&(r="in"),o={},o[r]=t,[o])},p=function(t,e){var n,r,o,i,s,a;if(e.raw)return t;for(s=null,n=a=[],r=0,o=t.length;r<o;r++)"openBracket"===(i=t[r]).type&&(s=n,n=[],s.push(n)),"data"===i.type&&n.push(i.data),"closeBracket"===i.type&&(n=s);return 1===a.length?a[0]:a},h=function(t,e,n,r){var o,i,s,a,u,c,d,l,f,h,g,m;if((o=t.filter(function(t){return null!=t.error}).map(function(t){return t.error})).length)return r(p(o,n));if("sequence"===e)return r(null,t.map(function(t){var e,r,o;r={};for(e in t)o=t[e],n.raw?r[e]=o:r[e]=p([o],n);return r}));for(c={},i=0,a=t.length;i<a;i++){u=t[i];for(s in u)g=u[s],c[s]||(c[s]=[]),c[s].push(g)}if(d=Object.keys(c),0===(m=d.filter(function(t){return c[t].length>0})).length)return r(null);if(1===m.length&&"simple"===e)return r(null,p(c[m[0]],n));h={};for(f in c)l=c[f],h[f]=p(l,n);return r(null,h)},e.asCallback=function(t,e){return e=c(e,t),function(n,r){return l(t,e,function(t,o){var i,s;return t?r(t):(s=a(n,o),i=d(n,s,o),f(o,i,e,function(t,n){return t?r(t):h(n,s,e,r)}))})}}}).call(this)}).call(e,n(1))},function(t,e,n){t.exports={iframe:n(94),opener:n(108)}},function(t,e,n){!function(e){var r=n(23),o=function(t){r.call(this,t),this.setClient(e.parent)};o.prototype=new r,t.exports=function(t){t=r.normalizeOptions(t);var n=new o(t);return r.subscribe(e,function(t,e){"iframe"!==t.protocol||"setcontent"!==t.command?n.receive(t.protocol,t.command,t.payload,{href:e.origin}):document.body.innerHTML=t.payload}),n}}(window)},function(t,e,n){(function(){var e,r,o,i,s,a,u,c=function(t,e){function n(){this.constructor=t}for(var r in e)p.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},p={}.hasOwnProperty;i=n(0),e=n(2).EventEmitter,u=function(t,e,n){var r;switch(r=i.internalSocket.createSocket(),t.attach(r),e){case"connect":r.connect();break;case"disconnect":r.disconnect();break;case"begingroup":r.beginGroup(n);break;case"endgroup":r.endGroup(n);break;case"data":r.send(n)}return t.detach(r)},o=function(t,e,n){var r,o,i;if(t.graph&&(null!=(o=n?t.graph.inports[e]:t.graph.outports[e])?o.process:void 0)&&(r=null!=(i=t.getNode(o.process))?i.component:void 0))return n?r.inPorts[o.port]:r.outPorts[o.port]},s=function(t,e,n,r){var i,s,a,u;return i={id:t,type:"all",description:null!=(a=e.metadata)?a.description:void 0,addressable:!1,required:!1},(s=o(n,t,r))?(i.type=s.getDataType(),s.getSchema&&(i.schema=s.getSchema()),i.description=(null!=(u=e.metadata)?u.description:void 0)||s.getDescription(),i.addressable=s.isAddressable(),i.required=s.isRequired(),i):i},a=function(t,e){var n,r,o,i,a;if(r={graph:t,inPorts:[],outPorts:[]},!(null!=e?e.graph:void 0))return r;i=e.graph.inports;for(o in i)n=i[o],r.inPorts.push(s(o,n,e,!0));a=e.graph.outports;for(o in a)n=a[o],r.outPorts.push(s(o,n,e,!1));return r},r=function(t){function n(t){this.transport=t,this.outputSockets={},this.mainGraph=null,this.transport.network.on("addnetwork",function(t){return function(e,n){return t.subscribeExportedPorts(n,e,!0),t.subscribeOutPorts(n,e),t.sendPorts(n,e),e.isStarted()&&t.subscribeOutdata(n,e,!0),e.on("start",function(){return t.subscribeOutdata(n,e,!0)})}}(this)),this.transport.network.on("removenetwork",function(t){return function(e,n){return t.subscribeOutdata(n,e,!1),t.subscribeOutPorts(n,e),t.subscribeExportedPorts(n,e.graph,!1),t.sendPorts(n,null)}}(this))}return c(n,e),n.prototype.send=function(t,e,n){return this.transport.send("runtime",t,e,n)},n.prototype.sendAll=function(t,e){return this.transport.sendAll("runtime",t,e)},n.prototype.sendError=function(t,e){return this.send("error",new Error(t),e)},n.prototype.receive=function(t,e,n){if("packet"!==t||this.transport.canDo("protocol:runtime",e.secret))switch(t){case"getruntime":return this.getRuntime(e,n);case"packet":return this.sendPacket(e,function(t){return function(e){e&&t.sendError(e.message,n)}}(this))}else this.send("error",new Error(t+" not permitted"),n)},n.prototype.getRuntime=function(t,e){var n,r,o,s,a,u,c;(c=this.transport.options.type)||(c=i.isBrowser()?"noflo-browser":"noflo-nodejs"),(n=this.transport.options.capabilities)||(n=["protocol:graph","protocol:component","protocol:network","protocol:runtime","component:setsource","component:getsource"]),s=n.filter(function(e){return function(n){return e.transport.canDo(n,t.secret)}}(this)),t={type:c,version:this.transport.version,capabilities:s,allCapabilities:n},this.mainGraph&&(t.graph=this.mainGraph),this.transport.options.id&&(t.id=this.transport.options.id),this.transport.options.label&&(t.label=this.transport.options.label),this.transport.options.namespace&&(t.namespace=this.transport.options.namespace),this.transport.options.repository&&(t.repository=this.transport.options.repository),this.transport.options.repositoryVersion&&(t.repositoryVersion=this.transport.options.repositoryVersion),this.send("runtime",t,e),a=this.transport.network.networks,u=[];for(r in a)o=a[r],u.push(this.sendPorts(r,o,e));return u},n.prototype.sendPorts=function(t,e,n){var r;return r=a(t,e),this.emit("ports",r),n?this.send("ports",r,n):this.sendAll("ports",r)},n.prototype.setMainGraph=function(t){return this.mainGraph=t},n.prototype.subscribeExportedPorts=function(t,e,n){var r,o,i,s,a,u,c,p;for(p=function(n){return function(){return n.sendPorts(t,e)}}(this),i=0,a=(o=["addInport","addOutport","removeInport","removeOutport"]).length;i<a;i++)r=o[i],e.graph.removeListener(r,p);if(n){for(c=[],s=0,u=o.length;s<u;s++)r=o[s],c.push(e.graph.on(r,p));return c}},n.prototype.subscribeOutPorts=function(t,e,n){var r,o,i;if(i=function(n){return function(){return n.subscribeOutdata(t,e,!1)}}(this),o=function(n){return function(){return n.subscribeOutdata(t,e,!0)}}(this),(r=e.graph).removeListener("addOutport",o),r.removeListener("removeOutport",i),n)return r.on("addOutport",o),r.on("removeOutport",i)},n.prototype.subscribeOutdata=function(t,e,n){var r,o,s,a,u,c,p;o=["data","begingroup","endgroup","connect","disconnect"],this.outputSockets[t]||(this.outputSockets[t]={}),s=this.outputSockets[t];for(c in s)for(p=s[c],a=0,u=o.length;a<u;a++)r=o[a],p.removeAllListeners(r);if(s={},n)return Object.keys(e.graph.outports).forEach(function(n){return function(a){var u,c,d,l,f;for(u=e.graph.outports[a],p=i.internalSocket.createSocket(),s[a]=p,e.processes[u.process].component.outPorts[u.port].attach(p),f=function(e){return function(r){return n.emit("packet",{port:a,event:e,graph:t,payload:r}),n.sendAll("packet",{port:a,event:e,graph:t,payload:r})}},l=[],c=0,d=o.length;c<d;c++)r=o[c],l.push(p.on(r,f(r)));return l}}(this))},n.prototype.sendPacket=function(t,e){var n,r;return(n=this.transport.network.networks[t.graph])?(r=o(n.network,t.port,!0))?u(r,t.event,t.payload):e(new Error("Cannot find internal port for "+t.port)):e(new Error("Cannot find network for graph "+t.graph))},n}(),t.exports=r}).call(this)},function(t,e,n){(function(){var e,r;r=n(0),e=function(){function t(t){this.transport=t,this.graphs={}}return t.prototype.send=function(t,e,n){return this.transport.send("graph",t,e,n)},t.prototype.sendAll=function(t,e){return this.transport.sendAll("graph",t,e)},t.prototype.receive=function(t,e,n){var r;if(this.transport.canDo("protocol:graph",e.secret))if("clear"===t||(r=this.resolveGraph(e,n)))switch(t){case"clear":return this.initGraph(e,n);case"addnode":return this.addNode(r,e,n);case"removenode":return this.removeNode(r,e,n);case"renamenode":return this.renameNode(r,e,n);case"changenode":return this.changeNode(r,e,n);case"addedge":return this.addEdge(r,e,n);case"removeedge":return this.removeEdge(r,e,n);case"changeedge":return this.changeEdge(r,e,n);case"addinitial":return this.addInitial(r,e,n);case"removeinitial":return this.removeInitial(r,e,n);case"addinport":return this.addInport(r,e,n);case"removeinport":return this.removeInport(r,e,n);case"renameinport":return this.renameInport(r,e,n);case"addoutport":return this.addOutport(r,e,n);case"removeoutport":return this.removeOutport(r,e,n);case"renameoutport":return this.renameOutport(r,e,n);case"addgroup":return this.addGroup(r,e,n);case"removegroup":return this.removeGroup(r,e,n);case"renamegroup":return this.renameGroup(r,e,n);case"changegroup":return this.changeGroup(r,e,n)}else this.send("error",new Error("Graph '"+e.graph+"' not found"),n);else this.send("error",new Error(t+" not permitted"),n)},t.prototype.resolveGraph=function(t,e){if(t.graph){if(this.graphs[t.graph])return this.graphs[t.graph];this.send("error",new Error("Requested graph not found"),e)}else this.send("error",new Error("No graph specified"),e)},t.prototype.getLoader=function(t){return this.transport.component.getLoader(t,this.transport.options)},t.prototype.sendGraph=function(t,e,n){var r;return r={graph:t,description:e.toJSON()},this.send("graph",r,n)},t.prototype.initGraph=function(t,e){var n,o;{if(t.id)return t.name||(t.name="NoFlo runtime"),o=new r.Graph(t.name),n=t.id,t.library&&(t.library=t.library.replace("noflo-",""),o.properties.library=t.library,n=t.library+"/"+n),t.icon&&(o.properties.icon=t.icon),t.description&&(o.properties.description=t.description),o.baseDir=this.transport.options.baseDir,this.subscribeGraph(t.id,o,e),t.main?this.transport.runtime.setMainGraph(n,o,e):this.transport.component.registerGraph(n,o,e),this.graphs[t.id]=o,this.sendAll("clear",{id:t.id,name:t.name,library:t.library,main:t.main,icon:t.icon,description:t.description},e);this.send("error",new Error("No graph ID provided"),e)}},t.prototype.registerGraph=function(t,e){return"default/main"===t&&this.transport.runtime.setMainGraph(t,e),this.subscribeGraph(t,e,""),this.graphs[t]=e},t.prototype.subscribeGraph=function(t,e,n){return e.on("addNode",function(e){return function(r){return r.graph=t,e.sendAll("addnode",r,n)}}(this)),e.on("removeNode",function(e){return function(r){var o;return o={id:r.id,graph:t},e.sendAll("removenode",o,n)}}(this)),e.on("renameNode",function(e){return function(r,o){return e.sendAll("renamenode",{from:r,to:o,graph:t},n)}}(this)),e.on("changeNode",function(e){return function(r,o){return e.sendAll("changenode",{id:r.id,metadata:r.metadata,graph:t},n)}}(this)),e.on("addEdge",function(e){return function(r){var o;return"number"!=typeof r.from.index&&delete r.from.index,"number"!=typeof r.to.index&&delete r.to.index,o={src:r.from,tgt:r.to,metadata:r.metadata,graph:t},e.sendAll("addedge",o,n)}}(this)),e.on("removeEdge",function(e){return function(r){var o;return o={src:r.from,tgt:r.to,graph:t},e.sendAll("removeedge",o,n)}}(this)),e.on("changeEdge",function(e){return function(r){var o;return o={src:r.from,tgt:r.to,metadata:r.metadata,graph:t},e.sendAll("changeedge",o,n)}}(this)),e.on("addInitial",function(e){return function(r){var o;return o={src:r.from,tgt:r.to,metadata:r.metadata,graph:t},e.sendAll("addinitial",o,n)}}(this)),e.on("removeInitial",function(e){return function(r){var o;return o={src:r.from,tgt:r.to,graph:t},e.sendAll("removeinitial",o,n)}}(this)),e.on("addGroup",function(e){return function(r){var o;return o={name:r.name,nodes:r.nodes,metadata:r.metadata,graph:t},e.sendAll("addgroup",o,n)}}(this)),e.on("removeGroup",function(e){return function(r){var o;return o={name:r.name,graph:t},e.sendAll("removegroup",o,n)}}(this)),e.on("renameGroup",function(e){return function(r,o){var i;return i={from:r,to:o,graph:t},e.sendAll("renamegroup",i,n)}}(this)),e.on("changeGroup",function(e){return function(r){var o;return o={name:r.name,metadata:r.metadata,graph:t},e.sendAll("changegroup",o,n)}}(this)),e.on("addInport",function(e){return function(r,o){var i;return i={public:r,node:o.process,port:o.port,metadata:o.metadata,graph:t},e.sendAll("addinport",i,n)}}(this)),e.on("addOutport",function(e){return function(r,o){var i;return i={public:r,node:o.process,port:o.port,metadata:o.metadata,graph:t},e.sendAll("addoutport",i,n)}}(this)),e.on("removeInport",function(e){return function(r,o){var i;return i={public:r,graph:t},e.sendAll("removeinport",i,n)}}(this)),e.on("removeOutport",function(e){return function(r,o){var i;return i={public:r,graph:t},e.sendAll("removeoutport",i,n)}}(this))},t.prototype.addNode=function(t,e,n){if(e.id||e.component)return t.addNode(e.id,e.component,e.metadata);this.send("error",new Error("No ID or component supplied"),n)},t.prototype.removeNode=function(t,e,n){if(e.id)return t.removeNode(e.id);this.send("error",new Error("No ID supplied"),n)},t.prototype.renameNode=function(t,e,n){if(e.from||e.to)return t.renameNode(e.from,e.to);this.send("error",new Error("No from or to supplied"),n)},t.prototype.changeNode=function(t,e,n){if(e.id||e.metadata)return t.setNodeMetadata(e.id,e.metadata);this.send("error",new Error("No id or metadata supplied"),n)},t.prototype.addEdge=function(t,e,n){if(e.src||e.tgt){if("number"!=typeof e.src.index&&"number"!=typeof e.tgt.index||!t.addEdgeIndex)return t.addEdge(e.src.node,e.src.port,e.tgt.node,e.tgt.port,e.metadata);t.addEdgeIndex(e.src.node,e.src.port,e.src.index,e.tgt.node,e.tgt.port,e.tgt.index,e.metadata)}else this.send("error",new Error("No src or tgt supplied"),n)},t.prototype.removeEdge=function(t,e,n){if(e.src||e.tgt)return t.removeEdge(e.src.node,e.src.port,e.tgt.node,e.tgt.port);this.send("error",new Error("No src or tgt supplied"),n)},t.prototype.changeEdge=function(t,e,n){if(e.src||e.tgt)return t.setEdgeMetadata(e.src.node,e.src.port,e.tgt.node,e.tgt.port,e.metadata);this.send("error",new Error("No src or tgt supplied"),n)},t.prototype.addInitial=function(t,e,n){if(e.src||e.tgt){if(!t.addInitialIndex||"number"!=typeof e.tgt.index)return t.addInitial(e.src.data,e.tgt.node,e.tgt.port,e.metadata);t.addInitialIndex(e.src.data,e.tgt.node,e.tgt.port,e.tgt.index,e.metadata)}else this.send("error",new Error("No src or tgt supplied"),n)},t.prototype.removeInitial=function(t,e,n){if(e.tgt)return t.removeInitial(e.tgt.node,e.tgt.port);this.send("error",new Error("No tgt supplied"),n)},t.prototype.addInport=function(t,e,n){if(e.public||e.node||e.port)return t.addInport(e.public,e.node,e.port,e.metadata);this.send("error",new Error("Missing exported inport information"),n)},t.prototype.removeInport=function(t,e,n){if(e.public)return t.removeInport(e.public);this.send("error",new Error("Missing exported inport name"),n)},t.prototype.renameInport=function(t,e,n){if(e.from||e.to)return t.renameInport(e.from,e.to);this.send("error",new Error("No from or to supplied"),n)},t.prototype.addOutport=function(t,e,n){if(e.public||e.node||e.port)return t.addOutport(e.public,e.node,e.port,e.metadata);this.send("error",new Error("Missing exported outport information"),n)},t.prototype.removeOutport=function(t,e,n){if(e.public)return t.removeOutport(e.public);this.send("error",new Error("Missing exported outport name"),n)},t.prototype.renameOutport=function(t,e,n){if(e.from||e.to)return t.renameOutport(e.from,e.to);this.send("error",new Error("No from or to supplied"),n)},t.prototype.addGroup=function(t,e,n){if(e.name||e.nodes||e.metadata)return t.addGroup(e.name,e.nodes,e.metadata);this.send("error",new Error("No name or nodes or metadata supplied"),n)},t.prototype.removeGroup=function(t,e,n){if(e.name)return t.removeGroup(e.name);this.send("error",new Error("No name supplied"),n)},t.prototype.renameGroup=function(t,e,n){if(e.from||e.to)return t.renameGroup(e.from,e.to);this.send("error",new Error("No from or to supplied"),n)},t.prototype.changeGroup=function(t,e,n){if(e.name||e.metadata)return t.setEdgeMetadata(e.name,e.metadata);this.send("error",new Error("No name or metadata supplied"),n)},t}(),t.exports=e}).call(this)},function(t,e,n){(function(e){(function(){var r,o,i,s,a,u,c,p,d=function(t,e){function n(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},l={}.hasOwnProperty;c=n(0),r=n(2).EventEmitter,p=function(t,n){var r,o,i,s;if(r={id:t.id,graph:n.graph},t.socket.from&&(r.src={node:t.socket.from.process.id,port:t.socket.from.port}),t.socket.to&&(r.tgt={node:t.socket.to.process.id,port:t.socket.to.port}),t.subgraph&&(r.subgraph=t.subgraph),t.group&&(r.group=t.group),t.datatype&&(r.type=t.datatype),t.schema&&(r.schema=t.schema),void 0!==t.data){if(c.isBrowser()||e.isBuffer(t.data)&&(t.data=t.data.slice(0,20)),(null!=(o=t.data)?o.toJSON:void 0)&&(r.data=t.data.toJSON()),null!=(i=t.data)?i.toString:void 0){if(r.data=t.data.toString(),"[object Object]"===r.data)try{r.data=JSON.parse(JSON.stringify(t.data))}catch(t){}}else r.data=t.data;(null!=(s=t.metadata)?s.secure:void 0)&&(r.data="DATA")}return r},a=function(t){return t?t.process+"("+t.port+")":""},s=function(t){return a(t.src)+" -> "+a(t.tgt)},i=function(t){return t?t.process.id+"("+t.port+")":""},u=function(t){return i(t.from)+" -> "+i(t.to)},o=function(t){function e(t){this.transport=t,this.networks={}}return d(e,r),e.prototype.send=function(t,e,n){return this.transport.send("network",t,e,n)},e.prototype.sendAll=function(t,e){return this.transport.sendAll("network",t,e)},e.prototype.receive=function(t,e,n){var r;if(this.transport.canDo("protocol:network",e.secret)){if("list"===t||(r=this.resolveGraph(e,n)))switch(t){case"start":return this.startNetwork(r,e,n);case"stop":return this.stopNetwork(r,e,n);case"edges":return this.updateEdgesFilter(r,e,n);case"debug":return this.debugNetwork(r,e,n);case"getstatus":return this.getStatus(r,e,n)}}else this.send("error",new Error(t+" not permitted"),n)},e.prototype.resolveGraph=function(t,e){if(t.graph){if(this.transport.graph.graphs[t.graph])return this.transport.graph.graphs[t.graph];this.send("error",new Error("Requested graph not found"),e)}else this.send("error",new Error("No graph specified"),e)},e.prototype.updateEdgesFilter=function(t,e,n){var r,o,i,a,u,c;for((a=this.networks[e.graph])?a.filters={}:(a={network:null,filters:{}},this.networks[e.graph]=a),o=0,i=(u=e.edges).length;o<i;o++)r=u[o],c=s(r),a.filters[c]=!0;return this.send("edges",{graph:e.graph,edges:e.edges},n)},e.prototype.eventFiltered=function(t,e){var n;return!this.transport.options.filterData||(n=u(e.socket),this.networks[t].filters[n])},e.prototype.initNetwork=function(t,e,n,r){var o,i;{if(!this.networks[e.graph]||!this.networks[e.graph].network)return t.componentLoader=this.transport.component.getLoader(t.baseDir,this.transport.options),i=JSON.parse(JSON.stringify(this.transport.options)),i.delay=!0,c.createNetwork(t,function(t){return function(o,i){return o?r(o):(t.networks[e.graph]&&t.networks[e.graph].network?t.networks[e.graph].network=i:t.networks[e.graph]={network:i,filters:{}},t.emit("addnetwork",i,e.graph,t.networks),t.subscribeNetwork(i,e,n),i.connect(r))}}(this),i);(o=this.networks[e.graph].network).stop(function(i){return function(s){return s?r(s):(delete i.networks[e.graph],i.emit("removenetwork",o,e.graph,i.networks),i.initNetwork(t,e,n,r))}}(this))}},e.prototype.subscribeNetwork=function(t,e,n){return t.on("start",function(r){return function(o){return r.sendAll("started",{time:o.start,graph:e.graph,running:t.isRunning(),started:t.isStarted()},n)}}(this)),t.on("end",function(r){return function(o){return r.sendAll("stopped",{time:new Date,uptime:o.uptime,graph:e.graph,running:t.isRunning(),started:t.isStarted()},n)}}(this)),t.on("icon",function(t){return function(r){return r.graph=e.graph,t.sendAll("icon",r,n)}}(this)),t.on("connect",function(t){return function(r){if(t.eventFiltered(e.graph,r))return t.sendAll("connect",p(r,e),n)}}(this)),t.on("ip",function(t){return function(r){var o;if(t.eventFiltered(e.graph,r)){switch(o={id:r.id,socket:r.socket,subgraph:r.subgraph,metadata:r.metadata},r.type){case"openBracket":o.type="begingroup",o.group=r.data;break;case"data":o.type="data",o.data=r.data,o.datatype=r.datatype,o.schema=r.schema;break;case"closeBracket":o.type="endgroup",o.group=r.data}return t.sendAll(o.type,p(o,e),n)}}}(this)),t.on("disconnect",function(t){return function(r){if(t.eventFiltered(e.graph,r))return t.sendAll("disconnect",p(r,e),n)}}(this)),t.on("process-error",function(t){return function(r){var o,i,s,a,u;if(i=r.error.message,r.error.stack)for(o=r.error.stack.split("\n"),s=a=0,u=Math.min(o.length,3);0<=u?a<=u:a>=u;s=0<=u?++a:--a)i+="\n"+o[s];return t.sendAll("processerror",{id:r.id,error:i,graph:e.graph},n)}}(this))},e.prototype.startNetwork=function(t,e,n){var r,o;if(r=function(t){return function(e){return e.start(function(e){if(e)return t.send("error",e,content)})}}(this),!(o=this.networks[e.graph])||!o.network)return this.initNetwork(t,e,n,function(t){return function(i){return i?t.send("error",i,n):(o=t.networks[e.graph],r(o.network))}}(this));r(o.network)},e.prototype.stopNetwork=function(t,e,n){var r;if(this.networks[e.graph]&&(r=this.networks[e.graph].network)){if(!r.isStarted())return this.send("stopped",{time:new Date,graph:e.graph,running:r.isRunning(),started:r.isStarted()},n);this.networks[e.graph].network.stop(function(t){return function(e){if(e)return t.send("error",e,n)}}(this))}},e.prototype.debugNetwork=function(t,e,n){var r;if(this.networks[e.graph]&&(r=this.networks[e.graph].network))return null!=r.setDebug?r.setDebug(e.enable):console.log("Warning: Network.setDebug not supported. Update to newer NoFlo")},e.prototype.getStatus=function(t,e,n){var r;if(this.networks[e.graph]&&(r=this.networks[e.graph].network))return this.send("status",{graph:e.graph,running:r.isRunning(),started:r.isStarted()},n)},e}(),t.exports=o}).call(this)}).call(e,n(14).Buffer)},function(t,e,n){(function(){var e,r,o;o=n(0),r=n(99),e=function(){function t(t){this.transport=t}return t.prototype.loaders={},t.prototype.send=function(t,e,n){return this.transport.send("component",t,e,n)},t.prototype.receive=function(t,e,n){if(this.transport.canDo("protocol:component",e.secret))if("source"!==t||this.transport.canDo("component:setsource",e.secret))if("getsource"!==t||this.transport.canDo("component:getsource",e.secret))switch(t){case"list":return this.listComponents(e,n);case"getsource":return this.getSource(e,n);case"source":return this.setSource(e,n)}else this.send("error",new Error(t+" not permitted"),n);else this.send("error",new Error(t+" not permitted"),n);else this.send("error",new Error(t+" not permitted"),n)},t.prototype.getLoader=function(t,e){return null==e&&(e={}),this.loaders[t]||(this.loaders[t]=new o.ComponentLoader(t,e)),this.loaders[t]},t.prototype.listComponents=function(t,e){var n,r;return n=this.transport.options.baseDir,(r=this.getLoader(n,this.transport.options)).listComponents(function(t){return function(n,o){var i,s;{if(!n)return i=Object.keys(o),s=0,i.forEach(function(n){return t.processComponent(r,n,e,function(n){if(!(++s<i.length))return t.send("componentsready",s,e)})});t.send("error",n,e)}}}(this))},t.prototype.getSource=function(t,e){var n;return n=this.transport.options.baseDir,this.getLoader(n,this.transport.options).getSource(t.name,function(n){return function(r,o){var i,s;return r?null==(i=n.transport.graph.graphs[t.name])?void n.send("error",r,e):(s=t.name.split("/"),n.send("source",{name:s[1],library:s[0],code:JSON.stringify(i.toJSON()),language:"json"},e)):n.send("source",o,e)}}(this))},t.prototype.setSource=function(t,e){var n,r;return n=this.transport.options.baseDir,(r=this.getLoader(n,this.transport.options)).setSource(t.library,t.name,t.code,t.language,function(n){return function(o){if(!o)return n.processComponent(r,r.normalizeName(t.library,t.name),e);n.send("error",o,e)}}(this))},t.prototype.processComponent=function(t,e,n,r){return r||(r=function(){}),t.load(e,function(t){return function(o,i){if(!i){if(o instanceof Error)return t.send("error",o,n),r(o);i=o}{if(i.isReady())return t.sendComponent(e,i,n),r(null);i.once("ready",function(){return t.sendComponent(e,i,n),r(null)})}}}(this),!0)},t.prototype.sendComponent=function(t,e,n){var r,o,i,s,a,u,c;o=[],i=[],u=e.inPorts;for(a in u)(s=u[a])&&"function"!=typeof s&&s.canAttach&&o.push({id:a,type:s.getDataType?s.getDataType():void 0,schema:s.getSchema?s.getSchema():void 0,required:s.isRequired?s.isRequired():void 0,addressable:s.isAddressable?s.isAddressable():void 0,description:s.getDescription?s.getDescription():void 0,values:s.options&&s.options.values?s.options.values:void 0,default:s.options&&s.options.default?s.options.default:void 0});c=e.outPorts;for(a in c)(s=c[a])&&"function"!=typeof s&&s.canAttach&&i.push({id:a,type:s.getDataType?s.getDataType():void 0,schema:s.getSchema?s.getSchema():void 0,required:s.isRequired?s.isRequired():void 0,addressable:s.isAddressable?s.isAddressable():void 0,description:s.getDescription?s.getDescription():void 0});return r=e.getIcon?e.getIcon():"blank",this.send("component",{name:t,description:e.description,subgraph:e.isSubgraph(),icon:r,inPorts:o,outPorts:i},n)},t.prototype.registerGraph=function(t,e,n){var o,i,s;return s=function(e){return function(){return e.processComponent(o,t,n)}}(this),i=r.debounce(s,10),(o=this.getLoader(e.baseDir,this.transport.options)).listComponents(function(r){return function(s,a){if(!s)return o.registerComponent("",t,e),i();r.send("error",s,n)}}(this)),e.on("addNode",i),e.on("removeNode",i),e.on("renameNode",i),e.on("addEdge",i),e.on("removeEdge",i),e.on("addInitial",i),e.on("removeInitial",i),e.on("addInport",i),e.on("removeInport",i),e.on("renameInport",i),e.on("addOutport",i),e.on("removeOutport",i),e.on("renameOutport",i)},t}(),t.exports=e}).call(this)},function(t,e,n){var r,o;(function(){function n(t){function e(e,n,r,o,i,s){for(;i>=0&&i<s;i+=t){var a=o?o[i]:i;r=n(r,e[a],a,e)}return r}return function(n,r,o,i){r=E(r,i,4);var s=!I(n)&&k.keys(n),a=(s||n).length,u=t>0?0:a-1;return arguments.length<3&&(o=n[s?s[u]:u],u+=t),e(n,r,o,s,u,a)}}function i(t){return function(e,n,r){n=_(n,r);for(var o=O(e),i=t>0?0:o-1;i>=0&&i<o;i+=t)if(n(e[i],i,e))return i;return-1}}function s(t,e,n){return function(r,o,i){var s=0,a=O(r);if("number"==typeof i)t>0?s=i>=0?i:Math.max(i+a,s):a=i>=0?Math.min(i+1,a):i+a+1;else if(n&&i&&a)return i=n(r,o),r[i]===o?i:-1;if(o!==o)return(i=e(h.call(r,s,a),k.isNaN))>=0?i+s:-1;for(i=t>0?s:a-1;i>=0&&i<a;i+=t)if(r[i]===o)return i;return-1}}function a(t,e){var n=L.length,r=t.constructor,o=k.isFunction(r)&&r.prototype||d,i="constructor";for(k.has(t,i)&&!k.contains(e,i)&&e.push(i);n--;)(i=L[n])in t&&t[i]!==o[i]&&!k.contains(e,i)&&e.push(i)}var u=this,c=u._,p=Array.prototype,d=Object.prototype,l=Function.prototype,f=p.push,h=p.slice,g=d.toString,m=d.hasOwnProperty,v=Array.isArray,y=Object.keys,b=l.bind,w=Object.create,P=function(){},k=function(t){return t instanceof k?t:this instanceof k?void(this._wrapped=t):new k(t)};void 0!==t&&t.exports&&(e=t.exports=k),e._=k,k.VERSION="1.8.3";var E=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)};case 4:return function(n,r,o,i){return t.call(e,n,r,o,i)}}return function(){return t.apply(e,arguments)}},_=function(t,e,n){return null==t?k.identity:k.isFunction(t)?E(t,e,n):k.isObject(t)?k.matcher(t):k.property(t)};k.iteratee=function(t,e){return _(t,e,1/0)};var C=function(t,e){return function(n){var r=arguments.length;if(r<2||null==n)return n;for(var o=1;o<r;o++)for(var i=arguments[o],s=t(i),a=s.length,u=0;u<a;u++){var c=s[u];e&&void 0!==n[c]||(n[c]=i[c])}return n}},D=function(t){if(!k.isObject(t))return{};if(w)return w(t);P.prototype=t;var e=new P;return P.prototype=null,e},x=function(t){return function(e){return null==e?void 0:e[t]}},S=Math.pow(2,53)-1,O=x("length"),I=function(t){var e=O(t);return"number"==typeof e&&e>=0&&e<=S};k.each=k.forEach=function(t,e,n){e=E(e,n);var r,o;if(I(t))for(r=0,o=t.length;r<o;r++)e(t[r],r,t);else{var i=k.keys(t);for(r=0,o=i.length;r<o;r++)e(t[i[r]],i[r],t)}return t},k.map=k.collect=function(t,e,n){e=_(e,n);for(var r=!I(t)&&k.keys(t),o=(r||t).length,i=Array(o),s=0;s<o;s++){var a=r?r[s]:s;i[s]=e(t[a],a,t)}return i},k.reduce=k.foldl=k.inject=n(1),k.reduceRight=k.foldr=n(-1),k.find=k.detect=function(t,e,n){var r;if(void 0!==(r=I(t)?k.findIndex(t,e,n):k.findKey(t,e,n))&&-1!==r)return t[r]},k.filter=k.select=function(t,e,n){var r=[];return e=_(e,n),k.each(t,function(t,n,o){e(t,n,o)&&r.push(t)}),r},k.reject=function(t,e,n){return k.filter(t,k.negate(_(e)),n)},k.every=k.all=function(t,e,n){e=_(e,n);for(var r=!I(t)&&k.keys(t),o=(r||t).length,i=0;i<o;i++){var s=r?r[i]:i;if(!e(t[s],s,t))return!1}return!0},k.some=k.any=function(t,e,n){e=_(e,n);for(var r=!I(t)&&k.keys(t),o=(r||t).length,i=0;i<o;i++){var s=r?r[i]:i;if(e(t[s],s,t))return!0}return!1},k.contains=k.includes=k.include=function(t,e,n,r){return I(t)||(t=k.values(t)),("number"!=typeof n||r)&&(n=0),k.indexOf(t,e,n)>=0},k.invoke=function(t,e){var n=h.call(arguments,2),r=k.isFunction(e);return k.map(t,function(t){var o=r?e:t[e];return null==o?o:o.apply(t,n)})},k.pluck=function(t,e){return k.map(t,k.property(e))},k.where=function(t,e){return k.filter(t,k.matcher(e))},k.findWhere=function(t,e){return k.find(t,k.matcher(e))},k.max=function(t,e,n){var r,o,i=-1/0,s=-1/0;if(null==e&&null!=t)for(var a=0,u=(t=I(t)?t:k.values(t)).length;a<u;a++)(r=t[a])>i&&(i=r);else e=_(e,n),k.each(t,function(t,n,r){((o=e(t,n,r))>s||o===-1/0&&i===-1/0)&&(i=t,s=o)});return i},k.min=function(t,e,n){var r,o,i=1/0,s=1/0;if(null==e&&null!=t)for(var a=0,u=(t=I(t)?t:k.values(t)).length;a<u;a++)(r=t[a])<i&&(i=r);else e=_(e,n),k.each(t,function(t,n,r){((o=e(t,n,r))<s||o===1/0&&i===1/0)&&(i=t,s=o)});return i},k.shuffle=function(t){for(var e,n=I(t)?t:k.values(t),r=n.length,o=Array(r),i=0;i<r;i++)(e=k.random(0,i))!==i&&(o[i]=o[e]),o[e]=n[i];return o},k.sample=function(t,e,n){return null==e||n?(I(t)||(t=k.values(t)),t[k.random(t.length-1)]):k.shuffle(t).slice(0,Math.max(0,e))},k.sortBy=function(t,e,n){return e=_(e,n),k.pluck(k.map(t,function(t,n,r){return{value:t,index:n,criteria:e(t,n,r)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index}),"value")};var A=function(t){return function(e,n,r){var o={};return n=_(n,r),k.each(e,function(r,i){var s=n(r,i,e);t(o,r,s)}),o}};k.groupBy=A(function(t,e,n){k.has(t,n)?t[n].push(e):t[n]=[e]}),k.indexBy=A(function(t,e,n){t[n]=e}),k.countBy=A(function(t,e,n){k.has(t,n)?t[n]++:t[n]=1}),k.toArray=function(t){return t?k.isArray(t)?h.call(t):I(t)?k.map(t,k.identity):k.values(t):[]},k.size=function(t){return null==t?0:I(t)?t.length:k.keys(t).length},k.partition=function(t,e,n){e=_(e,n);var r=[],o=[];return k.each(t,function(t,n,i){(e(t,n,i)?r:o).push(t)}),[r,o]},k.first=k.head=k.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:k.initial(t,t.length-e)},k.initial=function(t,e,n){return h.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},k.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:k.rest(t,Math.max(0,t.length-e))},k.rest=k.tail=k.drop=function(t,e,n){return h.call(t,null==e||n?1:e)},k.compact=function(t){return k.filter(t,k.identity)};var N=function(t,e,n,r){for(var o=[],i=0,s=r||0,a=O(t);s<a;s++){var u=t[s];if(I(u)&&(k.isArray(u)||k.isArguments(u))){e||(u=N(u,e,n));var c=0,p=u.length;for(o.length+=p;c<p;)o[i++]=u[c++]}else n||(o[i++]=u)}return o};k.flatten=function(t,e){return N(t,e,!1)},k.without=function(t){return k.difference(t,h.call(arguments,1))},k.uniq=k.unique=function(t,e,n,r){k.isBoolean(e)||(r=n,n=e,e=!1),null!=n&&(n=_(n,r));for(var o=[],i=[],s=0,a=O(t);s<a;s++){var u=t[s],c=n?n(u,s,t):u;e?(s&&i===c||o.push(u),i=c):n?k.contains(i,c)||(i.push(c),o.push(u)):k.contains(o,u)||o.push(u)}return o},k.union=function(){return k.uniq(N(arguments,!0,!0))},k.intersection=function(t){for(var e=[],n=arguments.length,r=0,o=O(t);r<o;r++){var i=t[r];if(!k.contains(e,i)){for(var s=1;s<n&&k.contains(arguments[s],i);s++);s===n&&e.push(i)}}return e},k.difference=function(t){var e=N(arguments,!0,!0,1);return k.filter(t,function(t){return!k.contains(e,t)})},k.zip=function(){return k.unzip(arguments)},k.unzip=function(t){for(var e=t&&k.max(t,O).length||0,n=Array(e),r=0;r<e;r++)n[r]=k.pluck(t,r);return n},k.object=function(t,e){for(var n={},r=0,o=O(t);r<o;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},k.findIndex=i(1),k.findLastIndex=i(-1),k.sortedIndex=function(t,e,n,r){for(var o=(n=_(n,r,1))(e),i=0,s=O(t);i<s;){var a=Math.floor((i+s)/2);n(t[a])<o?i=a+1:s=a}return i},k.indexOf=s(1,k.findIndex,k.sortedIndex),k.lastIndexOf=s(-1,k.findLastIndex),k.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var r=Math.max(Math.ceil((e-t)/n),0),o=Array(r),i=0;i<r;i++,t+=n)o[i]=t;return o};var T=function(t,e,n,r,o){if(!(r instanceof e))return t.apply(n,o);var i=D(t.prototype),s=t.apply(i,o);return k.isObject(s)?s:i};k.bind=function(t,e){if(b&&t.bind===b)return b.apply(t,h.call(arguments,1));if(!k.isFunction(t))throw new TypeError("Bind must be called on a function");var n=h.call(arguments,2),r=function(){return T(t,r,e,this,n.concat(h.call(arguments)))};return r},k.partial=function(t){var e=h.call(arguments,1),n=function(){for(var r=0,o=e.length,i=Array(o),s=0;s<o;s++)i[s]=e[s]===k?arguments[r++]:e[s];for(;r<arguments.length;)i.push(arguments[r++]);return T(t,n,this,this,i)};return n},k.bindAll=function(t){var e,n,r=arguments.length;if(r<=1)throw new Error("bindAll must be passed function names");for(e=1;e<r;e++)t[n=arguments[e]]=k.bind(t[n],t);return t},k.memoize=function(t,e){var n=function(r){var o=n.cache,i=""+(e?e.apply(this,arguments):r);return k.has(o,i)||(o[i]=t.apply(this,arguments)),o[i]};return n.cache={},n},k.delay=function(t,e){var n=h.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},k.defer=k.partial(k.delay,k,1),k.throttle=function(t,e,n){var r,o,i,s=null,a=0;n||(n={});var u=function(){a=!1===n.leading?0:k.now(),s=null,i=t.apply(r,o),s||(r=o=null)};return function(){var c=k.now();a||!1!==n.leading||(a=c);var p=e-(c-a);return r=this,o=arguments,p<=0||p>e?(s&&(clearTimeout(s),s=null),a=c,i=t.apply(r,o),s||(r=o=null)):s||!1===n.trailing||(s=setTimeout(u,p)),i}},k.debounce=function(t,e,n){var r,o,i,s,a,u=function(){var c=k.now()-s;c<e&&c>=0?r=setTimeout(u,e-c):(r=null,n||(a=t.apply(i,o),r||(i=o=null)))};return function(){i=this,o=arguments,s=k.now();var c=n&&!r;return r||(r=setTimeout(u,e)),c&&(a=t.apply(i,o),i=o=null),a}},k.wrap=function(t,e){return k.partial(e,t)},k.negate=function(t){return function(){return!t.apply(this,arguments)}},k.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},k.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},k.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},k.once=k.partial(k.before,2);var R=!{toString:null}.propertyIsEnumerable("toString"),L=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];k.keys=function(t){if(!k.isObject(t))return[];if(y)return y(t);var e=[];for(var n in t)k.has(t,n)&&e.push(n);return R&&a(t,e),e},k.allKeys=function(t){if(!k.isObject(t))return[];var e=[];for(var n in t)e.push(n);return R&&a(t,e),e},k.values=function(t){for(var e=k.keys(t),n=e.length,r=Array(n),o=0;o<n;o++)r[o]=t[e[o]];return r},k.mapObject=function(t,e,n){e=_(e,n);for(var r,o=k.keys(t),i=o.length,s={},a=0;a<i;a++)s[r=o[a]]=e(t[r],r,t);return s},k.pairs=function(t){for(var e=k.keys(t),n=e.length,r=Array(n),o=0;o<n;o++)r[o]=[e[o],t[e[o]]];return r},k.invert=function(t){for(var e={},n=k.keys(t),r=0,o=n.length;r<o;r++)e[t[n[r]]]=n[r];return e},k.functions=k.methods=function(t){var e=[];for(var n in t)k.isFunction(t[n])&&e.push(n);return e.sort()},k.extend=C(k.allKeys),k.extendOwn=k.assign=C(k.keys),k.findKey=function(t,e,n){e=_(e,n);for(var r,o=k.keys(t),i=0,s=o.length;i<s;i++)if(r=o[i],e(t[r],r,t))return r},k.pick=function(t,e,n){var r,o,i={},s=t;if(null==s)return i;k.isFunction(e)?(o=k.allKeys(s),r=E(e,n)):(o=N(arguments,!1,!1,1),r=function(t,e,n){return e in n},s=Object(s));for(var a=0,u=o.length;a<u;a++){var c=o[a],p=s[c];r(p,c,s)&&(i[c]=p)}return i},k.omit=function(t,e,n){if(k.isFunction(e))e=k.negate(e);else{var r=k.map(N(arguments,!1,!1,1),String);e=function(t,e){return!k.contains(r,e)}}return k.pick(t,e,n)},k.defaults=C(k.allKeys,!0),k.create=function(t,e){var n=D(t);return e&&k.extendOwn(n,e),n},k.clone=function(t){return k.isObject(t)?k.isArray(t)?t.slice():k.extend({},t):t},k.tap=function(t,e){return e(t),t},k.isMatch=function(t,e){var n=k.keys(e),r=n.length;if(null==t)return!r;for(var o=Object(t),i=0;i<r;i++){var s=n[i];if(e[s]!==o[s]||!(s in o))return!1}return!0};var B=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof k&&(t=t._wrapped),e instanceof k&&(e=e._wrapped);var o=g.call(t);if(o!==g.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e}var i="[object Array]"===o;if(!i){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(k.isFunction(s)&&s instanceof s&&k.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],r=r||[];for(var u=n.length;u--;)if(n[u]===t)return r[u]===e;if(n.push(t),r.push(e),i){if((u=t.length)!==e.length)return!1;for(;u--;)if(!B(t[u],e[u],n,r))return!1}else{var c,p=k.keys(t);if(u=p.length,k.keys(e).length!==u)return!1;for(;u--;)if(c=p[u],!k.has(e,c)||!B(t[c],e[c],n,r))return!1}return n.pop(),r.pop(),!0};k.isEqual=function(t,e){return B(t,e)},k.isEmpty=function(t){return null==t||(I(t)&&(k.isArray(t)||k.isString(t)||k.isArguments(t))?0===t.length:0===k.keys(t).length)},k.isElement=function(t){return!(!t||1!==t.nodeType)},k.isArray=v||function(t){return"[object Array]"===g.call(t)},k.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},k.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){k["is"+t]=function(e){return g.call(e)==="[object "+t+"]"}}),k.isArguments(arguments)||(k.isArguments=function(t){return k.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(k.isFunction=function(t){return"function"==typeof t||!1}),k.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},k.isNaN=function(t){return k.isNumber(t)&&t!==+t},k.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===g.call(t)},k.isNull=function(t){return null===t},k.isUndefined=function(t){return void 0===t},k.has=function(t,e){return null!=t&&m.call(t,e)},k.noConflict=function(){return u._=c,this},k.identity=function(t){return t},k.constant=function(t){return function(){return t}},k.noop=function(){},k.property=x,k.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},k.matcher=k.matches=function(t){return t=k.extendOwn({},t),function(e){return k.isMatch(e,t)}},k.times=function(t,e,n){var r=Array(Math.max(0,t));e=E(e,n,1);for(var o=0;o<t;o++)r[o]=e(o);return r},k.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},k.now=Date.now||function(){return(new Date).getTime()};var G={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},j=k.invert(G),F=function(t){var e=function(e){return t[e]},n="(?:"+k.keys(t).join("|")+")",r=RegExp(n),o=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(o,e):t}};k.escape=F(G),k.unescape=F(j),k.result=function(t,e,n){var r=null==t?void 0:t[e];return void 0===r&&(r=n),k.isFunction(r)?r.call(t):r};var M=0;k.uniqueId=function(t){var e=++M+"";return t?t+e:e},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,U={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},z=/\\|'|\r|\n|\u2028|\u2029/g,H=function(t){return"\\"+U[t]};k.template=function(t,e,n){!e&&n&&(e=n),e=k.defaults({},e,k.templateSettings);var r=RegExp([(e.escape||q).source,(e.interpolate||q).source,(e.evaluate||q).source].join("|")+"|$","g"),o=0,i="__p+='";t.replace(r,function(e,n,r,s,a){return i+=t.slice(o,a).replace(z,H),o=a+e.length,n?i+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?i+="'+\n((__t=("+r+"))==null?'':__t)+\n'":s&&(i+="';\n"+s+"\n__p+='"),e}),i+="';\n",e.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var s=new Function(e.variable||"obj","_",i)}catch(t){throw t.source=i,t}var a=function(t){return s.call(this,t,k)},u=e.variable||"obj";return a.source="function("+u+"){\n"+i+"}",a},k.chain=function(t){var e=k(t);return e._chain=!0,e};var Y=function(t,e){return t._chain?k(e).chain():e};k.mixin=function(t){k.each(k.functions(t),function(e){var n=k[e]=t[e];k.prototype[e]=function(){var t=[this._wrapped];return f.apply(t,arguments),Y(this,n.apply(k,t))}})},k.mixin(k),k.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=p[t];k.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],Y(this,n)}}),k.each(["concat","join","slice"],function(t){var e=p[t];k.prototype[t]=function(){return Y(this,e.apply(this._wrapped,arguments))}}),k.prototype.value=function(){return this._wrapped},k.prototype.valueOf=k.prototype.toJSON=k.prototype.value,k.prototype.toString=function(){return""+this._wrapped},r=[],void 0!==(o=function(){return k}.apply(e,r))&&(t.exports=o)}).call(this)},function(t,e,n){(function(){var e,r,o,i,s,a,u,c,p;c=n(0),i=n(3)("noflo-runtime-base:trace"),a=JSON.stringify;try{a=n(101)}catch(t){s=t,console.log("WARN: failed to load json-stringify-safe, circular objects may cause fail.\n"+s.message)}o=function(t){var e;return e=a(t),JSON.parse(e)},e=function(){function t(){this.events=[]}return t.prototype.add=function(t){return this.events.push(t)},t.prototype.getAll=function(t,e){var n,r,o;for(n=0,r=(o=this.events).length;n<r;n++)t(s=o[n]);return e(null)},t}(),p=function(t,e,n,r){var o,i,s,a,u,p,d,l,f;i={},d=t.graph.outports;for(p in d)for(a=d[p],f=c.internalSocket.createSocket(),i[p]=f,t.processes[a.process].component.outPorts[a.port].attach(f),l=function(t){return function(n){var o;return o={id:"EXPORT: "+e+" "+p.toUpperCase()+" ->",payload:n,socket:{to:{process:{id:e},port:p}}},r(t,o)}},s=0,u=n.length;s<u;s++)o=n[s],f.on(o,l(o));return i},u=function(t,e,n){var r,a,u,c,p,d,l,f;switch(i("event",t,e,"'"+n.id+"'"),f=n.socket,r={protocol:"network",command:e,payload:{time:(new Date).toISOString(),graph:t,error:null,src:{node:null!=(u=f.from)?u.process.id:void 0,port:null!=(c=f.from)?c.port:void 0},tgt:{node:null!=(p=f.to)?p.process.id:void 0,port:null!=(d=f.to)?d.port:void 0},id:void 0,subgraph:void 0}},l=function(t){try{return t.group=n.group.toString()}catch(e){return s=e,i("group serialization error",s),t.error=s.message}},a=r.payload,e){case"connect":case"disconnect":break;case"begingroup":case"endgroup":l(r.payload);break;case"data":try{a.data=o(n.data)}catch(t){i("data serialization error",s=t),a.error=s.message}break;default:throw new Error("trace: Unknown event type "+e)}return i("event done",t,e,"'"+n.id+"'"),r},r=function(){function t(t){this.options=t,this.buffer=new e,this.header={graphs:{}}}return t.prototype.attach=function(t){var e,n;return n=t.graph.name||t.graph.properties.name||"default",i("attach",n),(e=["connect","begingroup","data","endgroup","disconnect"]).forEach(function(e){return function(r){return t.on(r,function(t){var o;return o=u(n,r,t),e.buffer.add(o)})}}(this)),p(t,n,e,function(t){return function(e,r){var o;return o=u(n,e,r),t.buffer.add(o)}}(this)),this.header.graphs[n]=t.graph.toJSON()},t.prototype.detach=function(t){},t.prototype.dumpString=function(t){var e,n;return n=[],e=function(t){return n.push(t)},this.buffer.getAll(e,function(e){return function(r){var o;return o={header:e.header,events:n},t(r,JSON.stringify(o,null,2))}}(this))},t.prototype.dumpFile=function(t,e){var r,o,s;return r=n(6),s=n(102),o=function(e){return r.open(t,"w",function(n,r){return e(n,{path:t,fd:r})})},t||(o=function(t){return s.open({suffix:".json"},t)}),o(function(t){return function(n,o){var s,a,u,c;return n?e(n):(s=0,u=function(t,e){return r.write(o.fd,t,{encoding:"utf-8"},e)},c=function(t){var e;return e=s?",":"",s+=1,e+=JSON.stringify(t,null,2),u(e,function(t){})},i("streaming to file",o.path),a=JSON.stringify(t.header,null,2),u('{\n "header": '+a+'\n, "events":\n[',function(n){return t.buffer.getAll(c,function(t){return t?e(t):(i("streamed "+s+" events"),u("]\n }",function(t){return i("completed stream",o.path),e(t,o.path)}))})}))}}(this))},t}(),t.exports.Tracer=r}).call(this)},function(t,e){function n(t,e){var n=[],r=[];return null==e&&(e=function(t,e){return n[0]===e?"[Circular ~]":"[Circular ~."+r.slice(0,n.indexOf(e)).join(".")+"]"}),function(o,i){if(n.length>0){var s=n.indexOf(this);~s?n.splice(s+1):n.push(this),~s?r.splice(s,1/0,o):r.push(o),~n.indexOf(i)&&(i=e.call(this,o,i))}else n.push(i);return null==t?i:t.call(this,o,i)}}(t.exports=function(t,e,r,o){return JSON.stringify(t,n(e,o),r)}).getSerialize=n},function(t,e,n){(function(r){function o(t){if(!P)return!1;s(),E.push(t)}function i(t){if(!P)return!1;s(),_.push(t)}function s(){if(!P)return!1;k||(r.addListener("exit",d),k=!0)}function a(){if(!P)return!1;for(var t,e=0;void 0!==(t=E.shift());)v(t),e++;return e}function u(t){if(P){var e=0,n=E.length;if(n)for(var r;void 0!==(r=E.shift());)g(r,function(r){if(n){if(r)return t&&t(r),void(n=0);e++,!--n&&t&&t(null,e)}});else t&&t(null,e)}else t&&t(new Error("not tracking"))}function c(){if(!P)return!1;for(var t,e=0;void 0!==(t=_.shift());)v(t),e++;return e}function p(t){if(P){var e=_.length;if(e)for(var n;void 0!==(n=_.shift());)g(n,function(n){if(e){if(n)return t&&t(n,0),void(e=0);!--e&&t&&t(null,0)}});else t&&t(null,0)}else t&&t(new Error("not tracking"))}function d(){return!!P&&{files:a(),dirs:c()}}var l=n(6),f=n(25),h=n(103),g=n(104),m=n(106),v=g.sync,y=h.O_CREAT|h.O_TRUNC|h.O_RDWR|h.O_EXCL,b=function(t,n){var o=w(t,n),i=new Date,s=[o.prefix,i.getYear(),i.getMonth(),i.getDate(),"-",r.pid,"-",(4294967296*Math.random()+1).toString(36),o.suffix].join("");return f.join(o.dir||e.dir,s)},w=function(t,e){var n={prefix:null,suffix:null};if(t)switch(typeof t){case"string":n.prefix=t;break;case"object":n=t;break;default:throw new Error("Unknown affix declaration: "+n)}else n.prefix=e;return n},P=!1,k=!1,E=[],_=[];e.dir=f.resolve(m()),e.track=function(e){return P=!1!==e,t.exports},e.mkdir=function(t,e){var n=b(t,"d-");l.mkdir(n,448,function(t){t||i(n),e&&e(t,n)})},e.mkdirSync=function(t){var e=b(t,"d-");return l.mkdirSync(e,448),i(e),e},e.open=function(t,e){var n=b(t,"f-");l.open(n,y,384,function(t,r){t||o(n),e&&e(t,{path:n,fd:r})})},e.openSync=function(t){var e=b(t,"f-"),n=l.openSync(e,y,384);return o(e),{path:e,fd:n}},e.path=b,e.cleanup=function(t){P?u(function(e,n){e?t&&t(e,{files:n}):p(function(e,r){t&&t(e,{files:n,dirs:r})})}):t&&t(new Error("not tracking"))},e.cleanupSync=d,e.createWriteStream=function(t){var e=b(t,"s-"),n=l.createWriteStream(e,{flags:y,mode:384});return o(e),n}}).call(e,n(1))},function(t,e){t.exports={O_RDONLY:0,O_WRONLY:1,O_RDWR:2,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:512,O_EXCL:2048,O_NOCTTY:131072,O_TRUNC:1024,O_APPEND:8,O_DIRECTORY:1048576,O_NOFOLLOW:256,O_SYNC:128,O_SYMLINK:2097152,O_NONBLOCK:4,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,E2BIG:7,EACCES:13,EADDRINUSE:48,EADDRNOTAVAIL:49,EAFNOSUPPORT:47,EAGAIN:35,EALREADY:37,EBADF:9,EBADMSG:94,EBUSY:16,ECANCELED:89,ECHILD:10,ECONNABORTED:53,ECONNREFUSED:61,ECONNRESET:54,EDEADLK:11,EDESTADDRREQ:39,EDOM:33,EDQUOT:69,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:65,EIDRM:90,EILSEQ:92,EINPROGRESS:36,EINTR:4,EINVAL:22,EIO:5,EISCONN:56,EISDIR:21,ELOOP:62,EMFILE:24,EMLINK:31,EMSGSIZE:40,EMULTIHOP:95,ENAMETOOLONG:63,ENETDOWN:50,ENETRESET:52,ENETUNREACH:51,ENFILE:23,ENOBUFS:55,ENODATA:96,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:77,ENOLINK:97,ENOMEM:12,ENOMSG:91,ENOPROTOOPT:42,ENOSPC:28,ENOSR:98,ENOSTR:99,ENOSYS:78,ENOTCONN:57,ENOTDIR:20,ENOTEMPTY:66,ENOTSOCK:38,ENOTSUP:45,ENOTTY:25,ENXIO:6,EOPNOTSUPP:102,EOVERFLOW:84,EPERM:1,EPIPE:32,EPROTO:100,EPROTONOSUPPORT:43,EPROTOTYPE:41,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:70,ETIME:101,ETIMEDOUT:60,ETXTBSY:26,EWOULDBLOCK:35,EXDEV:18,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:10,SIGFPE:8,SIGKILL:9,SIGUSR1:30,SIGSEGV:11,SIGUSR2:31,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:20,SIGCONT:19,SIGSTOP:17,SIGTSTP:18,SIGTTIN:21,SIGTTOU:22,SIGURG:16,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:23,SIGSYS:12,SSL_OP_ALL:2147486719,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:32,SSL_OP_MICROSOFT_SESS_ID_BUG:1,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:536870912,SSL_OP_NETSCAPE_CHALLENGE_BUG:2,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:1073741824,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:8,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:16777216,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_SINGLE_DH_USE:1048576,SSL_OP_SINGLE_ECDH_USE:524288,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:128,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:512,SSL_OP_TLS_D5_BUG:256,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_ECDH:16,ENGINE_METHOD_ECDSA:32,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_STORE:256,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_UDP_REUSEADDR:4}},function(t,e,n){(function(r){function o(t){["unlink","chmod","stat","rmdir","readdir"].forEach(function(e){t[e]=t[e]||m[e],t[e+="Sync"]=t[e]||m[e]})}function i(t,n,r){if("function"==typeof n&&(r=n,n={}),h(t),h(n),h("function"==typeof r),o(n),!r)throw new Error("No callback passed to rimraf()");var i=0;s(t,n,function o(a){if(a){if(y&&("EBUSY"===a.code||"ENOTEMPTY"===a.code)&&i<e.BUSYTRIES_MAX){var u=100*++i;return setTimeout(function(){s(t,n,o)},u)}if("EMFILE"===a.code&&v<e.EMFILE_MAX)return setTimeout(function(){s(t,n,o)},v++);"ENOENT"===a.code&&(a=null)}v=0,r(a)})}function s(t,e,n){h(t),h(e),h("function"==typeof n),e.unlink(t,function(r){if(r){if("ENOENT"===r.code)return n(null);if("EPERM"===r.code)return y?a(t,e,r,n):c(t,e,r,n);if("EISDIR"===r.code)return c(t,e,r,n)}return n(r)})}function a(t,e,n,r){h(t),h(e),h("function"==typeof r),n&&h(n instanceof Error),e.chmod(t,666,function(o){o?r("ENOENT"===o.code?null:n):e.stat(t,function(o,i){o?r("ENOENT"===o.code?null:n):i.isDirectory()?c(t,e,n,r):e.unlink(t,r)})})}function u(t,e,n){h(t),h(e),n&&h(n instanceof Error);try{e.chmodSync(t,666)}catch(t){if("ENOENT"===t.code)return;throw n}try{var r=e.statSync(t)}catch(t){if("ENOENT"===t.code)return;throw n}r.isDirectory()?l(t,e,n):e.unlinkSync(t)}function c(t,e,n,r){h(t),h(e),n&&h(n instanceof Error),h("function"==typeof r),e.rmdir(t,function(o){!o||"ENOTEMPTY"!==o.code&&"EEXIST"!==o.code&&"EPERM"!==o.code?r(o&&"ENOTDIR"===o.code?n:o):p(t,e,r)})}function p(t,e,n){h(t),h(e),h("function"==typeof n),e.readdir(t,function(r,o){if(r)return n(r);var s=o.length;if(0===s)return e.rmdir(t,n);var a;o.forEach(function(r){i(g.join(t,r),e,function(r){if(!a)return r?n(a=r):void(0==--s&&e.rmdir(t,n))})})})}function d(t,e){o(e=e||{}),h(t),h(e);try{e.unlinkSync(t)}catch(n){if("ENOENT"===n.code)return;if("EPERM"===n.code)return y?u(t,e,n):l(t,e,n);if("EISDIR"!==n.code)throw n;l(t,e,n)}}function l(t,e,n){h(t),h(e),n&&h(n instanceof Error);try{e.rmdirSync(t)}catch(r){if("ENOENT"===r.code)return;if("ENOTDIR"===r.code)throw n;"ENOTEMPTY"!==r.code&&"EEXIST"!==r.code&&"EPERM"!==r.code||f(t,e)}}function f(t,e){h(t),h(e),e.readdirSync(t).forEach(function(n){d(g.join(t,n),e)}),e.rmdirSync(t,e)}t.exports=i,i.sync=d;var h=n(105),g=n(25),m=n(6),v=0;e.EMFILE_MAX=1e3,e.BUSYTRIES_MAX=3;var y="win32"===r.platform}).call(e,n(1))},function(t,e,n){"use strict";(function(e){function r(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0}function o(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}function i(t){return Object.prototype.toString.call(t)}function s(t){return!o(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}function a(t){if(w.isFunction(t)){if(E)return t.name;var e=t.toString().match(C);return e&&e[1]}}function u(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function c(t){if(E||!w.isFunction(t))return w.inspect(t);var e=a(t);return"[Function"+(e?": "+e:"")+"]"}function p(t){return u(c(t.actual),128)+" "+t.operator+" "+u(c(t.expected),128)}function d(t,e,n,r,o){throw new _.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:o})}function l(t,e){t||d(t,!0,e,"==",_.ok)}function f(t,e,n,a){if(t===e)return!0;if(o(t)&&o(e))return 0===r(t,e);if(w.isDate(t)&&w.isDate(e))return t.getTime()===e.getTime();if(w.isRegExp(t)&&w.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(s(t)&&s(e)&&i(t)===i(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===r(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(o(t)!==o(e))return!1;var u=(a=a||{actual:[],expected:[]}).actual.indexOf(t);return-1!==u&&u===a.expected.indexOf(e)||(a.actual.push(t),a.expected.push(e),g(t,e,n,a))}return n?t===e:t==e}function h(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function g(t,e,n,r){if(null===t||void 0===t||null===e||void 0===e)return!1;if(w.isPrimitive(t)||w.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var o=h(t),i=h(e);if(o&&!i||!o&&i)return!1;if(o)return t=k.call(t),e=k.call(e),f(t,e,n);var s,a,u=D(t),c=D(e);if(u.length!==c.length)return!1;for(u.sort(),c.sort(),a=u.length-1;a>=0;a--)if(u[a]!==c[a])return!1;for(a=u.length-1;a>=0;a--)if(s=u[a],!f(t[s],e[s],n,r))return!1;return!0}function m(t,e,n){f(t,e,!0)&&d(t,e,n,"notDeepStrictEqual",m)}function v(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function y(t){var e;try{t()}catch(t){e=t}return e}function b(t,e,n,r){var o;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),o=y(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!o&&d(o,n,"Missing expected exception"+r);var i="string"==typeof r,s=!t&&w.isError(o),a=!t&&o&&!n;if((s&&i&&v(o,n)||a)&&d(o,n,"Got unwanted exception"+r),t&&o&&n&&!v(o,n)||!t&&o)throw o}var w=n(16),P=Object.prototype.hasOwnProperty,k=Array.prototype.slice,E="foo"===function(){}.name,_=t.exports=l,C=/\s*function\s+([^\(\s]*)\s*/;_.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=p(this),this.generatedMessage=!0);var e=t.stackStartFunction||d;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var r=n.stack,o=a(e),i=r.indexOf("\n"+o);if(i>=0){var s=r.indexOf("\n",i+1);r=r.substring(s+1)}this.stack=r}}},w.inherits(_.AssertionError,Error),_.fail=d,_.ok=l,_.equal=function(t,e,n){t!=e&&d(t,e,n,"==",_.equal)},_.notEqual=function(t,e,n){t==e&&d(t,e,n,"!=",_.notEqual)},_.deepEqual=function(t,e,n){f(t,e,!1)||d(t,e,n,"deepEqual",_.deepEqual)},_.deepStrictEqual=function(t,e,n){f(t,e,!0)||d(t,e,n,"deepStrictEqual",_.deepStrictEqual)},_.notDeepEqual=function(t,e,n){f(t,e,!1)&&d(t,e,n,"notDeepEqual",_.notDeepEqual)},_.notDeepStrictEqual=m,_.strictEqual=function(t,e,n){t!==e&&d(t,e,n,"===",_.strictEqual)},_.notStrictEqual=function(t,e,n){t===e&&d(t,e,n,"!==",_.notStrictEqual)},_.throws=function(t,e,n){b(!0,t,e,n)},_.doesNotThrow=function(t,e,n){b(!1,t,e,n)},_.ifError=function(t){if(t)throw t};var D=Object.keys||function(t){var e=[];for(var n in t)P.call(t,n)&&e.push(n);return e}}).call(e,n(9))},function(t,e,n){"use strict";(function(e){var n="win32"===e.platform,r=n?/[^:]\\$/:/.\/$/;t.exports=function(){var t;return t=n?e.env.TEMP||e.env.TMP||(e.env.SystemRoot||e.env.windir)+"\\temp":e.env.TMPDIR||e.env.TMP||e.env.TEMP||"/tmp",r.test(t)&&(t=t.slice(0,-1)),t}}).call(e,n(1))},function(t,e,n){(function(t){(function(){var t,r,o,i,s=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a={}.hasOwnProperty;t=n(24),i=n(2).EventEmitter,o=function(e){function n(t){n.__super__.constructor.call(this,t),this.clients=[]}return s(n,t),n.prototype._connect=function(t){return this.clients.push(t),t.on("send",function(e){return function(n){return e._receive(n,{client:t})}}(this))},n.prototype._disconnect=function(t){if(-1!==this.clients.indexOf(t))return this.clients.splice(this.clients.indexOf(t),1),t.removeAllListeners("send")},n.prototype._receive=function(t,e){return this.receive(t.protocol,t.command,t.payload,e)},n.prototype.send=function(t,e,n,r){var o;if(r.client)return o={protocol:t,command:e,payload:n},r.client._receive(o)},n.prototype.sendAll=function(t,e,n){var r,o,i,s,a,u;for(s={protocol:t,command:e,payload:n},u=[],o=0,i=(a=this.clients).length;o<i;o++)r=a[o],u.push(r._receive(s));return u},n}(),r=function(t){function e(t,n){this.name=n,e.__super__.constructor.call(this),this.runtime=t,this.name||(this.name="Unnamed client")}return s(e,i),e.prototype.connect=function(){return this.runtime._connect(this)},e.prototype.disconnect=function(){return this.runtime._disconnect(this)},e.prototype.send=function(t,e,n){var r;return r={protocol:t,command:e,payload:n},this.emit("send",r)},e.prototype._receive=function(t){return setTimeout(function(e){return function(){return e.emit("message",t)}}(this),1)},e}(),e.Client=r,e.Runtime=o}).call(this)}).call(e,n(1))},function(t,e,n){!function(e){var r=n(23),o=function(t,e){r.call(this,t),e&&e.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),this.openClient(e.getAttribute("href"))}.bind(this))};(o.prototype=new r).openClient=function(t){var e=window.open(t,"_blank");if(!e)throw new Error("Unable to open client window");this.context={href:"*"};var n=function(t){var e;(e="string"==typeof t.data?JSON.parse(t.data):t.data).protocol&&e.command&&this.receive(e.protocol,e.command,e.payload,this.context)}.bind(this),r=setInterval(function(){e&&!e.closed||(this.setClient(null),window.removeEventListener("message",n),clearInterval(r))}.bind(this),1e3);this.setClient(e),window.addEventListener("message",n)},t.exports=function(t,e){return t=r.normalizeOptions(t),new o(t,e)}}(window)}]);
//# sourceMappingURL=noflo-browser-app.min.js.map